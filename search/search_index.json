{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"bash-my-aws is a simple but extremely powerful set of CLI commands for managing resources on Amazon Web Services. They harness the power of Amazon's AWSCLI, while abstracting away verbosity. The project implements some innovative patterns but (arguably) remains simple, beautiful and readable. Introduction \u00b6 Short, Memorable Commands Shell Command Completion (including AWS resources) Unix Pipeline Friendly (instead of JSON) Convenient Shortcuts Short, Memorable Commands \u00b6 There are two main types of commands. 1. Resource Listing Commands These generally consist of the pluralised form of the resource name. $ buckets example-assets 2019 -12-08 02 :35:44.758551 example-logs 2019 -12-08 02 :35:52.669771 example-backups 2019 -12-08 02 :35:56.579434 $ stacks nagios CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED postgres01 CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED postgres02 CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED prometheus CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED $ keypairs alice 8f:85:9a:1e:6c:76:29:34:37:45:de:7f:8d:f9:70:eb bob 56 :73:29:c2:ad:7b:6f:b6:f2:f3:b4:de:e4:2b:12:d4 carol 29 :4e:1c:cb:ba:d4:85:0e:4f:b6:34:4c:d4:79:32:00 2. Resource detail/action commands These generally consist of a resource name and action separated by a hyphen. This makes discovering them via shell completion simple. Some retrieve information about resources while others make changes to them. $ keypair-delete alice bob You are about to delete the following EC2 SSH KeyPairs: alice bob Are you sure you want to continue ? y See the Command Reference for a full list of commands. Shell Command Completion \u00b6 In the example above, shell autocompletion retrieved the existing EC2 Keypair names ( alice , bob ) from AWS. This helps avoid the need to rely on human memory or terminal copypasta. Unix Pipeline Friendly \u00b6 The commands themselves are line oriented and work nicely in unix pipelines with other unix commands (e.g. grep , awk , etc). $ stacks | grep postgres postgres01 CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED postgres02 CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED They also work incredibly well with each other due to the way they treat input from STDIN. The first token from each line of STDIN is taken to be a resource identifiers (and the rest is discarded). $ stacks | grep postgres | stack-delete You are about to delete the following stacks: postgres01 postgres02 Are you sure you want to continue ? y Some users have compared this User Experience to functionality in Windows Powershell. Convenient Shortcuts \u00b6 bash-my-aws is insanely simple to pick up and start using but contains a lot of convenient shortcuts you can make use of. Example: resource listing commands accept a filter argument, removing the need for | grep . In the following example someone has given a CloudFormation stack a really long name: $ stacks nagios CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED postgres01 DELETE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED postgres02 DELETE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED prometheus CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED stack-with-a-annoyingly-long-name CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED This affects the output when we look at our postgress stacks: $ stacks | grep postgres postgres01 DELETE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED postgres02 DELETE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED The resource listing command can filter output before applying column . $ stacks postgres postgres01 DELETE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED postgres02 DELETE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED Quickstart \u00b6 Prerequisites \u00b6 awscli bash jq-1.4 or later (for stack-diff) Installation \u00b6 As shown below, you may simply clone the GitHub repo and source the files required. (You should probably fork it instead to keep your customisations) $ git clone https://github.com/bash-my-universe/bash-my-aws.git ~/.bash-my-aws Put the following in your shell's startup file: export PATH = \" $PATH : $HOME /.bash-my-aws/bin\" source ~/.bash-my-aws/aliases # For ZSH users, uncomment the following two lines: # autoload -U +X compinit && compinit # autoload -U +X bashcompinit && bashcompinit source ~/.bash-my-aws/bash_completion.sh Why use shell aliases? bash-my-aws began as a collection of bash functions, sourced into your shell. More recently, the default suggestion has been to load aliases that execute a small wrapper script that loads the functions and executes the desired function. After years of zsh users asking for support, one stepped up and identified a changes that would eliminate any shell compatibility problems without compromising the functionaility, simplicity and discoverability of the project. Massive thanks to @ninth-dev for this. # bash users may source the functions instead of loading the aliases if [ -d ${HOME}/.bash-my-aws ]; then for f in ~/.bash-my-aws/lib/*-functions; do source $f; done fi Usage \u00b6 Running Commands \u00b6 The default way to run the commands is using the aliases: $ instances i-e6f097f6ea4457757 ami-123456789012 t3.nano running example-ec2-ap-southeast-2 2019-12-07T08:12:00.000Z ap-southeast-2a None i-b983805b4b254f749 ami-123456789012 t3.nano running postfix-prod 2019-12-07T08:26:30.000Z ap-southeast-2a None i-fed39ebe7204dfd37 ami-123456789012 t3.nano running postfix-prod 2019-12-07T08:26:34.000Z ap-southeast-2a None i-47955eb46d98b4dd8 ami-123456789012 t3.nano running prometheus 2019-12-07T08:27:02.000Z ap-southeast-2a None i-8d25b78d40d17f38a ami-123456789012 t3.nano running plex-server 2019-12-07T08:27:38.000Z ap-southeast-2a None It's also possible to run them using the bma wrapper. (This is sometimes required when using a restrictive auth tool.) $ bma instances i-e6f097f6ea4457757 ami-123456789012 t3.nano running example-ec2-ap-southeast-2 2019-12-07T08:12:00.000Z ap-southeast-2a None i-b983805b4b254f749 ami-123456789012 t3.nano running postfix-prod 2019-12-07T08:26:30.000Z ap-southeast-2a None i-fed39ebe7204dfd37 ami-123456789012 t3.nano running postfix-prod 2019-12-07T08:26:34.000Z ap-southeast-2a None i-47955eb46d98b4dd8 ami-123456789012 t3.nano running prometheus 2019-12-07T08:27:02.000Z ap-southeast-2a None i-8d25b78d40d17f38a ami-123456789012 t3.nano running plex-server 2019-12-07T08:27:38.000Z ap-southeast-2a None Discovering Commands \u00b6 For each resource type, there is a command to list them: $ instances i-e6f097f6ea4457757 ami-123456789012 t3.nano running example-ec2-ap-southeast-2 2019 -12-07T08:12:00.000Z ap-southeast-2a None i-b983805b4b254f749 ami-123456789012 t3.nano running postfix-prod 2019 -12-07T08:26:30.000Z ap-southeast-2a None i-fed39ebe7204dfd37 ami-123456789012 t3.nano running postfix-prod 2019 -12-07T08:26:34.000Z ap-southeast-2a None i-47955eb46d98b4dd8 ami-123456789012 t3.nano running prometheus 2019 -12-07T08:27:02.000Z ap-southeast-2a None i-8d25b78d40d17f38a ami-123456789012 t3.nano running plex-server 2019 -12-07T08:27:38.000Z ap-southeast-2a None and a number of command to act on these resources: $ instance-[TAB][TAB] instance-asg instance-ssh-details instance-termination-protection instance-az instance-stack instance-termination-protection-disable instance-console instance-start instance-termination-protection-enable instance-dns instance-state instance-type instance-iam-profile instance-stop instance-userdata instance-ip instance-tags instance-volumes instance-ssh instance-terminate instance-vpc Whether you're new to the tools or just have a bad memory, bash completion makes discovering these commands simple. See the Command Reference for a full list with usage examples Piping Between Commands \u00b6 This is where the magic happens! The first token on each line is almost always a resource identifier. When you pipe output between the commands they just take the first token from each line. $ instances | grep postfix | instance-ip i-b983805b4b254f749 10.190.1.70 54.214.71.51 i-fed39ebe7204dfd37 10.135.204.82 54.214.26.190 Note Most commands that list resources ( stacks , instances , etc) accept filter term as first arg. As well as reducing keystrokes, it can also improve output as columnisation is done after filtering. $ instances postfix | instance-ip i-b983805b4b254f749 10.190.1.70 54.214.71.51 i-fed39ebe7204dfd37 10.135.204.82 54.214.26.190 Inspecting Commands \u00b6 For those interested in how it works: Each command is a bash function. Most are very simple and wrap an AWSCLI command. For a quick look at how a command works, you can use bma type : $ bma type instances instances is a function instances () { local instance_ids = $( __bma_read_inputs ) ; local filters = $( __bma_read_filters $@ ) ; aws ec2 describe-instances $( [[ -n ${ instance_ids } ]] && echo --instance-ids ${ instance_ids } ) --query \" Reservations[].Instances[][ InstanceId, ImageId, InstanceType, State.Name, [Tags[?Key=='Name'].Value][0][0], LaunchTime, Placement.AvailabilityZone, VpcId ]\" --output text | grep -E -- \" $filters \" | LC_ALL = C sort -b -k 6 | column -s ' ' -t } A prettier version can be found in the source code: # ~/.bash-my-aws/lib/instance-functions instances () { local instance_ids = $( __bma_read_inputs ) local filters = $( __bma_read_filters $@ ) aws ec2 describe-instances \\ $( [[ -n ${ instance_ids } ]] && echo --instance-ids ${ instance_ids } ) \\ --query \" Reservations[].Instances[][ InstanceId, ImageId, InstanceType, State.Name, [Tags[?Key=='Name'].Value][0][0], LaunchTime, Placement.AvailabilityZone, VpcId ]\" \\ --output text | grep -E -- \" $filters \" | LC_ALL = C sort -b -k 6 | column -s $'\\t' -t } For more info on AWSCLI query syntax, check out http://jmespath.org/tutorial.html","title":"Home"},{"location":"#introduction","text":"Short, Memorable Commands Shell Command Completion (including AWS resources) Unix Pipeline Friendly (instead of JSON) Convenient Shortcuts","title":"Introduction"},{"location":"#short-memorable-commands","text":"There are two main types of commands. 1. Resource Listing Commands These generally consist of the pluralised form of the resource name. $ buckets example-assets 2019 -12-08 02 :35:44.758551 example-logs 2019 -12-08 02 :35:52.669771 example-backups 2019 -12-08 02 :35:56.579434 $ stacks nagios CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED postgres01 CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED postgres02 CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED prometheus CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED $ keypairs alice 8f:85:9a:1e:6c:76:29:34:37:45:de:7f:8d:f9:70:eb bob 56 :73:29:c2:ad:7b:6f:b6:f2:f3:b4:de:e4:2b:12:d4 carol 29 :4e:1c:cb:ba:d4:85:0e:4f:b6:34:4c:d4:79:32:00 2. Resource detail/action commands These generally consist of a resource name and action separated by a hyphen. This makes discovering them via shell completion simple. Some retrieve information about resources while others make changes to them. $ keypair-delete alice bob You are about to delete the following EC2 SSH KeyPairs: alice bob Are you sure you want to continue ? y See the Command Reference for a full list of commands.","title":"Short, Memorable Commands"},{"location":"#shell-command-completion","text":"In the example above, shell autocompletion retrieved the existing EC2 Keypair names ( alice , bob ) from AWS. This helps avoid the need to rely on human memory or terminal copypasta.","title":"Shell Command Completion"},{"location":"#unix-pipeline-friendly","text":"The commands themselves are line oriented and work nicely in unix pipelines with other unix commands (e.g. grep , awk , etc). $ stacks | grep postgres postgres01 CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED postgres02 CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED They also work incredibly well with each other due to the way they treat input from STDIN. The first token from each line of STDIN is taken to be a resource identifiers (and the rest is discarded). $ stacks | grep postgres | stack-delete You are about to delete the following stacks: postgres01 postgres02 Are you sure you want to continue ? y Some users have compared this User Experience to functionality in Windows Powershell.","title":"Unix Pipeline Friendly"},{"location":"#convenient-shortcuts","text":"bash-my-aws is insanely simple to pick up and start using but contains a lot of convenient shortcuts you can make use of. Example: resource listing commands accept a filter argument, removing the need for | grep . In the following example someone has given a CloudFormation stack a really long name: $ stacks nagios CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED postgres01 DELETE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED postgres02 DELETE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED prometheus CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED stack-with-a-annoyingly-long-name CREATE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED This affects the output when we look at our postgress stacks: $ stacks | grep postgres postgres01 DELETE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED postgres02 DELETE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED The resource listing command can filter output before applying column . $ stacks postgres postgres01 DELETE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED postgres02 DELETE_COMPLETE 2011 -05-23T15:47:44Z NEVER_UPDATED NOT_NESTED","title":"Convenient Shortcuts"},{"location":"#quickstart","text":"","title":"Quickstart"},{"location":"#prerequisites","text":"awscli bash jq-1.4 or later (for stack-diff)","title":"Prerequisites"},{"location":"#installation","text":"As shown below, you may simply clone the GitHub repo and source the files required. (You should probably fork it instead to keep your customisations) $ git clone https://github.com/bash-my-universe/bash-my-aws.git ~/.bash-my-aws Put the following in your shell's startup file: export PATH = \" $PATH : $HOME /.bash-my-aws/bin\" source ~/.bash-my-aws/aliases # For ZSH users, uncomment the following two lines: # autoload -U +X compinit && compinit # autoload -U +X bashcompinit && bashcompinit source ~/.bash-my-aws/bash_completion.sh Why use shell aliases? bash-my-aws began as a collection of bash functions, sourced into your shell. More recently, the default suggestion has been to load aliases that execute a small wrapper script that loads the functions and executes the desired function. After years of zsh users asking for support, one stepped up and identified a changes that would eliminate any shell compatibility problems without compromising the functionaility, simplicity and discoverability of the project. Massive thanks to @ninth-dev for this. # bash users may source the functions instead of loading the aliases if [ -d ${HOME}/.bash-my-aws ]; then for f in ~/.bash-my-aws/lib/*-functions; do source $f; done fi","title":"Installation"},{"location":"#usage","text":"","title":"Usage"},{"location":"#running-commands","text":"The default way to run the commands is using the aliases: $ instances i-e6f097f6ea4457757 ami-123456789012 t3.nano running example-ec2-ap-southeast-2 2019-12-07T08:12:00.000Z ap-southeast-2a None i-b983805b4b254f749 ami-123456789012 t3.nano running postfix-prod 2019-12-07T08:26:30.000Z ap-southeast-2a None i-fed39ebe7204dfd37 ami-123456789012 t3.nano running postfix-prod 2019-12-07T08:26:34.000Z ap-southeast-2a None i-47955eb46d98b4dd8 ami-123456789012 t3.nano running prometheus 2019-12-07T08:27:02.000Z ap-southeast-2a None i-8d25b78d40d17f38a ami-123456789012 t3.nano running plex-server 2019-12-07T08:27:38.000Z ap-southeast-2a None It's also possible to run them using the bma wrapper. (This is sometimes required when using a restrictive auth tool.) $ bma instances i-e6f097f6ea4457757 ami-123456789012 t3.nano running example-ec2-ap-southeast-2 2019-12-07T08:12:00.000Z ap-southeast-2a None i-b983805b4b254f749 ami-123456789012 t3.nano running postfix-prod 2019-12-07T08:26:30.000Z ap-southeast-2a None i-fed39ebe7204dfd37 ami-123456789012 t3.nano running postfix-prod 2019-12-07T08:26:34.000Z ap-southeast-2a None i-47955eb46d98b4dd8 ami-123456789012 t3.nano running prometheus 2019-12-07T08:27:02.000Z ap-southeast-2a None i-8d25b78d40d17f38a ami-123456789012 t3.nano running plex-server 2019-12-07T08:27:38.000Z ap-southeast-2a None","title":"Running Commands"},{"location":"#discovering-commands","text":"For each resource type, there is a command to list them: $ instances i-e6f097f6ea4457757 ami-123456789012 t3.nano running example-ec2-ap-southeast-2 2019 -12-07T08:12:00.000Z ap-southeast-2a None i-b983805b4b254f749 ami-123456789012 t3.nano running postfix-prod 2019 -12-07T08:26:30.000Z ap-southeast-2a None i-fed39ebe7204dfd37 ami-123456789012 t3.nano running postfix-prod 2019 -12-07T08:26:34.000Z ap-southeast-2a None i-47955eb46d98b4dd8 ami-123456789012 t3.nano running prometheus 2019 -12-07T08:27:02.000Z ap-southeast-2a None i-8d25b78d40d17f38a ami-123456789012 t3.nano running plex-server 2019 -12-07T08:27:38.000Z ap-southeast-2a None and a number of command to act on these resources: $ instance-[TAB][TAB] instance-asg instance-ssh-details instance-termination-protection instance-az instance-stack instance-termination-protection-disable instance-console instance-start instance-termination-protection-enable instance-dns instance-state instance-type instance-iam-profile instance-stop instance-userdata instance-ip instance-tags instance-volumes instance-ssh instance-terminate instance-vpc Whether you're new to the tools or just have a bad memory, bash completion makes discovering these commands simple. See the Command Reference for a full list with usage examples","title":"Discovering Commands"},{"location":"#piping-between-commands","text":"This is where the magic happens! The first token on each line is almost always a resource identifier. When you pipe output between the commands they just take the first token from each line. $ instances | grep postfix | instance-ip i-b983805b4b254f749 10.190.1.70 54.214.71.51 i-fed39ebe7204dfd37 10.135.204.82 54.214.26.190 Note Most commands that list resources ( stacks , instances , etc) accept filter term as first arg. As well as reducing keystrokes, it can also improve output as columnisation is done after filtering. $ instances postfix | instance-ip i-b983805b4b254f749 10.190.1.70 54.214.71.51 i-fed39ebe7204dfd37 10.135.204.82 54.214.26.190","title":"Piping Between Commands"},{"location":"#inspecting-commands","text":"For those interested in how it works: Each command is a bash function. Most are very simple and wrap an AWSCLI command. For a quick look at how a command works, you can use bma type : $ bma type instances instances is a function instances () { local instance_ids = $( __bma_read_inputs ) ; local filters = $( __bma_read_filters $@ ) ; aws ec2 describe-instances $( [[ -n ${ instance_ids } ]] && echo --instance-ids ${ instance_ids } ) --query \" Reservations[].Instances[][ InstanceId, ImageId, InstanceType, State.Name, [Tags[?Key=='Name'].Value][0][0], LaunchTime, Placement.AvailabilityZone, VpcId ]\" --output text | grep -E -- \" $filters \" | LC_ALL = C sort -b -k 6 | column -s ' ' -t } A prettier version can be found in the source code: # ~/.bash-my-aws/lib/instance-functions instances () { local instance_ids = $( __bma_read_inputs ) local filters = $( __bma_read_filters $@ ) aws ec2 describe-instances \\ $( [[ -n ${ instance_ids } ]] && echo --instance-ids ${ instance_ids } ) \\ --query \" Reservations[].Instances[][ InstanceId, ImageId, InstanceType, State.Name, [Tags[?Key=='Name'].Value][0][0], LaunchTime, Placement.AvailabilityZone, VpcId ]\" \\ --output text | grep -E -- \" $filters \" | LC_ALL = C sort -b -k 6 | column -s $'\\t' -t } For more info on AWSCLI query syntax, check out http://jmespath.org/tutorial.html","title":"Inspecting Commands"},{"location":"cfn-naming/","text":"Suggested stack/template/param file naming conventions \u00b6 bash-my-aws can take a lot of the effort out of creating and updating CloudFormation (CFN) stacks. Tab completion on remote stack names and even local file names is provided. Additionally, the create/update/diff commands can make life much easier if you follow some simple file naming conventions. These are completely optional. stack : token-env template: token.yml params : token-params-env.json or params/token-params-env.json Where: token : describes the resources (mywebsite, vpc, bastion, etc) env : environment descriptor (dev, test, prod, etc) Following these (entirely optional) conventions means bash-my-aws can infer template & params file from stack name. For example: $ stack-create mywebsite-test is equivalent (if files present) to: $ stack-create mywebsite-test mywebsite.yml mywebsite-params-test.json you could even achieve the same result with: $ stack-create mywebsite-params-test.json Other benefits include: ease in locating stack for template (and vice versa) based on name template and params files are listed together on filesystem stack name env suffixes protect against accidents (wrong account error) supports prodlike non-prod environments through using same template And don't forget, these naming conventions are completely optional.","title":"CloudFormation Naming"},{"location":"cfn-naming/#suggested-stacktemplateparam-file-naming-conventions","text":"bash-my-aws can take a lot of the effort out of creating and updating CloudFormation (CFN) stacks. Tab completion on remote stack names and even local file names is provided. Additionally, the create/update/diff commands can make life much easier if you follow some simple file naming conventions. These are completely optional. stack : token-env template: token.yml params : token-params-env.json or params/token-params-env.json Where: token : describes the resources (mywebsite, vpc, bastion, etc) env : environment descriptor (dev, test, prod, etc) Following these (entirely optional) conventions means bash-my-aws can infer template & params file from stack name. For example: $ stack-create mywebsite-test is equivalent (if files present) to: $ stack-create mywebsite-test mywebsite.yml mywebsite-params-test.json you could even achieve the same result with: $ stack-create mywebsite-params-test.json Other benefits include: ease in locating stack for template (and vice versa) based on name template and params files are listed together on filesystem stack name env suffixes protect against accidents (wrong account error) supports prodlike non-prod environments through using same template And don't forget, these naming conventions are completely optional.","title":"Suggested stack/template/param file naming conventions"},{"location":"command-reference-test/","text":"The project provides over 120 commands but fear not, much has been done to make them discoverable , memorable and hopefully in many cases obvious . The reference material below is all extracted from the source of the commands. While not necessary to use the commands. Be curious. Read the source. :-) Lists in this project are alphabetised except where it makes sense not to. The first few sets of commands were chosen because they are likely to be of the most interest to readers. General Rules Commands expect $AWS_DEFAULT_REGION environment variable to be set (check/set with region command) Most commands that list resources ( stacks , `instances , etc) accept filter term as first arg. e.g. stacks blah is equivalent to stacks | grep blah Most commands accept resource identifiers via STDIN (first token of each line) Resources are generally listed in chronological order of creation. aws-account-commands \u00b6 aws-account-alias \u00b6 Retrieve AWS Account Alias for current account $ aws-account-alias example-account-prod aws-account-id \u00b6 Retrieve AWS Account ID for current account $ aws-account-id 012345678901 aws-account-each \u00b6 Run a script/command across a number of AWS Accounts USAGE: aws-account-each cmd # pipe in AWS_ACCOUNT_IDS $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED # account=012345678901 alias=example-account-prod example-stack1-prod CREATED_FAILED example-stack2-prod UPDATE_ROLLBACK_FAILED # account=123456789012 alias=example-account-staging example-stack1-staging CREATED_FAILED example-stack2-staging UPDATE_ROLLBACK_FAILED Note In order to use aws-account-each , you need to be authenticated with an IAM Role that can assume a Role in each of the specified accounts. Check the source for more info. aws-panopticon \u00b6 aws-panopticon was previous name for aws-account-each() aws-account-cost-explorer \u00b6 Use with an AWS Organisations Master Account to open multiple accounts in Cost Explorer. $ grep demo AWS_ACCOUNTS | aws-account-cost-explorer #=> Opens web browser to AWS Cost Explorer with accounts selected aws-account-cost-recommendations \u00b6 Use with an AWS Organisations Master Account to open multiple accounts in Cost Recommendations. $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED #=> Opens web browser to AWS Cost Recommendations with accounts selected region-commands \u00b6 regions \u00b6 List regions The region() function must be sourced in order to update the AWS_DEFAULT_REGION environment variable. This is because it cannot update an environment variable when run as a subprocess. $ regions ap-northeast-1 ap-northeast-2 ap-south-1 ap-southeast-1 ap-southeast-2 ... us-west-2 region \u00b6 Get/Set $AWS_DEFAULT_REGION shell environment variable $ region us-east-1 $ region ap-southeast-2 $ region ap-southeast-2 region-each \u00b6 Run a command in every region. Any output lines will be appended with \"#${REGION}\". $ region-each stacks | column -t example-ec2-ap-northeast-1 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-1 example-ec2-ap-northeast-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-2 ... example-ec2-us-west-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #us-west-2 stack-commands \u00b6 stacks \u00b6 List CloudFormation stacks. To make it fly we omit stacks with status of DELETE_COMPLETE Output is sorted by CreationTime $ stacks nagios CREATE_COMPLETE 2018-03-12T11:41:31Z NEVER_UPDATED NOT_NESTED postgres1 CREATE_COMPLETE 2019-04-14T15:22:44Z NEVER_UPDATED NOT_NESTED postgres2 CREATE_COMPLETE 2019-05-18T05:45:50Z NEVER_UPDATED NOT_NESTED prometheus-web CREATE_COMPLETE 2019-11-23T15:57:04Z NEVER_UPDATED NOT_NESTED Provide a filter string for a | grep effect with tighter columisation: $ stacks postgres postgres1 CREATE_COMPLETE 2019-04-14T15:22:44Z NEVER_UPDATED NOT_NESTED postgres2 CREATE_COMPLETE 2019-05-18T05:45:50Z NEVER_UPDATED NOT_NESTED stack-arn \u00b6 Returns ARN(s) for stacks. USAGE: stack-arn stack [stack] $ stack-arn prometheus-web arn:aws:cloudformation:us-east-1:000000000000:stack/prometheus-web/805e081c-b8eb-4f6c-9872-2b5cddc77fba Supports multiple stack names from STDIN : $ stacks | stack-arn arn:aws:cloudformation:us-east-1:000000000000:stack/nagios/c0f0ef04-b505-4c0c-87cd-ca924153ad1c arn:aws:cloudformation:us-east-1:000000000000:stack/postgres1/758b0ba2-60f2-4432-8935-f79f47708f23 arn:aws:cloudformation:us-east-1:000000000000:stack/postgres2/7420bbd4-3026-444f-b55b-fa0a9d564730 arn:aws:cloudformation:us-east-1:000000000000:stack/prometheus-web/805e081c-b8eb-4f6c-9872-2b5cddc77fba stack-cancel-update \u00b6 stack-create \u00b6 stack-update \u00b6 stack-delete \u00b6 delete an existing stack stack-exports \u00b6 stack-recreate \u00b6 stack-failure \u00b6 type: detail return the reason a stack failed to update/create/delete FIXME: only grab the latest failure stack-events \u00b6 List event history for a single Stack USAGE: stack-events stack stack-resources \u00b6 List all resources in Stack(s) USAGE: stack-resources stack [stack] $ stacks | stack-resources i-7d54924538baa7a1f AWS::EC2::Instance ec2 i-c54279c6055c3c794 AWS::EC2::Instance nagios i-a8b8dd6783e1a40cc AWS::EC2::Instance postgres1 i-5d74753e210bfe04d AWS::EC2::Instance postgres2 i-2aa95cc214a461398 AWS::EC2::Instance prometheus-web stack-asgs \u00b6 List ASGs in Stack(s) USAGE: stack-asgs stack [stack] $ stacks | stack-asgs asg-bash-my-aws-AutoScalingGroup-MSBCWRTI3PVM AWS::AutoScaling::AutoScalingGroup asg-bash-my-aws asg2-AutoScalingGroup-1FHUVUJ7SLPU7 AWS::AutoScaling::AutoScalingGroup asg2 stack-asg-instances \u00b6 List EC2 Instances of EC2 Autoscaling Groups in Stack(s) USAGE: stack-asg-instances stack [stack] $ stacks | stack-asg-instances i-06ee900565652ecc5 ami-0119aa4d67e59007c t3.nano running asg-bash-my-aws 2019-12-13T03:15:22.000Z ap-southeast-2c vpc-deb8edb9 i-01c7edb986c18c16a ami-0119aa4d67e59007c t3.nano running asg2 2019-12-13T03:37:51.000Z ap-southeast-2c vpc-deb8edb9 stack-elbs \u00b6 List EC2 Elastic Load Balancers in Stack(s) USAGE: stack-elbs stack [stack] $ stacks | stack-elbs elb-MyLoadBalancer-NA5S72MLA5KI AWS::ElasticLoadBalancing::LoadBalancer elb-stack-1 load-bala-MyLoadBa-11HZ0DHUHJZZI AWS::ElasticLoadBalancing::LoadBalancer elb-stack-2 stack-instances \u00b6 List instances in stack(s) USAGE: stack-instances stack [stack] $ stacks | stack-instances i-7d54924538baa7a1f ami-123456789012 t3.nano stopped ec2 2019-12-11T09:31:03.000Z ap-southeast-2a None i-c54279c6055c3c794 ami-123456789012 t3.nano running nagios 2019-12-13T02:24:30.000Z ap-southeast-2a None i-a8b8dd6783e1a40cc ami-123456789012 t3.nano running postgres1 2019-12-13T02:24:32.000Z ap-southeast-2a None i-5d74753e210bfe04d ami-123456789012 t3.nano running postgres2 2019-12-13T02:24:34.000Z ap-southeast-2a None i-2aa95cc214a461398 ami-123456789012 t3.nano running prometheus-web 2019-12-13T02:24:36.000Z ap-southeast-2a None stack-parameters \u00b6 return the parameters applied to a stack stack-status \u00b6 type: detail return the current status of a stack stack-tag \u00b6 return a selected stack tag stack-tag-apply \u00b6 apply a stack tag stack-tag-delete \u00b6 delete a stack tag stack-tail \u00b6 type: detail follow the events occuring for a stack stack-template \u00b6 return the template applied to a stack stack-tags \u00b6 return the stack-tags applied to a stack stack-tags-text \u00b6 return all stack tags on a single line stack-outputs \u00b6 type: detail return the outputs of a stack stack-validate \u00b6 type: detail validate a stack template stack-diff \u00b6 type: detail return differences between a template and Stack report changes which would be made to stack if template were applied report on what changes would be made to stack by applying params If we are working from a single argument (ignore args starting with -- ) Strip path and extension from template Deduce params filename from stack and template names Strip path and extension from template File extension gets stripped off if template name provided as stack name Determine name of template to use determine name of params file to use determine what (if any) capabilities a given stack was deployed with instance-commands \u00b6 instances \u00b6 List EC2 Instances $ instances i-4e15ece1de1a3f869 ami-123456789012 t3.nano running nagios 2019-12-10T08:17:18.000Z ap-southeast-2a None i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None i-61e86ac6be1e2c193 ami-123456789012 t3.nano running prometheus-web 2019-12-10T08:17:24.000Z ap-southeast-2a None Optionally provide a filter string for a | grep effect with tighter columisation: $ instances postgres i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None instance-asg \u00b6 List autoscaling group membership of EC2 Instance(s) USAGE: instance-asg instance-id [instance-id] instance-az \u00b6 List availability zone of EC2 Instance(s) USAGE: instance-az instance-id [instance-id] $ instances postgres | instance-az i-89cefa9403373d7a5 ap-southeast-2a i-806d8f1592e2a2efd ap-southeast-2a instance-console \u00b6 List console output of EC2 Instance(s) USAGE: instance-console instance-id [instance-id] $ instances postgres | instance-console Console output for EC2 Instance i-89cefa9403373d7a5 Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip... Console output for EC2 Instance i-806d8f1592e2a2efd Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip... instance-dns \u00b6 List DNS name of EC2 Instance(s) USAGE: instance-dns instance-id [instance-id] $ instances postgres | instance-dns i-89cefa9403373d7a5 ip-10-155-35-61.ap-southeast-2.compute.internal ec2-54-214-206-114.ap-southeast-2.compute.amazonaws.com i-806d8f1592e2a2efd ip-10-178-243-63.ap-southeast-2.compute.internal ec2-54-214-244-90.ap-southeast-2.compute.amazonaws.com instance-health-set-unhealthy \u00b6 Mark EC2 Instance(s) as unhealthy (to trigger replacement by ASG) USAGE: instance-health-set-unhealthy instance-id [instance-id] instance-iam-profile \u00b6 List iam-profile of EC2 Instance(s) USAGE: instance-iam-profile instance-id [instance-id] instance-ip \u00b6 List ip address of EC2 Instance(s) USAGE: instance-ip instance-id [instance-id] $ instances postgres | instance-ip i-89cefa9403373d7a5 10.155.35.61 54.214.206.114 i-806d8f1592e2a2efd 10.178.243.63 54.214.244.90 instance-ssh \u00b6 Establish SSH connection to EC2 Instance(s) USAGE: instance-ssh [login] [instance-id] [instance-id] instance-ssh-details \u00b6 List details needed to SSH into EC2 Instance(s) USAGE: instance-ssh-details [login] [instance-id] [instance-id] instance-stack \u00b6 List CloudFormation stack EC2 Instance(s) belong to (if any) USAGE: instance-stack instance-id [instance-id] $ instances postgres | instance-stack postgres1 i-89cefa9403373d7a5 postgres2 i-806d8f1592e2a2efd instance-start \u00b6 Start stopped EC2 Instance(s) USAGE: instance-start instance-id [instance-id] $ instances postgres | instance-start i-a8b8dd6783e1a40cc PreviousState=stopped CurrentState=pending i-5d74753e210bfe04d PreviousState=stopped CurrentState=pending instance-state \u00b6 List state of EC2 Instance(s) USAGE: instance-state instance-id [instance-id] $ instances postgres | instance-state i-89cefa9403373d7a5 running i-806d8f1592e2a2efd running instance-stop \u00b6 Stop EC2 Instance(s) USAGE: instance-stop instance-id [instance-id] $ instances postgres | instance-stop i-a8b8dd6783e1a40cc PreviousState=running CurrentState=stopping i-5d74753e210bfe04d PreviousState=running CurrentState=stopping instance-tags \u00b6 List tags applied EC2 Instance(s) USAGE: instance-tags instance-id [instance-id] instance-terminate \u00b6 Terminate EC2 Instance(s) USAGE: instance-terminate instance-id [instance-id] $ instances | head -3 | instance-terminate You are about to terminate the following instances: i-01c7edb986c18c16a ami-0119aa4d67e59007c t3.nano terminated asg2 2019-12-13T03:37:51.000Z ap-southeast-2c None i-012dded46894dfa04 ami-0119aa4d67e59007c t3.nano running ec2 2019-12-13T10:12:55.000Z ap-southeast-2b vpc-deb8edb9 Are you sure you want to continue? y i-06ee900565652ecc5 PreviousState=terminated CurrentState=terminated i-01c7edb986c18c16a PreviousState=terminated CurrentState=terminated i-012dded46894dfa04 PreviousState=running CurrentState=shutting-down instance-termination-protection \u00b6 List current state of Termination Protection for EC2 Instance(s) USAGE: instance-termination-protection instance-id [instance-id] $ instances | instance-termination-protection i-4e15ece1de1a3f869 DisableApiTermination=true i-89cefa9403373d7a5 DisableApiTermination=false i-806d8f1592e2a2efd DisableApiTermination=false i-61e86ac6be1e2c193 DisableApiTermination=false instance-termination-protection-disable \u00b6 Disable EC2 Instance termination protection USAGE: instance-termination-protection-disable instance-id [instance-id] instance-termination-protection-enable \u00b6 Enable EC2 Instance termination protection USAGE: instance-termination-protection-enable instance-id [instance-id] instance-type \u00b6 List type of instance(s) USAGE: instance-type instance-id [instance-id] $ instances | instance-type i-4e15ece1de1a3f869 t3.nano i-89cefa9403373d7a5 t3.nano i-806d8f1592e2a2efd t3.nano i-61e86ac6be1e2c193 t3.nano instance-userdata \u00b6 List userdata for instance(s) USAGE: instance-userdata instance-id [instance-id] instance-volumes \u00b6 List volumes of instance(s) USAGE: instance-volumes instance-id [instance-id] $ instances postgres | instance-volumes i-89cefa9403373d7a5 vol-cf5ddae9 i-806d8f1592e2a2efd vol-38fd45c3 instance-vpc \u00b6 List VPC of instance(s) USAGE: instance-vpcs instance-id [instance-id] asg-commands \u00b6 asgs \u00b6 List EC2 Autoscaling Groups asg-capacity \u00b6 List min, desired and maximum capacities of EC2 Autoscaling Group(s) asg-desired-size-set \u00b6 Set desired capacity of autoscaling group(s) asg-instances \u00b6 List instances of autoscaling group(s) asg-launch-configuration \u00b6 List Launch Configurations of Autoscaling Group(s) launch-configurations \u00b6 List Launch Configurations launch-configuration-asgs \u00b6 List EC2 Autoscaling Groups of Launch COnfiguration(s) asg-max-size-set \u00b6 Set maximum size of autoscaling group(s) asg-min-size-set \u00b6 Set minimum size of autoscaling group(s) asg-processes_suspended \u00b6 List suspended processes of an autoscaling group asg-resume \u00b6 Resume all processes of an autoscaling group asg-suspend \u00b6 Suspend all processes of an autoscaling group asg-stack \u00b6 List CloudFormation stack for asg(s) asg-scaling-activities \u00b6 List scaling activities for Autoscaling Group(s) cert-commands \u00b6 certs \u00b6 List ACM Certificates certs-arn \u00b6 Same as certs but with the ARN in first column cert-users \u00b6 List resources using ACM Cert(s) USAGE: cert-users cert-arn [cert-arn] cert-delete \u00b6 Delete ACM Cert(s) USAGE: cert-delete cert-arn [cert-arn] cloudtrail-commands \u00b6 cloudtrails \u00b6 List Cloudtrails $ cloudtrails failmode failmode-cloudtrail ap-southeast-2 IsMultiRegionTrail=true IncludeGlobalServiceEvents=true cloudtrail-status \u00b6 List logging status of Cloudtrails USAGE: cloudtrail-status cloudtrail [cloudtrail] ecr-commands \u00b6 ecr-repositories \u00b6 List ECR Repositories ecr-repository-images \u00b6 List images for ECR Repositories elb-commands \u00b6 elbs \u00b6 List ELBs Accepts LoadBalancer names or ARNS on STDIN and converts to LoadBalancer names $ elbs elb-MyLoadBalancer-1FNISWJN0W6N9 2019-12-13T10:24:55.220Z subnet-eff2cf88 another-e-MyLoadBa-171CPCZF2E84T 2019-12-13T10:25:24.300Z subnet-eff2cf88 elb-dnsname \u00b6 List DNS Names of ELB(s) USAGE: elb-dnsname load-balancer [load-balancer] $ elbs | elb-dnsname elb-MyLoadBalancer-1FNISWJN0W6N9 elb-MyLoadBalancer-1FNISWJN0W6N9-563832045.ap-southeast-2.elb.amazonaws.com another-e-MyLoadBa-171CPCZF2E84T another-e-MyLoadBa-171CPCZF2E84T-1832721930.ap-southeast-2.elb.amazonaws.com elb-instances \u00b6 List instances of ELB(s) USAGE: elb-instances load-balancer [load-balancer] elb-stack \u00b6 List CloudFormation stack names of ELB(s) USAGE: elb-stack load-balancer [load-balancer] $ elbs | elb-stack elb elb-MyLoadBalancer-1FNISWJN0W6N9 another-elb another-e-MyLoadBa-171CPCZF2E84T iam-commands \u00b6 iam-roles \u00b6 List IAM Roles $ iam-roles config-role-ap-southeast-2 AROAI3QHAU3J2CDRNLQHD 2017-02-02T03:03:02Z AWSBatchServiceRole AROAJJWRGUPTRXTV52TED 2017-03-09T05:31:39Z ecsInstanceRole AROAJFQ3WMZXESGIKW5YD 2017-03-09T05:31:39Z iam-role-principal \u00b6 List role principal for IAM Role(s) USAGE: iam-role-principal role-name [role-name] image-commands \u00b6 images \u00b6 List EC2 AMI's Usage: images [owner] [image-id] [image-id]... owner defaults to self or can one or more of: an AWS_ACCOUNT_ID (e.g. 1234567890) an AWS_OWNER_ALIAS (amazon, amazon-marketplace, microsoft) image_id can be one or more AMIs Trialing a different approach for grabbing resource ids from input. As normal, you can pipe resource ids in as first token on each line. We treat all args that don't start with ami- as owner identifiers. Trialing a new pattern for output - putting the Name at the end. This is more like the output of ls -la Pro: Preceding fields tend to be of the same length Pro: Easier for eyes to scan final column for names(?) Con: Using this pattern for instances() would put name past 80 char point Con: Migrating instances() to this output is A Big Change (not made lightly) image-deregister \u00b6 Deregister AMI(s) USAGE: image-deregister image_id [image_id] keypair-commands \u00b6 keypairs \u00b6 List EC2 SSH Keypairs in current Region $ keypairs alice 8f:85:9a:1e:6c:76:29:34:37:45:de:7f:8d:f9:70:eb bob 56:73:29:c2:ad:7b:6f:b6:f2:f3:b4:de:e4:2b:12:d4 keypair-create \u00b6 Create SSH Keypair on local machine and import public key into new EC2 Keypair. Provides benefits over AWS creating the keypair: Amazon never has access to private key. Private key is protected with passphrase before being written to disk. Keys is written to ~/.ssh with correct file permissions. You control the SSH Key type (algorithm, length, etc). USAGE: keypair-delete key_name [key_name] $ keypair-create yet-another-keypair Creating /home/m/.ssh/yet-another-keypair Generating public/private rsa key pair. Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/m/.ssh/yet-another-keypair. Your public key has been saved in /home/m/.ssh/yet-another-keypair.pub. The key fingerprint is: SHA256:zIpbxLo7rpQvKyezOLATk96B1kSL0QP41q6x8tUrySk m@localhost.localdomain The key's randomart image is: +---[RSA 4096]----+ |..o | |.. + | | .+.o | | .oo.. o | | o+. o S | |=o.+.= . | |+++==o+ | |XoE+*+ . | |o@+**+. | +----[SHA256]-----+ { \"KeyFingerprint\": \"21:82:f9:5b:79:d6:dc:0f:7b:79:43:7c:c5:34:6c:2d\", \"KeyName\": \"yet-another-keypair\" } Note KeyPair Name defaults to \"$(aws-account-alias)-$(region)\" if none provided keypair-delete \u00b6 Delete EC2 SSH Keypairs by providing their names as arguments or via STDIN USAGE: keypair-delete key_name [key_name] $ keypair-delete alice bob You are about to delete the following EC2 SSH KeyPairs: alice bob Are you sure you want to continue? y $ keypairs | keypair-delete You are about to delete the following EC2 SSH KeyPairs: yet-another-keypair Are you sure you want to continue? y kms-commands \u00b6 kms-encrypt \u00b6 Encrypt and base64 encode STDIN or file USAGE: kms-encrypt key_id/alias_id [plaintext_file] $ echo foobar | kms-encrypt alias/default AQICAHgcyN4vd3V/OB7NKI6IMbpENEu1+UfyiU... kms-decrypt \u00b6 base64 decode and decrypt KMS Encrypted file or STDIN USAGE: kms-decrypt [ciphertext_file] $ kms-decrypt ciphertext.txt foobar $ echo foobar | kms-encrypt alias/default | kms-decrypt foobar kms-aliases \u00b6 List KMS Aliases $ kms-aliases default alias/default d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/default kms-alias-create \u00b6 Create alias for KMS Key USAGE: kms-alias-create alias_name key_id $ kms-keys | tail -1 d714a175-db12-4574-8f27-aa071a1dfd8a $ kms-keys | tail -1 | kms-alias-create alias/foobar $ kms-aliases foobar alias/foobar d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/foobar kms-alias-delete \u00b6 Delete alias for KMS Key USAGE: kms-alias-delete alias_name [alias_name] $ kms-aliases foobar | kms-alias-delete You are about to delete the following kms aliases: alias/foobar Are you sure you want to continue? y kms-keys \u00b6 List KMS Keys $ kms-keys 5044958c-151d-4995-bed4-dd05c1385b48 8ada3e65-e377-4435-a709-fbe75dfa1dd0 d714a175-db12-4574-8f27-aa071a1dfd8a kms-key-create \u00b6 Create a KMS Key $ kms-key-create 9e94333b-8e85-497a-9791-e7c5edf9c35e kms-key-details \u00b6 List details for KMS Key(s) kms-key-disable \u00b6 Disable KMS Key(s) USAGE: kms-key-disable key_id [key_id] $ kms-key-disable 9e94333b-8e85-497a-9791-e7c5edf9c35e kms-key-enable \u00b6 Enable KMS Key(s) USAGE: kms-key-enable key_id [key_id] $ kms-key-enable 9e94333b-8e85-497a-9791-e7c5edf9c35e lambda-commands \u00b6 lambda-functions \u00b6 List lambda functions $ lambda-functions stars 2019-12-18T10:00:00.000+0000 python2.7 256 stripes 2019-12-19T10:21:42.444+0000 python3.7 128 lambda-function-memory \u00b6 List memorySize for lambda function(s) USAGE: lambda-function-memory function [function] lambda-function-memory-set \u00b6 Update memorySize for lambda function(s) USAGE: lambda-function-memory-set memory function [function] lambda-function-memory-step \u00b6 Repeatedly update memorySize for lambda function(s) Useful for measuring impact of memory on cost/performance. The function increases memorySize by 64KB every two minutes until it reaches the value requested. There is a two minute delay between increases to provide time to collect data from function execution. USAGE: lambda-function-memory-step memory function [function] log-commands \u00b6 log-groups \u00b6 List CloudWatch Log Groups $ log-groups /aws/lambda/stars2 1576495961429 0 11736 /aws/lambda/stars 1576566745961 0 107460 /aws/lambda/walk 1576567300172 0 11794 rds-commands \u00b6 rds-db-instances \u00b6 List RDS Database Instances route53-commands \u00b6 hosted-zones \u00b6 List Route53 Hosted Zones $ hosted-zones /hostedzone/Z3333333333333 5 NotPrivateZone bash-my-aws.org. /hostedzone/Z5555555555555 2 NotPrivateZone bash-my-universe.com. /hostedzone/Z4444444444444 3 NotPrivateZone bashmyaws.org. /hostedzone/Z1111111111111 3 NotPrivateZone bash-my-aws.com. /hostedzone/Z2222222222222 3 NotPrivateZone bashmyaws.com. hosted-zone-ns-records \u00b6 Generate NS records for delegating domain to AWS $ hosted-zones bash-my-aws.org /hostedzone/ZJ6ZCG2UD6OKX 5 NotPrivateZone bash-my-aws.org. $ hosted-zones bash-my-aws.org | hosted-zone-ns-records bash-my-aws.org. 300 IN NS ns-786.awsdns-34.net. bash-my-aws.org. 300 IN NS ns-1549.awsdns-01.co.uk. bash-my-aws.org. 300 IN NS ns-362.awsdns-45.com. bash-my-aws.org. 300 IN NS ns-1464.awsdns-55.org. s3-commands \u00b6 buckets \u00b6 List S3 Buckets $ buckets web-assets 2019-12-20 08:24:38.182045 backups 2019-12-20 08:24:44.351215 archive 2019-12-20 08:24:57.567652 bucket-acls \u00b6 List S3 Bucket Access Control Lists. $ bucket-acls another-example-bucket another-example-bucket Note The only recommended use case for the bucket ACL is to grant write permission to the Amazon S3 Log Delivery group to write access log objects to your bucket. AWS docs bucket-remove \u00b6 Remove an empty S3 Bucket. In this example the bucket is not empty. $ bucket-remove another-example-bucket You are about to remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y remove_bucket failed: s3://another-example-bucket An error occurred (BucketNotEmpty) when calling the DeleteBucket operation: The bucket you tried to delete is not empty bucket-remove-force \u00b6 Remove an S3 Bucket, and delete all objects if it's not empty. $ bucket-remove-force another-example-bucket You are about to delete all objects from and remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y delete: s3://another-example-bucket/aliases remove_bucket: another-example-bucket sts-commands \u00b6 sts-assume-role \u00b6 Assume an IAM Role USAGE: sts-assume-role role_arn vpc-commands \u00b6 pcxs \u00b6 List VPC Peering connections subnets \u00b6 List subnets for all VPCs $ subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME vpcs \u00b6 List VPCs $ vpcs vpc-018d9739 default-vpc NO_NAME 172.31.0.0/16 NO_STACK NO_VERSION vpc-azs \u00b6 List availability zones of VPC(s) USAGE: vpc-azs vpc-id [vpc-id] $ vpcs | vpc-azs vpc-018d9739 ap-southeast-2a ap-southeast-2b ap-southeast-2c vpc-az-count \u00b6 List number of Availability Zones of VPC(s) USAGE: vpc-az-count vpc-id [vpc-id] $ vpcs | vpc-az-count vpc-018d9739 3 vpc-lambda-functions \u00b6 List lambda functions of VPC(s) USAGE: vpc-lambda-functions vpc-id [vpc-id] vpc-dhcp-options-ntp \u00b6 List NTP servers of VPC(s) USAGE: vpc-dhcp-options-ntp vpc-id [vpc-id] vpc-endpoints \u00b6 List VPC Endpoints of VPC(s) USAGE: vpc-endpoints vpc-id [vpc-id] vpc-endpoint-services \u00b6 List available VPC endpoint services USAGE: vpc-endpoint-services vpc-id [vpc-id] vpc-igw \u00b6 List Internet Gateway of VPC(s) USAGE: vpc-igw vpc-id [vpc-id] vpc-route-tables \u00b6 List Route Tables of VPC(s) USAGE: vpc-route-tables vpc-id [vpc-id] $ vpcs | vpc-route-tables rtb-8e841c39 vpc-018d9739 NO_NAME vpc-nat-gateways \u00b6 List NAT Gateways of VPC(s) USAGE: vpc-nat-gateways vpc-id [vpc-id] vpc-subnets \u00b6 List subnets of VPC(s) USAGE: vpc-subnets vpc-id [vpc-id] $ vpcs | vpc-subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME vpc-network-acls \u00b6 List Network ACLs of VPC(s) USAGE: vpc-network-acls vpc-id [vpc-id] $ vpcs | vpc-network-acls acl-ff4914d1 vpc-018d9739 vpc-rds \u00b6 List RDS instances of VPC(s) USAGE: vpc-rds vpc-id [vpc-id] vpc-default-delete \u00b6 Print commands you would need to run to delete that pesky default VPC Exclude default VPCs that contain: - instances - lambda functions $ vpc-default-delete # Deleting default VPC vpc-018d9739 in ap-southeast-2 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-8bb774fe aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-9eea2c07 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-34fd9cfa aws --region ap-southeast-2 ec2 delete-vpc --vpc-id=vpc-018d9739","title":"Command reference test"},{"location":"command-reference-test/#aws-account-commands","text":"","title":"aws-account-commands"},{"location":"command-reference-test/#aws-account-alias","text":"Retrieve AWS Account Alias for current account $ aws-account-alias example-account-prod","title":"aws-account-alias"},{"location":"command-reference-test/#aws-account-id","text":"Retrieve AWS Account ID for current account $ aws-account-id 012345678901","title":"aws-account-id"},{"location":"command-reference-test/#aws-account-each","text":"Run a script/command across a number of AWS Accounts USAGE: aws-account-each cmd # pipe in AWS_ACCOUNT_IDS $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED # account=012345678901 alias=example-account-prod example-stack1-prod CREATED_FAILED example-stack2-prod UPDATE_ROLLBACK_FAILED # account=123456789012 alias=example-account-staging example-stack1-staging CREATED_FAILED example-stack2-staging UPDATE_ROLLBACK_FAILED Note In order to use aws-account-each , you need to be authenticated with an IAM Role that can assume a Role in each of the specified accounts. Check the source for more info.","title":"aws-account-each"},{"location":"command-reference-test/#aws-panopticon","text":"aws-panopticon was previous name for aws-account-each()","title":"aws-panopticon"},{"location":"command-reference-test/#aws-account-cost-explorer","text":"Use with an AWS Organisations Master Account to open multiple accounts in Cost Explorer. $ grep demo AWS_ACCOUNTS | aws-account-cost-explorer #=> Opens web browser to AWS Cost Explorer with accounts selected","title":"aws-account-cost-explorer"},{"location":"command-reference-test/#aws-account-cost-recommendations","text":"Use with an AWS Organisations Master Account to open multiple accounts in Cost Recommendations. $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED #=> Opens web browser to AWS Cost Recommendations with accounts selected","title":"aws-account-cost-recommendations"},{"location":"command-reference-test/#region-commands","text":"","title":"region-commands"},{"location":"command-reference-test/#regions","text":"List regions The region() function must be sourced in order to update the AWS_DEFAULT_REGION environment variable. This is because it cannot update an environment variable when run as a subprocess. $ regions ap-northeast-1 ap-northeast-2 ap-south-1 ap-southeast-1 ap-southeast-2 ... us-west-2","title":"regions"},{"location":"command-reference-test/#region","text":"Get/Set $AWS_DEFAULT_REGION shell environment variable $ region us-east-1 $ region ap-southeast-2 $ region ap-southeast-2","title":"region"},{"location":"command-reference-test/#region-each","text":"Run a command in every region. Any output lines will be appended with \"#${REGION}\". $ region-each stacks | column -t example-ec2-ap-northeast-1 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-1 example-ec2-ap-northeast-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-2 ... example-ec2-us-west-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #us-west-2","title":"region-each"},{"location":"command-reference-test/#stack-commands","text":"","title":"stack-commands"},{"location":"command-reference-test/#stacks","text":"List CloudFormation stacks. To make it fly we omit stacks with status of DELETE_COMPLETE Output is sorted by CreationTime $ stacks nagios CREATE_COMPLETE 2018-03-12T11:41:31Z NEVER_UPDATED NOT_NESTED postgres1 CREATE_COMPLETE 2019-04-14T15:22:44Z NEVER_UPDATED NOT_NESTED postgres2 CREATE_COMPLETE 2019-05-18T05:45:50Z NEVER_UPDATED NOT_NESTED prometheus-web CREATE_COMPLETE 2019-11-23T15:57:04Z NEVER_UPDATED NOT_NESTED Provide a filter string for a | grep effect with tighter columisation: $ stacks postgres postgres1 CREATE_COMPLETE 2019-04-14T15:22:44Z NEVER_UPDATED NOT_NESTED postgres2 CREATE_COMPLETE 2019-05-18T05:45:50Z NEVER_UPDATED NOT_NESTED","title":"stacks"},{"location":"command-reference-test/#stack-arn","text":"Returns ARN(s) for stacks. USAGE: stack-arn stack [stack] $ stack-arn prometheus-web arn:aws:cloudformation:us-east-1:000000000000:stack/prometheus-web/805e081c-b8eb-4f6c-9872-2b5cddc77fba Supports multiple stack names from STDIN : $ stacks | stack-arn arn:aws:cloudformation:us-east-1:000000000000:stack/nagios/c0f0ef04-b505-4c0c-87cd-ca924153ad1c arn:aws:cloudformation:us-east-1:000000000000:stack/postgres1/758b0ba2-60f2-4432-8935-f79f47708f23 arn:aws:cloudformation:us-east-1:000000000000:stack/postgres2/7420bbd4-3026-444f-b55b-fa0a9d564730 arn:aws:cloudformation:us-east-1:000000000000:stack/prometheus-web/805e081c-b8eb-4f6c-9872-2b5cddc77fba","title":"stack-arn"},{"location":"command-reference-test/#stack-cancel-update","text":"","title":"stack-cancel-update"},{"location":"command-reference-test/#stack-create","text":"","title":"stack-create"},{"location":"command-reference-test/#stack-update","text":"","title":"stack-update"},{"location":"command-reference-test/#stack-delete","text":"delete an existing stack","title":"stack-delete"},{"location":"command-reference-test/#stack-exports","text":"","title":"stack-exports"},{"location":"command-reference-test/#stack-recreate","text":"","title":"stack-recreate"},{"location":"command-reference-test/#stack-failure","text":"type: detail return the reason a stack failed to update/create/delete FIXME: only grab the latest failure","title":"stack-failure"},{"location":"command-reference-test/#stack-events","text":"List event history for a single Stack USAGE: stack-events stack","title":"stack-events"},{"location":"command-reference-test/#stack-resources","text":"List all resources in Stack(s) USAGE: stack-resources stack [stack] $ stacks | stack-resources i-7d54924538baa7a1f AWS::EC2::Instance ec2 i-c54279c6055c3c794 AWS::EC2::Instance nagios i-a8b8dd6783e1a40cc AWS::EC2::Instance postgres1 i-5d74753e210bfe04d AWS::EC2::Instance postgres2 i-2aa95cc214a461398 AWS::EC2::Instance prometheus-web","title":"stack-resources"},{"location":"command-reference-test/#stack-asgs","text":"List ASGs in Stack(s) USAGE: stack-asgs stack [stack] $ stacks | stack-asgs asg-bash-my-aws-AutoScalingGroup-MSBCWRTI3PVM AWS::AutoScaling::AutoScalingGroup asg-bash-my-aws asg2-AutoScalingGroup-1FHUVUJ7SLPU7 AWS::AutoScaling::AutoScalingGroup asg2","title":"stack-asgs"},{"location":"command-reference-test/#stack-asg-instances","text":"List EC2 Instances of EC2 Autoscaling Groups in Stack(s) USAGE: stack-asg-instances stack [stack] $ stacks | stack-asg-instances i-06ee900565652ecc5 ami-0119aa4d67e59007c t3.nano running asg-bash-my-aws 2019-12-13T03:15:22.000Z ap-southeast-2c vpc-deb8edb9 i-01c7edb986c18c16a ami-0119aa4d67e59007c t3.nano running asg2 2019-12-13T03:37:51.000Z ap-southeast-2c vpc-deb8edb9","title":"stack-asg-instances"},{"location":"command-reference-test/#stack-elbs","text":"List EC2 Elastic Load Balancers in Stack(s) USAGE: stack-elbs stack [stack] $ stacks | stack-elbs elb-MyLoadBalancer-NA5S72MLA5KI AWS::ElasticLoadBalancing::LoadBalancer elb-stack-1 load-bala-MyLoadBa-11HZ0DHUHJZZI AWS::ElasticLoadBalancing::LoadBalancer elb-stack-2","title":"stack-elbs"},{"location":"command-reference-test/#stack-instances","text":"List instances in stack(s) USAGE: stack-instances stack [stack] $ stacks | stack-instances i-7d54924538baa7a1f ami-123456789012 t3.nano stopped ec2 2019-12-11T09:31:03.000Z ap-southeast-2a None i-c54279c6055c3c794 ami-123456789012 t3.nano running nagios 2019-12-13T02:24:30.000Z ap-southeast-2a None i-a8b8dd6783e1a40cc ami-123456789012 t3.nano running postgres1 2019-12-13T02:24:32.000Z ap-southeast-2a None i-5d74753e210bfe04d ami-123456789012 t3.nano running postgres2 2019-12-13T02:24:34.000Z ap-southeast-2a None i-2aa95cc214a461398 ami-123456789012 t3.nano running prometheus-web 2019-12-13T02:24:36.000Z ap-southeast-2a None","title":"stack-instances"},{"location":"command-reference-test/#stack-parameters","text":"return the parameters applied to a stack","title":"stack-parameters"},{"location":"command-reference-test/#stack-status","text":"type: detail return the current status of a stack","title":"stack-status"},{"location":"command-reference-test/#stack-tag","text":"return a selected stack tag","title":"stack-tag"},{"location":"command-reference-test/#stack-tag-apply","text":"apply a stack tag","title":"stack-tag-apply"},{"location":"command-reference-test/#stack-tag-delete","text":"delete a stack tag","title":"stack-tag-delete"},{"location":"command-reference-test/#stack-tail","text":"type: detail follow the events occuring for a stack","title":"stack-tail"},{"location":"command-reference-test/#stack-template","text":"return the template applied to a stack","title":"stack-template"},{"location":"command-reference-test/#stack-tags","text":"return the stack-tags applied to a stack","title":"stack-tags"},{"location":"command-reference-test/#stack-tags-text","text":"return all stack tags on a single line","title":"stack-tags-text"},{"location":"command-reference-test/#stack-outputs","text":"type: detail return the outputs of a stack","title":"stack-outputs"},{"location":"command-reference-test/#stack-validate","text":"type: detail validate a stack template","title":"stack-validate"},{"location":"command-reference-test/#stack-diff","text":"type: detail return differences between a template and Stack report changes which would be made to stack if template were applied report on what changes would be made to stack by applying params If we are working from a single argument (ignore args starting with -- ) Strip path and extension from template Deduce params filename from stack and template names Strip path and extension from template File extension gets stripped off if template name provided as stack name Determine name of template to use determine name of params file to use determine what (if any) capabilities a given stack was deployed with","title":"stack-diff"},{"location":"command-reference-test/#instance-commands","text":"","title":"instance-commands"},{"location":"command-reference-test/#instances","text":"List EC2 Instances $ instances i-4e15ece1de1a3f869 ami-123456789012 t3.nano running nagios 2019-12-10T08:17:18.000Z ap-southeast-2a None i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None i-61e86ac6be1e2c193 ami-123456789012 t3.nano running prometheus-web 2019-12-10T08:17:24.000Z ap-southeast-2a None Optionally provide a filter string for a | grep effect with tighter columisation: $ instances postgres i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None","title":"instances"},{"location":"command-reference-test/#instance-asg","text":"List autoscaling group membership of EC2 Instance(s) USAGE: instance-asg instance-id [instance-id]","title":"instance-asg"},{"location":"command-reference-test/#instance-az","text":"List availability zone of EC2 Instance(s) USAGE: instance-az instance-id [instance-id] $ instances postgres | instance-az i-89cefa9403373d7a5 ap-southeast-2a i-806d8f1592e2a2efd ap-southeast-2a","title":"instance-az"},{"location":"command-reference-test/#instance-console","text":"List console output of EC2 Instance(s) USAGE: instance-console instance-id [instance-id] $ instances postgres | instance-console Console output for EC2 Instance i-89cefa9403373d7a5 Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip... Console output for EC2 Instance i-806d8f1592e2a2efd Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip...","title":"instance-console"},{"location":"command-reference-test/#instance-dns","text":"List DNS name of EC2 Instance(s) USAGE: instance-dns instance-id [instance-id] $ instances postgres | instance-dns i-89cefa9403373d7a5 ip-10-155-35-61.ap-southeast-2.compute.internal ec2-54-214-206-114.ap-southeast-2.compute.amazonaws.com i-806d8f1592e2a2efd ip-10-178-243-63.ap-southeast-2.compute.internal ec2-54-214-244-90.ap-southeast-2.compute.amazonaws.com","title":"instance-dns"},{"location":"command-reference-test/#instance-health-set-unhealthy","text":"Mark EC2 Instance(s) as unhealthy (to trigger replacement by ASG) USAGE: instance-health-set-unhealthy instance-id [instance-id]","title":"instance-health-set-unhealthy"},{"location":"command-reference-test/#instance-iam-profile","text":"List iam-profile of EC2 Instance(s) USAGE: instance-iam-profile instance-id [instance-id]","title":"instance-iam-profile"},{"location":"command-reference-test/#instance-ip","text":"List ip address of EC2 Instance(s) USAGE: instance-ip instance-id [instance-id] $ instances postgres | instance-ip i-89cefa9403373d7a5 10.155.35.61 54.214.206.114 i-806d8f1592e2a2efd 10.178.243.63 54.214.244.90","title":"instance-ip"},{"location":"command-reference-test/#instance-ssh","text":"Establish SSH connection to EC2 Instance(s) USAGE: instance-ssh [login] [instance-id] [instance-id]","title":"instance-ssh"},{"location":"command-reference-test/#instance-ssh-details","text":"List details needed to SSH into EC2 Instance(s) USAGE: instance-ssh-details [login] [instance-id] [instance-id]","title":"instance-ssh-details"},{"location":"command-reference-test/#instance-stack","text":"List CloudFormation stack EC2 Instance(s) belong to (if any) USAGE: instance-stack instance-id [instance-id] $ instances postgres | instance-stack postgres1 i-89cefa9403373d7a5 postgres2 i-806d8f1592e2a2efd","title":"instance-stack"},{"location":"command-reference-test/#instance-start","text":"Start stopped EC2 Instance(s) USAGE: instance-start instance-id [instance-id] $ instances postgres | instance-start i-a8b8dd6783e1a40cc PreviousState=stopped CurrentState=pending i-5d74753e210bfe04d PreviousState=stopped CurrentState=pending","title":"instance-start"},{"location":"command-reference-test/#instance-state","text":"List state of EC2 Instance(s) USAGE: instance-state instance-id [instance-id] $ instances postgres | instance-state i-89cefa9403373d7a5 running i-806d8f1592e2a2efd running","title":"instance-state"},{"location":"command-reference-test/#instance-stop","text":"Stop EC2 Instance(s) USAGE: instance-stop instance-id [instance-id] $ instances postgres | instance-stop i-a8b8dd6783e1a40cc PreviousState=running CurrentState=stopping i-5d74753e210bfe04d PreviousState=running CurrentState=stopping","title":"instance-stop"},{"location":"command-reference-test/#instance-tags","text":"List tags applied EC2 Instance(s) USAGE: instance-tags instance-id [instance-id]","title":"instance-tags"},{"location":"command-reference-test/#instance-terminate","text":"Terminate EC2 Instance(s) USAGE: instance-terminate instance-id [instance-id] $ instances | head -3 | instance-terminate You are about to terminate the following instances: i-01c7edb986c18c16a ami-0119aa4d67e59007c t3.nano terminated asg2 2019-12-13T03:37:51.000Z ap-southeast-2c None i-012dded46894dfa04 ami-0119aa4d67e59007c t3.nano running ec2 2019-12-13T10:12:55.000Z ap-southeast-2b vpc-deb8edb9 Are you sure you want to continue? y i-06ee900565652ecc5 PreviousState=terminated CurrentState=terminated i-01c7edb986c18c16a PreviousState=terminated CurrentState=terminated i-012dded46894dfa04 PreviousState=running CurrentState=shutting-down","title":"instance-terminate"},{"location":"command-reference-test/#instance-termination-protection","text":"List current state of Termination Protection for EC2 Instance(s) USAGE: instance-termination-protection instance-id [instance-id] $ instances | instance-termination-protection i-4e15ece1de1a3f869 DisableApiTermination=true i-89cefa9403373d7a5 DisableApiTermination=false i-806d8f1592e2a2efd DisableApiTermination=false i-61e86ac6be1e2c193 DisableApiTermination=false","title":"instance-termination-protection"},{"location":"command-reference-test/#instance-termination-protection-disable","text":"Disable EC2 Instance termination protection USAGE: instance-termination-protection-disable instance-id [instance-id]","title":"instance-termination-protection-disable"},{"location":"command-reference-test/#instance-termination-protection-enable","text":"Enable EC2 Instance termination protection USAGE: instance-termination-protection-enable instance-id [instance-id]","title":"instance-termination-protection-enable"},{"location":"command-reference-test/#instance-type","text":"List type of instance(s) USAGE: instance-type instance-id [instance-id] $ instances | instance-type i-4e15ece1de1a3f869 t3.nano i-89cefa9403373d7a5 t3.nano i-806d8f1592e2a2efd t3.nano i-61e86ac6be1e2c193 t3.nano","title":"instance-type"},{"location":"command-reference-test/#instance-userdata","text":"List userdata for instance(s) USAGE: instance-userdata instance-id [instance-id]","title":"instance-userdata"},{"location":"command-reference-test/#instance-volumes","text":"List volumes of instance(s) USAGE: instance-volumes instance-id [instance-id] $ instances postgres | instance-volumes i-89cefa9403373d7a5 vol-cf5ddae9 i-806d8f1592e2a2efd vol-38fd45c3","title":"instance-volumes"},{"location":"command-reference-test/#instance-vpc","text":"List VPC of instance(s) USAGE: instance-vpcs instance-id [instance-id]","title":"instance-vpc"},{"location":"command-reference-test/#asg-commands","text":"","title":"asg-commands"},{"location":"command-reference-test/#asgs","text":"List EC2 Autoscaling Groups","title":"asgs"},{"location":"command-reference-test/#asg-capacity","text":"List min, desired and maximum capacities of EC2 Autoscaling Group(s)","title":"asg-capacity"},{"location":"command-reference-test/#asg-desired-size-set","text":"Set desired capacity of autoscaling group(s)","title":"asg-desired-size-set"},{"location":"command-reference-test/#asg-instances","text":"List instances of autoscaling group(s)","title":"asg-instances"},{"location":"command-reference-test/#asg-launch-configuration","text":"List Launch Configurations of Autoscaling Group(s)","title":"asg-launch-configuration"},{"location":"command-reference-test/#launch-configurations","text":"List Launch Configurations","title":"launch-configurations"},{"location":"command-reference-test/#launch-configuration-asgs","text":"List EC2 Autoscaling Groups of Launch COnfiguration(s)","title":"launch-configuration-asgs"},{"location":"command-reference-test/#asg-max-size-set","text":"Set maximum size of autoscaling group(s)","title":"asg-max-size-set"},{"location":"command-reference-test/#asg-min-size-set","text":"Set minimum size of autoscaling group(s)","title":"asg-min-size-set"},{"location":"command-reference-test/#asg-processes_suspended","text":"List suspended processes of an autoscaling group","title":"asg-processes_suspended"},{"location":"command-reference-test/#asg-resume","text":"Resume all processes of an autoscaling group","title":"asg-resume"},{"location":"command-reference-test/#asg-suspend","text":"Suspend all processes of an autoscaling group","title":"asg-suspend"},{"location":"command-reference-test/#asg-stack","text":"List CloudFormation stack for asg(s)","title":"asg-stack"},{"location":"command-reference-test/#asg-scaling-activities","text":"List scaling activities for Autoscaling Group(s)","title":"asg-scaling-activities"},{"location":"command-reference-test/#cert-commands","text":"","title":"cert-commands"},{"location":"command-reference-test/#certs","text":"List ACM Certificates","title":"certs"},{"location":"command-reference-test/#certs-arn","text":"Same as certs but with the ARN in first column","title":"certs-arn"},{"location":"command-reference-test/#cert-users","text":"List resources using ACM Cert(s) USAGE: cert-users cert-arn [cert-arn]","title":"cert-users"},{"location":"command-reference-test/#cert-delete","text":"Delete ACM Cert(s) USAGE: cert-delete cert-arn [cert-arn]","title":"cert-delete"},{"location":"command-reference-test/#cloudtrail-commands","text":"","title":"cloudtrail-commands"},{"location":"command-reference-test/#cloudtrails","text":"List Cloudtrails $ cloudtrails failmode failmode-cloudtrail ap-southeast-2 IsMultiRegionTrail=true IncludeGlobalServiceEvents=true","title":"cloudtrails"},{"location":"command-reference-test/#cloudtrail-status","text":"List logging status of Cloudtrails USAGE: cloudtrail-status cloudtrail [cloudtrail]","title":"cloudtrail-status"},{"location":"command-reference-test/#ecr-commands","text":"","title":"ecr-commands"},{"location":"command-reference-test/#ecr-repositories","text":"List ECR Repositories","title":"ecr-repositories"},{"location":"command-reference-test/#ecr-repository-images","text":"List images for ECR Repositories","title":"ecr-repository-images"},{"location":"command-reference-test/#elb-commands","text":"","title":"elb-commands"},{"location":"command-reference-test/#elbs","text":"List ELBs Accepts LoadBalancer names or ARNS on STDIN and converts to LoadBalancer names $ elbs elb-MyLoadBalancer-1FNISWJN0W6N9 2019-12-13T10:24:55.220Z subnet-eff2cf88 another-e-MyLoadBa-171CPCZF2E84T 2019-12-13T10:25:24.300Z subnet-eff2cf88","title":"elbs"},{"location":"command-reference-test/#elb-dnsname","text":"List DNS Names of ELB(s) USAGE: elb-dnsname load-balancer [load-balancer] $ elbs | elb-dnsname elb-MyLoadBalancer-1FNISWJN0W6N9 elb-MyLoadBalancer-1FNISWJN0W6N9-563832045.ap-southeast-2.elb.amazonaws.com another-e-MyLoadBa-171CPCZF2E84T another-e-MyLoadBa-171CPCZF2E84T-1832721930.ap-southeast-2.elb.amazonaws.com","title":"elb-dnsname"},{"location":"command-reference-test/#elb-instances","text":"List instances of ELB(s) USAGE: elb-instances load-balancer [load-balancer]","title":"elb-instances"},{"location":"command-reference-test/#elb-stack","text":"List CloudFormation stack names of ELB(s) USAGE: elb-stack load-balancer [load-balancer] $ elbs | elb-stack elb elb-MyLoadBalancer-1FNISWJN0W6N9 another-elb another-e-MyLoadBa-171CPCZF2E84T","title":"elb-stack"},{"location":"command-reference-test/#iam-commands","text":"","title":"iam-commands"},{"location":"command-reference-test/#iam-roles","text":"List IAM Roles $ iam-roles config-role-ap-southeast-2 AROAI3QHAU3J2CDRNLQHD 2017-02-02T03:03:02Z AWSBatchServiceRole AROAJJWRGUPTRXTV52TED 2017-03-09T05:31:39Z ecsInstanceRole AROAJFQ3WMZXESGIKW5YD 2017-03-09T05:31:39Z","title":"iam-roles"},{"location":"command-reference-test/#iam-role-principal","text":"List role principal for IAM Role(s) USAGE: iam-role-principal role-name [role-name]","title":"iam-role-principal"},{"location":"command-reference-test/#image-commands","text":"","title":"image-commands"},{"location":"command-reference-test/#images","text":"List EC2 AMI's Usage: images [owner] [image-id] [image-id]... owner defaults to self or can one or more of: an AWS_ACCOUNT_ID (e.g. 1234567890) an AWS_OWNER_ALIAS (amazon, amazon-marketplace, microsoft) image_id can be one or more AMIs Trialing a different approach for grabbing resource ids from input. As normal, you can pipe resource ids in as first token on each line. We treat all args that don't start with ami- as owner identifiers. Trialing a new pattern for output - putting the Name at the end. This is more like the output of ls -la Pro: Preceding fields tend to be of the same length Pro: Easier for eyes to scan final column for names(?) Con: Using this pattern for instances() would put name past 80 char point Con: Migrating instances() to this output is A Big Change (not made lightly)","title":"images"},{"location":"command-reference-test/#image-deregister","text":"Deregister AMI(s) USAGE: image-deregister image_id [image_id]","title":"image-deregister"},{"location":"command-reference-test/#keypair-commands","text":"","title":"keypair-commands"},{"location":"command-reference-test/#keypairs","text":"List EC2 SSH Keypairs in current Region $ keypairs alice 8f:85:9a:1e:6c:76:29:34:37:45:de:7f:8d:f9:70:eb bob 56:73:29:c2:ad:7b:6f:b6:f2:f3:b4:de:e4:2b:12:d4","title":"keypairs"},{"location":"command-reference-test/#keypair-create","text":"Create SSH Keypair on local machine and import public key into new EC2 Keypair. Provides benefits over AWS creating the keypair: Amazon never has access to private key. Private key is protected with passphrase before being written to disk. Keys is written to ~/.ssh with correct file permissions. You control the SSH Key type (algorithm, length, etc). USAGE: keypair-delete key_name [key_name] $ keypair-create yet-another-keypair Creating /home/m/.ssh/yet-another-keypair Generating public/private rsa key pair. Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/m/.ssh/yet-another-keypair. Your public key has been saved in /home/m/.ssh/yet-another-keypair.pub. The key fingerprint is: SHA256:zIpbxLo7rpQvKyezOLATk96B1kSL0QP41q6x8tUrySk m@localhost.localdomain The key's randomart image is: +---[RSA 4096]----+ |..o | |.. + | | .+.o | | .oo.. o | | o+. o S | |=o.+.= . | |+++==o+ | |XoE+*+ . | |o@+**+. | +----[SHA256]-----+ { \"KeyFingerprint\": \"21:82:f9:5b:79:d6:dc:0f:7b:79:43:7c:c5:34:6c:2d\", \"KeyName\": \"yet-another-keypair\" } Note KeyPair Name defaults to \"$(aws-account-alias)-$(region)\" if none provided","title":"keypair-create"},{"location":"command-reference-test/#keypair-delete","text":"Delete EC2 SSH Keypairs by providing their names as arguments or via STDIN USAGE: keypair-delete key_name [key_name] $ keypair-delete alice bob You are about to delete the following EC2 SSH KeyPairs: alice bob Are you sure you want to continue? y $ keypairs | keypair-delete You are about to delete the following EC2 SSH KeyPairs: yet-another-keypair Are you sure you want to continue? y","title":"keypair-delete"},{"location":"command-reference-test/#kms-commands","text":"","title":"kms-commands"},{"location":"command-reference-test/#kms-encrypt","text":"Encrypt and base64 encode STDIN or file USAGE: kms-encrypt key_id/alias_id [plaintext_file] $ echo foobar | kms-encrypt alias/default AQICAHgcyN4vd3V/OB7NKI6IMbpENEu1+UfyiU...","title":"kms-encrypt"},{"location":"command-reference-test/#kms-decrypt","text":"base64 decode and decrypt KMS Encrypted file or STDIN USAGE: kms-decrypt [ciphertext_file] $ kms-decrypt ciphertext.txt foobar $ echo foobar | kms-encrypt alias/default | kms-decrypt foobar","title":"kms-decrypt"},{"location":"command-reference-test/#kms-aliases","text":"List KMS Aliases $ kms-aliases default alias/default d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/default","title":"kms-aliases"},{"location":"command-reference-test/#kms-alias-create","text":"Create alias for KMS Key USAGE: kms-alias-create alias_name key_id $ kms-keys | tail -1 d714a175-db12-4574-8f27-aa071a1dfd8a $ kms-keys | tail -1 | kms-alias-create alias/foobar $ kms-aliases foobar alias/foobar d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/foobar","title":"kms-alias-create"},{"location":"command-reference-test/#kms-alias-delete","text":"Delete alias for KMS Key USAGE: kms-alias-delete alias_name [alias_name] $ kms-aliases foobar | kms-alias-delete You are about to delete the following kms aliases: alias/foobar Are you sure you want to continue? y","title":"kms-alias-delete"},{"location":"command-reference-test/#kms-keys","text":"List KMS Keys $ kms-keys 5044958c-151d-4995-bed4-dd05c1385b48 8ada3e65-e377-4435-a709-fbe75dfa1dd0 d714a175-db12-4574-8f27-aa071a1dfd8a","title":"kms-keys"},{"location":"command-reference-test/#kms-key-create","text":"Create a KMS Key $ kms-key-create 9e94333b-8e85-497a-9791-e7c5edf9c35e","title":"kms-key-create"},{"location":"command-reference-test/#kms-key-details","text":"List details for KMS Key(s)","title":"kms-key-details"},{"location":"command-reference-test/#kms-key-disable","text":"Disable KMS Key(s) USAGE: kms-key-disable key_id [key_id] $ kms-key-disable 9e94333b-8e85-497a-9791-e7c5edf9c35e","title":"kms-key-disable"},{"location":"command-reference-test/#kms-key-enable","text":"Enable KMS Key(s) USAGE: kms-key-enable key_id [key_id] $ kms-key-enable 9e94333b-8e85-497a-9791-e7c5edf9c35e","title":"kms-key-enable"},{"location":"command-reference-test/#lambda-commands","text":"","title":"lambda-commands"},{"location":"command-reference-test/#lambda-functions","text":"List lambda functions $ lambda-functions stars 2019-12-18T10:00:00.000+0000 python2.7 256 stripes 2019-12-19T10:21:42.444+0000 python3.7 128","title":"lambda-functions"},{"location":"command-reference-test/#lambda-function-memory","text":"List memorySize for lambda function(s) USAGE: lambda-function-memory function [function]","title":"lambda-function-memory"},{"location":"command-reference-test/#lambda-function-memory-set","text":"Update memorySize for lambda function(s) USAGE: lambda-function-memory-set memory function [function]","title":"lambda-function-memory-set"},{"location":"command-reference-test/#lambda-function-memory-step","text":"Repeatedly update memorySize for lambda function(s) Useful for measuring impact of memory on cost/performance. The function increases memorySize by 64KB every two minutes until it reaches the value requested. There is a two minute delay between increases to provide time to collect data from function execution. USAGE: lambda-function-memory-step memory function [function]","title":"lambda-function-memory-step"},{"location":"command-reference-test/#log-commands","text":"","title":"log-commands"},{"location":"command-reference-test/#log-groups","text":"List CloudWatch Log Groups $ log-groups /aws/lambda/stars2 1576495961429 0 11736 /aws/lambda/stars 1576566745961 0 107460 /aws/lambda/walk 1576567300172 0 11794","title":"log-groups"},{"location":"command-reference-test/#rds-commands","text":"","title":"rds-commands"},{"location":"command-reference-test/#rds-db-instances","text":"List RDS Database Instances","title":"rds-db-instances"},{"location":"command-reference-test/#route53-commands","text":"","title":"route53-commands"},{"location":"command-reference-test/#hosted-zones","text":"List Route53 Hosted Zones $ hosted-zones /hostedzone/Z3333333333333 5 NotPrivateZone bash-my-aws.org. /hostedzone/Z5555555555555 2 NotPrivateZone bash-my-universe.com. /hostedzone/Z4444444444444 3 NotPrivateZone bashmyaws.org. /hostedzone/Z1111111111111 3 NotPrivateZone bash-my-aws.com. /hostedzone/Z2222222222222 3 NotPrivateZone bashmyaws.com.","title":"hosted-zones"},{"location":"command-reference-test/#hosted-zone-ns-records","text":"Generate NS records for delegating domain to AWS $ hosted-zones bash-my-aws.org /hostedzone/ZJ6ZCG2UD6OKX 5 NotPrivateZone bash-my-aws.org. $ hosted-zones bash-my-aws.org | hosted-zone-ns-records bash-my-aws.org. 300 IN NS ns-786.awsdns-34.net. bash-my-aws.org. 300 IN NS ns-1549.awsdns-01.co.uk. bash-my-aws.org. 300 IN NS ns-362.awsdns-45.com. bash-my-aws.org. 300 IN NS ns-1464.awsdns-55.org.","title":"hosted-zone-ns-records"},{"location":"command-reference-test/#s3-commands","text":"","title":"s3-commands"},{"location":"command-reference-test/#buckets","text":"List S3 Buckets $ buckets web-assets 2019-12-20 08:24:38.182045 backups 2019-12-20 08:24:44.351215 archive 2019-12-20 08:24:57.567652","title":"buckets"},{"location":"command-reference-test/#bucket-acls","text":"List S3 Bucket Access Control Lists. $ bucket-acls another-example-bucket another-example-bucket Note The only recommended use case for the bucket ACL is to grant write permission to the Amazon S3 Log Delivery group to write access log objects to your bucket. AWS docs","title":"bucket-acls"},{"location":"command-reference-test/#bucket-remove","text":"Remove an empty S3 Bucket. In this example the bucket is not empty. $ bucket-remove another-example-bucket You are about to remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y remove_bucket failed: s3://another-example-bucket An error occurred (BucketNotEmpty) when calling the DeleteBucket operation: The bucket you tried to delete is not empty","title":"bucket-remove"},{"location":"command-reference-test/#bucket-remove-force","text":"Remove an S3 Bucket, and delete all objects if it's not empty. $ bucket-remove-force another-example-bucket You are about to delete all objects from and remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y delete: s3://another-example-bucket/aliases remove_bucket: another-example-bucket","title":"bucket-remove-force"},{"location":"command-reference-test/#sts-commands","text":"","title":"sts-commands"},{"location":"command-reference-test/#sts-assume-role","text":"Assume an IAM Role USAGE: sts-assume-role role_arn","title":"sts-assume-role"},{"location":"command-reference-test/#vpc-commands","text":"","title":"vpc-commands"},{"location":"command-reference-test/#pcxs","text":"List VPC Peering connections","title":"pcxs"},{"location":"command-reference-test/#subnets","text":"List subnets for all VPCs $ subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME","title":"subnets"},{"location":"command-reference-test/#vpcs","text":"List VPCs $ vpcs vpc-018d9739 default-vpc NO_NAME 172.31.0.0/16 NO_STACK NO_VERSION","title":"vpcs"},{"location":"command-reference-test/#vpc-azs","text":"List availability zones of VPC(s) USAGE: vpc-azs vpc-id [vpc-id] $ vpcs | vpc-azs vpc-018d9739 ap-southeast-2a ap-southeast-2b ap-southeast-2c","title":"vpc-azs"},{"location":"command-reference-test/#vpc-az-count","text":"List number of Availability Zones of VPC(s) USAGE: vpc-az-count vpc-id [vpc-id] $ vpcs | vpc-az-count vpc-018d9739 3","title":"vpc-az-count"},{"location":"command-reference-test/#vpc-lambda-functions","text":"List lambda functions of VPC(s) USAGE: vpc-lambda-functions vpc-id [vpc-id]","title":"vpc-lambda-functions"},{"location":"command-reference-test/#vpc-dhcp-options-ntp","text":"List NTP servers of VPC(s) USAGE: vpc-dhcp-options-ntp vpc-id [vpc-id]","title":"vpc-dhcp-options-ntp"},{"location":"command-reference-test/#vpc-endpoints","text":"List VPC Endpoints of VPC(s) USAGE: vpc-endpoints vpc-id [vpc-id]","title":"vpc-endpoints"},{"location":"command-reference-test/#vpc-endpoint-services","text":"List available VPC endpoint services USAGE: vpc-endpoint-services vpc-id [vpc-id]","title":"vpc-endpoint-services"},{"location":"command-reference-test/#vpc-igw","text":"List Internet Gateway of VPC(s) USAGE: vpc-igw vpc-id [vpc-id]","title":"vpc-igw"},{"location":"command-reference-test/#vpc-route-tables","text":"List Route Tables of VPC(s) USAGE: vpc-route-tables vpc-id [vpc-id] $ vpcs | vpc-route-tables rtb-8e841c39 vpc-018d9739 NO_NAME","title":"vpc-route-tables"},{"location":"command-reference-test/#vpc-nat-gateways","text":"List NAT Gateways of VPC(s) USAGE: vpc-nat-gateways vpc-id [vpc-id]","title":"vpc-nat-gateways"},{"location":"command-reference-test/#vpc-subnets","text":"List subnets of VPC(s) USAGE: vpc-subnets vpc-id [vpc-id] $ vpcs | vpc-subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME","title":"vpc-subnets"},{"location":"command-reference-test/#vpc-network-acls","text":"List Network ACLs of VPC(s) USAGE: vpc-network-acls vpc-id [vpc-id] $ vpcs | vpc-network-acls acl-ff4914d1 vpc-018d9739","title":"vpc-network-acls"},{"location":"command-reference-test/#vpc-rds","text":"List RDS instances of VPC(s) USAGE: vpc-rds vpc-id [vpc-id]","title":"vpc-rds"},{"location":"command-reference-test/#vpc-default-delete","text":"Print commands you would need to run to delete that pesky default VPC Exclude default VPCs that contain: - instances - lambda functions $ vpc-default-delete # Deleting default VPC vpc-018d9739 in ap-southeast-2 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-8bb774fe aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-9eea2c07 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-34fd9cfa aws --region ap-southeast-2 ec2 delete-vpc --vpc-id=vpc-018d9739","title":"vpc-default-delete"},{"location":"command-reference-wip/","text":"aws-account-commands \u00b6 aws-account-alias \u00b6 Retrieve AWS Account Alias for current account $ aws-account-alias example-account-prod aws-account-id \u00b6 Retrieve AWS Account ID for current account $ aws-account-id 012345678901 aws-account-each \u00b6 Run a script/command across a number of AWS Accounts USAGE: aws-account-each cmd # pipe in AWS_ACCOUNT_IDS $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED # account=012345678901 alias=example-account-prod example-stack1-prod CREATED_FAILED example-stack2-prod UPDATE_ROLLBACK_FAILED # account=123456789012 alias=example-account-staging example-stack1-staging CREATED_FAILED example-stack2-staging UPDATE_ROLLBACK_FAILED Note In order to use aws-account-each , you need to be authenticated with an IAM Role that can assume a Role in each of the specified accounts. Check the source for more info. aws-panopticon \u00b6 aws-panopticon was previous name for aws-account-each() aws-account-cost-explorer \u00b6 Use with an AWS Organisations Master Account to open multiple accounts in Cost Explorer. $ grep demo AWS_ACCOUNTS | aws-account-cost-explorer #=> Opens web browser to AWS Cost Explorer with accounts selected aws-account-cost-recommendations \u00b6 Use with an AWS Organisations Master Account to open multiple accounts in Cost Recommendations. $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED #=> Opens web browser to AWS Cost Recommendations with accounts selected region-commands \u00b6 regions \u00b6 List regions The region() function must be sourced in order to update the AWS_DEFAULT_REGION environment variable. This is because it cannot update an environment variable when run as a subprocess. $ regions ap-northeast-1 ap-northeast-2 ap-south-1 ap-southeast-1 ap-southeast-2 ... us-west-2 region \u00b6 Get/Set $AWS_DEFAULT_REGION shell environment variable $ region us-east-1 $ region ap-southeast-2 $ region ap-southeast-2 region-each \u00b6 Run a command in every region. Any output lines will be appended with \"#${REGION}\". $ region-each stacks | column -t example-ec2-ap-northeast-1 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-1 example-ec2-ap-northeast-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-2 ... example-ec2-us-west-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #us-west-2 stack-commands \u00b6 stacks \u00b6 stack-arn \u00b6 stack-cancel-update \u00b6 stack-create \u00b6 stack-update \u00b6 stack-delete \u00b6 delete an existing stack stack-exports \u00b6 stack-recreate \u00b6 rm -fr $tmpdir stack-failure \u00b6 type: detail return the reason a stack failed to update/create/delete FIXME: only grab the latest failure stack-events \u00b6 type: detail return the events a stack has experienced stack-resources \u00b6 stack-asgs \u00b6 type: detail return the autoscaling groups managed by a stack stack-asg-instances \u00b6 stack-elbs \u00b6 return the elastic load balancers managed by stack(s) stack-instances \u00b6 return the instances managed by stack(s) stack-parameters \u00b6 return the parameters applied to a stack stack-status \u00b6 type: detail return the current status of a stack stack-tag \u00b6 return a selected stack tag stack-tag-apply \u00b6 apply a stack tag stack-tag-delete \u00b6 delete a stack tag stack-tail \u00b6 type: detail follow the events occuring for a stack stack-template \u00b6 return the template applied to a stack stack-tags \u00b6 return the stack-tags applied to a stack stack-tags-text \u00b6 return all stack tags on a single line stack-outputs \u00b6 type: detail return the outputs of a stack stack-validate \u00b6 type: detail validate a stack template stack-diff \u00b6 type: detail return differences between a template and Stack report changes which would be made to stack if template were applied report on what changes would be made to stack by applying params If we are working from a single argument (ignore args starting with -- ) Strip path and extension from template Deduce params filename from stack and template names Strip path and extension from template File extension gets stripped off if template name provided as stack name Determine name of template to use determine name of params file to use determine what (if any) capabilities a given stack was deployed with instance-commands \u00b6 instances \u00b6 List EC2 Instances $ instances i-4e15ece1de1a3f869 ami-123456789012 t3.nano running nagios 2019-12-10T08:17:18.000Z ap-southeast-2a None i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None i-61e86ac6be1e2c193 ami-123456789012 t3.nano running prometheus-web 2019-12-10T08:17:24.000Z ap-southeast-2a None Optionally provide a filter string for a | grep effect with tighter columisation: $ instances postgres i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None instance-asg \u00b6 List autoscaling group membership of EC2 Instance(s) USAGE: instance-asg instance-id [instance-id] instance-az \u00b6 List availability zone of EC2 Instance(s) USAGE: instance-az instance-id [instance-id] $ instances postgres | instance-az i-89cefa9403373d7a5 ap-southeast-2a i-806d8f1592e2a2efd ap-southeast-2a instance-console \u00b6 List console output of EC2 Instance(s) USAGE: instance-console instance-id [instance-id] $ instances postgres | instance-console Console output for EC2 Instance i-89cefa9403373d7a5 Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip... Console output for EC2 Instance i-806d8f1592e2a2efd Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip... instance-dns \u00b6 List DNS name of EC2 Instance(s) USAGE: instance-dns instance-id [instance-id] $ instances postgres | instance-dns i-89cefa9403373d7a5 ip-10-155-35-61.ap-southeast-2.compute.internal ec2-54-214-206-114.ap-southeast-2.compute.amazonaws.com i-806d8f1592e2a2efd ip-10-178-243-63.ap-southeast-2.compute.internal ec2-54-214-244-90.ap-southeast-2.compute.amazonaws.com instance-health-set-unhealthy \u00b6 Mark EC2 Instance(s) as unhealthy (to trigger replacement by ASG) USAGE: instance-health-set-unhealthy instance-id [instance-id] instance-iam-profile \u00b6 List iam-profile of EC2 Instance(s) USAGE: instance-iam-profile instance-id [instance-id] instance-ip \u00b6 List ip address of EC2 Instance(s) USAGE: instance-ip instance-id [instance-id] $ instances postgres | instance-ip i-89cefa9403373d7a5 10.155.35.61 54.214.206.114 i-806d8f1592e2a2efd 10.178.243.63 54.214.244.90 instance-ssh \u00b6 Establish SSH connection to EC2 Instance(s) USAGE: instance-ssh [login] [instance-id] [instance-id] instance-ssh-details \u00b6 List details needed to SSH into EC2 Instance(s) USAGE: instance-ssh-details [login] [instance-id] [instance-id] instance-stack \u00b6 List CloudFormation stack EC2 Instance(s) belong to (if any) USAGE: instance-stack instance-id [instance-id] $ instances postgres | instance-stack postgres1 i-89cefa9403373d7a5 postgres2 i-806d8f1592e2a2efd instance-start \u00b6 Start stopped EC2 Instance(s) USAGE: instance-start instance-id [instance-id] $ instances postgres | instance-start i-a8b8dd6783e1a40cc PreviousState=stopped CurrentState=pending i-5d74753e210bfe04d PreviousState=stopped CurrentState=pending instance-state \u00b6 List state of EC2 Instance(s) USAGE: instance-state instance-id [instance-id] $ instances postgres | instance-state i-89cefa9403373d7a5 running i-806d8f1592e2a2efd running instance-stop \u00b6 Stop EC2 Instance(s) USAGE: instance-stop instance-id [instance-id] $ instances postgres | instance-stop i-a8b8dd6783e1a40cc PreviousState=running CurrentState=stopping i-5d74753e210bfe04d PreviousState=running CurrentState=stopping instance-tags \u00b6 List tags applied EC2 Instance(s) USAGE: instance-tags instance-id [instance-id] instance-terminate \u00b6 Terminate EC2 Instance(s) USAGE: instance-terminate instance-id [instance-id] $ instances | head -3 | instance-terminate You are about to terminate the following instances: i-01c7edb986c18c16a ami-0119aa4d67e59007c t3.nano terminated asg2 2019-12-13T03:37:51.000Z ap-southeast-2c None i-012dded46894dfa04 ami-0119aa4d67e59007c t3.nano running ec2 2019-12-13T10:12:55.000Z ap-southeast-2b vpc-deb8edb9 Are you sure you want to continue? y i-06ee900565652ecc5 PreviousState=terminated CurrentState=terminated i-01c7edb986c18c16a PreviousState=terminated CurrentState=terminated i-012dded46894dfa04 PreviousState=running CurrentState=shutting-down instance-termination-protection \u00b6 List current state of Termination Protection for EC2 Instance(s) USAGE: instance-termination-protection instance-id [instance-id] $ instances | instance-termination-protection i-4e15ece1de1a3f869 DisableApiTermination=true i-89cefa9403373d7a5 DisableApiTermination=false i-806d8f1592e2a2efd DisableApiTermination=false i-61e86ac6be1e2c193 DisableApiTermination=false instance-termination-protection-disable \u00b6 Disable EC2 Instance termination protection USAGE: instance-termination-protection-disable instance-id [instance-id] instance-termination-protection-enable \u00b6 Enable EC2 Instance termination protection USAGE: instance-termination-protection-enable instance-id [instance-id] instance-type \u00b6 List type of instance(s) USAGE: instance-type instance-id [instance-id] $ instances | instance-type i-4e15ece1de1a3f869 t3.nano i-89cefa9403373d7a5 t3.nano i-806d8f1592e2a2efd t3.nano i-61e86ac6be1e2c193 t3.nano instance-userdata \u00b6 List userdata for instance(s) USAGE: instance-userdata instance-id [instance-id] instance-volumes \u00b6 List volumes of instance(s) USAGE: instance-volumes instance-id [instance-id] $ instances postgres | instance-volumes i-89cefa9403373d7a5 vol-cf5ddae9 i-806d8f1592e2a2efd vol-38fd45c3 instance-vpc \u00b6 List VPC of instance(s) USAGE: instance-vpcs instance-id [instance-id] asg-commands \u00b6 asgs \u00b6 List EC2 Autoscaling Groups asg-capacity \u00b6 List min, desired and maximum capacities of EC2 Autoscaling Group(s) asg-desired-size-set \u00b6 Set desired capacity of autoscaling group(s) asg-instances \u00b6 List instances of autoscaling group(s) asg-launch-configuration \u00b6 List Launch Configurations of Autoscaling Group(s) launch-configurations \u00b6 List Launch Configurations launch-configuration-asgs \u00b6 List EC2 Autoscaling Groups of Launch COnfiguration(s) asg-max-size-set \u00b6 Set maximum size of autoscaling group(s) asg-min-size-set \u00b6 Set minimum size of autoscaling group(s) asg-processes_suspended \u00b6 List suspended processes of an autoscaling group asg-resume \u00b6 Resume all processes of an autoscaling group asg-suspend \u00b6 Suspend all processes of an autoscaling group asg-stack \u00b6 List CloudFormation stack for asg(s) asg-scaling-activities \u00b6 List scaling activities for Autoscaling Group(s) cert-commands \u00b6 certs \u00b6 List ACM Certificates certs-arn \u00b6 Same as certs but with the ARN in first column cert-users \u00b6 List resources using ACM Cert(s) USAGE: cert-users cert-arn [cert-arn] cert-delete \u00b6 Delete ACM Cert(s) USAGE: cert-delete cert-arn [cert-arn] cloudtrail-commands \u00b6 cloudtrails \u00b6 List Cloudtrails $ cloudtrails failmode failmode-cloudtrail ap-southeast-2 IsMultiRegionTrail=true IncludeGlobalServiceEvents=true cloudtrail-status \u00b6 List logging status of Cloudtrails USAGE: cloudtrail-status cloudtrail [cloudtrail] ecr-commands \u00b6 ecr-repositories \u00b6 List ECR Repositories ecr-repository-images \u00b6 List images for ECR Repositories elb-commands \u00b6 elbs \u00b6 List ELBs Accepts LoadBalancer names or ARNS on STDIN and converts to LoadBalancer names $ elbs elb-MyLoadBalancer-1FNISWJN0W6N9 2019-12-13T10:24:55.220Z subnet-eff2cf88 another-e-MyLoadBa-171CPCZF2E84T 2019-12-13T10:25:24.300Z subnet-eff2cf88 elb-dnsname \u00b6 List DNS Names of ELB(s) USAGE: elb-dnsname load-balancer [load-balancer] $ elbs | elb-dnsname elb-MyLoadBalancer-1FNISWJN0W6N9 elb-MyLoadBalancer-1FNISWJN0W6N9-563832045.ap-southeast-2.elb.amazonaws.com another-e-MyLoadBa-171CPCZF2E84T another-e-MyLoadBa-171CPCZF2E84T-1832721930.ap-southeast-2.elb.amazonaws.com elb-instances \u00b6 List instances of ELB(s) USAGE: elb-instances load-balancer [load-balancer] elb-stack \u00b6 List CloudFormation stack names of ELB(s) USAGE: elb-stack load-balancer [load-balancer] $ elbs | elb-stack elb elb-MyLoadBalancer-1FNISWJN0W6N9 another-elb another-e-MyLoadBa-171CPCZF2E84T iam-commands \u00b6 iam-roles \u00b6 List IAM Roles $ iam-roles config-role-ap-southeast-2 AROAI3QHAU3J2CDRNLQHD 2017-02-02T03:03:02Z AWSBatchServiceRole AROAJJWRGUPTRXTV52TED 2017-03-09T05:31:39Z ecsInstanceRole AROAJFQ3WMZXESGIKW5YD 2017-03-09T05:31:39Z iam-role-principal \u00b6 List role principal for IAM Role(s) USAGE: iam-role-principal role-name [role-name] image-commands \u00b6 images \u00b6 List EC2 AMI's Usage: images [owner] [image-id] [image-id]... owner defaults to self or can one or more of: an AWS_ACCOUNT_ID (e.g. 1234567890) an AWS_OWNER_ALIAS (amazon, amazon-marketplace, microsoft) image_id can be one or more AMIs Trialing a different approach for grabbing resource ids from input. As normal, you can pipe resource ids in as first token on each line. We treat all args that don't start with ami- as owner identifiers. Trialing a new pattern for output - putting the Name at the end. This is more like the output of ls -la Pro: Preceding fields tend to be of the same length Pro: Easier for eyes to scan final column for names(?) Con: Using this pattern for instances() would put name past 80 char point Con: Migrating instances() to this output is A Big Change (not made lightly) image-deregister \u00b6 Deregister AMI(s) USAGE: image-deregister image_id [image_id] keypair-commands \u00b6 keypairs \u00b6 List EC2 SSH Keypairs in current Region $ keypairs alice 8f:85:9a:1e:6c:76:29:34:37:45:de:7f:8d:f9:70:eb bob 56:73:29:c2:ad:7b:6f:b6:f2:f3:b4:de:e4:2b:12:d4 keypair-create \u00b6 Create SSH Keypair on local machine and import public key into new EC2 Keypair. Provides benefits over AWS creating the keypair: Amazon never has access to private key. Private key is protected with passphrase before being written to disk. Keys is written to ~/.ssh with correct file permissions. You control the SSH Key type (algorithm, length, etc). USAGE: keypair-delete key_name [key_name] $ keypair-create yet-another-keypair Creating /home/m/.ssh/yet-another-keypair Generating public/private rsa key pair. Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/m/.ssh/yet-another-keypair. Your public key has been saved in /home/m/.ssh/yet-another-keypair.pub. The key fingerprint is: SHA256:zIpbxLo7rpQvKyezOLATk96B1kSL0QP41q6x8tUrySk m@localhost.localdomain The key's randomart image is: +---[RSA 4096]----+ |..o | |.. + | | .+.o | | .oo.. o | | o+. o S | |=o.+.= . | |+++==o+ | |XoE+*+ . | |o@+**+. | +----[SHA256]-----+ { \"KeyFingerprint\": \"21:82:f9:5b:79:d6:dc:0f:7b:79:43:7c:c5:34:6c:2d\", \"KeyName\": \"yet-another-keypair\" } Note KeyPair Name defaults to \"$(aws-account-alias)-$(region)\" if none provided keypair-delete \u00b6 Delete EC2 SSH Keypairs by providing their names as arguments or via STDIN USAGE: keypair-delete key_name [key_name] $ keypair-delete alice bob You are about to delete the following EC2 SSH KeyPairs: alice bob Are you sure you want to continue? y $ keypairs | keypair-delete You are about to delete the following EC2 SSH KeyPairs: yet-another-keypair Are you sure you want to continue? y kms-commands \u00b6 kms-encrypt \u00b6 Encrypt and base64 encode STDIN or file USAGE: kms-encrypt key_id/alias_id [plaintext_file] $ echo foobar | kms-encrypt alias/default AQICAHgcyN4vd3V/OB7NKI6IMbpENEu1+UfyiU... kms-decrypt \u00b6 base64 decode and decrypt KMS Encrypted file or STDIN USAGE: kms-decrypt [ciphertext_file] $ kms-decrypt ciphertext.txt foobar $ echo foobar | kms-encrypt alias/default | kms-decrypt foobar kms-aliases \u00b6 List KMS Aliases $ kms-aliases default alias/default d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/default kms-alias-create \u00b6 Create alias for KMS Key USAGE: kms-alias-create alias_name key_id $ kms-keys | tail -1 d714a175-db12-4574-8f27-aa071a1dfd8a $ kms-keys | tail -1 | kms-alias-create alias/foobar $ kms-aliases foobar alias/foobar d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/foobar kms-alias-delete \u00b6 Delete alias for KMS Key USAGE: kms-alias-delete alias_name [alias_name] $ kms-aliases foobar | kms-alias-delete You are about to delete the following kms aliases: alias/foobar Are you sure you want to continue? y kms-keys \u00b6 List KMS Keys $ kms-keys 5044958c-151d-4995-bed4-dd05c1385b48 8ada3e65-e377-4435-a709-fbe75dfa1dd0 d714a175-db12-4574-8f27-aa071a1dfd8a kms-key-create \u00b6 Create a KMS Key $ kms-key-create 9e94333b-8e85-497a-9791-e7c5edf9c35e kms-key-details \u00b6 List details for KMS Key(s) kms-key-disable \u00b6 Disable KMS Key(s) USAGE: kms-key-disable key_id [key_id] $ kms-key-disable 9e94333b-8e85-497a-9791-e7c5edf9c35e kms-key-enable \u00b6 Enable KMS Key(s) USAGE: kms-key-enable key_id [key_id] $ kms-key-enable 9e94333b-8e85-497a-9791-e7c5edf9c35e lambda-commands \u00b6 lambda-functions \u00b6 List lambda functions $ lambda-functions stars 2019-12-18T10:00:00.000+0000 python2.7 256 stripes 2019-12-19T10:21:42.444+0000 python3.7 128 lambda-function-memory \u00b6 List memorySize for lambda function(s) USAGE: lambda-function-memory function [function] lambda-function-memory-set \u00b6 Update memorySize for lambda function(s) USAGE: lambda-function-memory-set memory function [function] lambda-function-memory-step \u00b6 Repeatedly update memorySize for lambda function(s) Useful for measuring impact of memory on cost/performance. The function increases memorySize by 64KB every two minutes until it reaches the value requested. There is a two minute delay between increases to provide time to collect data from function execution. USAGE: lambda-function-memory-step memory function [function] log-commands \u00b6 log-groups \u00b6 List CloudWatch Log Groups $ log-groups /aws/lambda/stars2 1576495961429 0 11736 /aws/lambda/stars 1576566745961 0 107460 /aws/lambda/walk 1576567300172 0 11794 rds-commands \u00b6 rds-db-instances \u00b6 List RDS Database Instances route53-commands \u00b6 hosted-zones \u00b6 List Route53 Hosted Zones $ hosted-zones /hostedzone/Z3333333333333 5 NotPrivateZone bash-my-aws.org. /hostedzone/Z5555555555555 2 NotPrivateZone bash-my-universe.com. /hostedzone/Z4444444444444 3 NotPrivateZone bashmyaws.org. /hostedzone/Z1111111111111 3 NotPrivateZone bash-my-aws.com. /hostedzone/Z2222222222222 3 NotPrivateZone bashmyaws.com. hosted-zone-ns-records \u00b6 Generate NS records for delegating domain to AWS $ hosted-zones bash-my-aws.org /hostedzone/ZJ6ZCG2UD6OKX 5 NotPrivateZone bash-my-aws.org. $ hosted-zones bash-my-aws.org | hosted-zone-ns-records bash-my-aws.org. 300 IN NS ns-786.awsdns-34.net. bash-my-aws.org. 300 IN NS ns-1549.awsdns-01.co.uk. bash-my-aws.org. 300 IN NS ns-362.awsdns-45.com. bash-my-aws.org. 300 IN NS ns-1464.awsdns-55.org. s3-commands \u00b6 buckets \u00b6 List S3 Buckets $ buckets web-assets 2019-12-20 08:24:38.182045 backups 2019-12-20 08:24:44.351215 archive 2019-12-20 08:24:57.567652 bucket-acls \u00b6 List S3 Bucket Access Control Lists. $ bucket-acls another-example-bucket another-example-bucket Note The only recommended use case for the bucket ACL is to grant write permission to the Amazon S3 Log Delivery group to write access log objects to your bucket. AWS docs bucket-remove \u00b6 Remove an empty S3 Bucket. In this example the bucket is not empty. $ bucket-remove another-example-bucket You are about to remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y remove_bucket failed: s3://another-example-bucket An error occurred (BucketNotEmpty) when calling the DeleteBucket operation: The bucket you tried to delete is not empty bucket-remove-force \u00b6 Remove an S3 Bucket, and delete all objects if it's not empty. $ bucket-remove-force another-example-bucket You are about to delete all objects from and remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y delete: s3://another-example-bucket/aliases remove_bucket: another-example-bucket sts-commands \u00b6 sts-assume-role \u00b6 Assume an IAM Role USAGE: sts-assume-role role_arn vpc-commands \u00b6 pcxs \u00b6 List VPC Peering connections subnets \u00b6 List subnets for all VPCs $ subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME vpcs \u00b6 List VPCs $ vpcs vpc-018d9739 default-vpc NO_NAME 172.31.0.0/16 NO_STACK NO_VERSION vpc-azs \u00b6 List availability zones of VPC(s) USAGE: vpc-azs vpc-id [vpc-id] $ vpcs | vpc-azs vpc-018d9739 ap-southeast-2a ap-southeast-2b ap-southeast-2c vpc-az-count \u00b6 List number of Availability Zones of VPC(s) USAGE: vpc-az-count vpc-id [vpc-id] $ vpcs | vpc-az-count vpc-018d9739 3 vpc-lambda-functions \u00b6 List lambda functions of VPC(s) USAGE: vpc-lambda-functions vpc-id [vpc-id] vpc-dhcp-options-ntp \u00b6 List NTP servers of VPC(s) USAGE: vpc-dhcp-options-ntp vpc-id [vpc-id] vpc-endpoints \u00b6 List VPC Endpoints of VPC(s) USAGE: vpc-endpoints vpc-id [vpc-id] vpc-endpoint-services \u00b6 List available VPC endpoint services USAGE: vpc-endpoint-services vpc-id [vpc-id] vpc-igw \u00b6 List Internet Gateway of VPC(s) USAGE: vpc-igw vpc-id [vpc-id] vpc-route-tables \u00b6 List Route Tables of VPC(s) USAGE: vpc-route-tables vpc-id [vpc-id] $ vpcs | vpc-route-tables rtb-8e841c39 vpc-018d9739 NO_NAME vpc-nat-gateways \u00b6 List NAT Gateways of VPC(s) USAGE: vpc-nat-gateways vpc-id [vpc-id] vpc-subnets \u00b6 List subnets of VPC(s) USAGE: vpc-subnets vpc-id [vpc-id] $ vpcs | vpc-subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME vpc-network-acls \u00b6 List Network ACLs of VPC(s) USAGE: vpc-network-acls vpc-id [vpc-id] $ vpcs | vpc-network-acls acl-ff4914d1 vpc-018d9739 vpc-rds \u00b6 List RDS instances of VPC(s) USAGE: vpc-rds vpc-id [vpc-id] vpc-default-delete \u00b6 Print commands you would need to run to delete that pesky default VPC Exclude default VPCs that contain: - instances - lambda functions $ vpc-default-delete # Deleting default VPC vpc-018d9739 in ap-southeast-2 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-8bb774fe aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-9eea2c07 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-34fd9cfa aws --region ap-southeast-2 ec2 delete-vpc --vpc-id=vpc-018d9739","title":"Command reference wip"},{"location":"command-reference-wip/#aws-account-commands","text":"","title":"aws-account-commands"},{"location":"command-reference-wip/#aws-account-alias","text":"Retrieve AWS Account Alias for current account $ aws-account-alias example-account-prod","title":"aws-account-alias"},{"location":"command-reference-wip/#aws-account-id","text":"Retrieve AWS Account ID for current account $ aws-account-id 012345678901","title":"aws-account-id"},{"location":"command-reference-wip/#aws-account-each","text":"Run a script/command across a number of AWS Accounts USAGE: aws-account-each cmd # pipe in AWS_ACCOUNT_IDS $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED # account=012345678901 alias=example-account-prod example-stack1-prod CREATED_FAILED example-stack2-prod UPDATE_ROLLBACK_FAILED # account=123456789012 alias=example-account-staging example-stack1-staging CREATED_FAILED example-stack2-staging UPDATE_ROLLBACK_FAILED Note In order to use aws-account-each , you need to be authenticated with an IAM Role that can assume a Role in each of the specified accounts. Check the source for more info.","title":"aws-account-each"},{"location":"command-reference-wip/#aws-panopticon","text":"aws-panopticon was previous name for aws-account-each()","title":"aws-panopticon"},{"location":"command-reference-wip/#aws-account-cost-explorer","text":"Use with an AWS Organisations Master Account to open multiple accounts in Cost Explorer. $ grep demo AWS_ACCOUNTS | aws-account-cost-explorer #=> Opens web browser to AWS Cost Explorer with accounts selected","title":"aws-account-cost-explorer"},{"location":"command-reference-wip/#aws-account-cost-recommendations","text":"Use with an AWS Organisations Master Account to open multiple accounts in Cost Recommendations. $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED #=> Opens web browser to AWS Cost Recommendations with accounts selected","title":"aws-account-cost-recommendations"},{"location":"command-reference-wip/#region-commands","text":"","title":"region-commands"},{"location":"command-reference-wip/#regions","text":"List regions The region() function must be sourced in order to update the AWS_DEFAULT_REGION environment variable. This is because it cannot update an environment variable when run as a subprocess. $ regions ap-northeast-1 ap-northeast-2 ap-south-1 ap-southeast-1 ap-southeast-2 ... us-west-2","title":"regions"},{"location":"command-reference-wip/#region","text":"Get/Set $AWS_DEFAULT_REGION shell environment variable $ region us-east-1 $ region ap-southeast-2 $ region ap-southeast-2","title":"region"},{"location":"command-reference-wip/#region-each","text":"Run a command in every region. Any output lines will be appended with \"#${REGION}\". $ region-each stacks | column -t example-ec2-ap-northeast-1 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-1 example-ec2-ap-northeast-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-2 ... example-ec2-us-west-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #us-west-2","title":"region-each"},{"location":"command-reference-wip/#stack-commands","text":"","title":"stack-commands"},{"location":"command-reference-wip/#stacks","text":"","title":"stacks"},{"location":"command-reference-wip/#stack-arn","text":"","title":"stack-arn"},{"location":"command-reference-wip/#stack-cancel-update","text":"","title":"stack-cancel-update"},{"location":"command-reference-wip/#stack-create","text":"","title":"stack-create"},{"location":"command-reference-wip/#stack-update","text":"","title":"stack-update"},{"location":"command-reference-wip/#stack-delete","text":"delete an existing stack","title":"stack-delete"},{"location":"command-reference-wip/#stack-exports","text":"","title":"stack-exports"},{"location":"command-reference-wip/#stack-recreate","text":"rm -fr $tmpdir","title":"stack-recreate"},{"location":"command-reference-wip/#stack-failure","text":"type: detail return the reason a stack failed to update/create/delete FIXME: only grab the latest failure","title":"stack-failure"},{"location":"command-reference-wip/#stack-events","text":"type: detail return the events a stack has experienced","title":"stack-events"},{"location":"command-reference-wip/#stack-resources","text":"","title":"stack-resources"},{"location":"command-reference-wip/#stack-asgs","text":"type: detail return the autoscaling groups managed by a stack","title":"stack-asgs"},{"location":"command-reference-wip/#stack-asg-instances","text":"","title":"stack-asg-instances"},{"location":"command-reference-wip/#stack-elbs","text":"return the elastic load balancers managed by stack(s)","title":"stack-elbs"},{"location":"command-reference-wip/#stack-instances","text":"return the instances managed by stack(s)","title":"stack-instances"},{"location":"command-reference-wip/#stack-parameters","text":"return the parameters applied to a stack","title":"stack-parameters"},{"location":"command-reference-wip/#stack-status","text":"type: detail return the current status of a stack","title":"stack-status"},{"location":"command-reference-wip/#stack-tag","text":"return a selected stack tag","title":"stack-tag"},{"location":"command-reference-wip/#stack-tag-apply","text":"apply a stack tag","title":"stack-tag-apply"},{"location":"command-reference-wip/#stack-tag-delete","text":"delete a stack tag","title":"stack-tag-delete"},{"location":"command-reference-wip/#stack-tail","text":"type: detail follow the events occuring for a stack","title":"stack-tail"},{"location":"command-reference-wip/#stack-template","text":"return the template applied to a stack","title":"stack-template"},{"location":"command-reference-wip/#stack-tags","text":"return the stack-tags applied to a stack","title":"stack-tags"},{"location":"command-reference-wip/#stack-tags-text","text":"return all stack tags on a single line","title":"stack-tags-text"},{"location":"command-reference-wip/#stack-outputs","text":"type: detail return the outputs of a stack","title":"stack-outputs"},{"location":"command-reference-wip/#stack-validate","text":"type: detail validate a stack template","title":"stack-validate"},{"location":"command-reference-wip/#stack-diff","text":"type: detail return differences between a template and Stack report changes which would be made to stack if template were applied report on what changes would be made to stack by applying params If we are working from a single argument (ignore args starting with -- ) Strip path and extension from template Deduce params filename from stack and template names Strip path and extension from template File extension gets stripped off if template name provided as stack name Determine name of template to use determine name of params file to use determine what (if any) capabilities a given stack was deployed with","title":"stack-diff"},{"location":"command-reference-wip/#instance-commands","text":"","title":"instance-commands"},{"location":"command-reference-wip/#instances","text":"List EC2 Instances $ instances i-4e15ece1de1a3f869 ami-123456789012 t3.nano running nagios 2019-12-10T08:17:18.000Z ap-southeast-2a None i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None i-61e86ac6be1e2c193 ami-123456789012 t3.nano running prometheus-web 2019-12-10T08:17:24.000Z ap-southeast-2a None Optionally provide a filter string for a | grep effect with tighter columisation: $ instances postgres i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None","title":"instances"},{"location":"command-reference-wip/#instance-asg","text":"List autoscaling group membership of EC2 Instance(s) USAGE: instance-asg instance-id [instance-id]","title":"instance-asg"},{"location":"command-reference-wip/#instance-az","text":"List availability zone of EC2 Instance(s) USAGE: instance-az instance-id [instance-id] $ instances postgres | instance-az i-89cefa9403373d7a5 ap-southeast-2a i-806d8f1592e2a2efd ap-southeast-2a","title":"instance-az"},{"location":"command-reference-wip/#instance-console","text":"List console output of EC2 Instance(s) USAGE: instance-console instance-id [instance-id] $ instances postgres | instance-console Console output for EC2 Instance i-89cefa9403373d7a5 Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip... Console output for EC2 Instance i-806d8f1592e2a2efd Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip...","title":"instance-console"},{"location":"command-reference-wip/#instance-dns","text":"List DNS name of EC2 Instance(s) USAGE: instance-dns instance-id [instance-id] $ instances postgres | instance-dns i-89cefa9403373d7a5 ip-10-155-35-61.ap-southeast-2.compute.internal ec2-54-214-206-114.ap-southeast-2.compute.amazonaws.com i-806d8f1592e2a2efd ip-10-178-243-63.ap-southeast-2.compute.internal ec2-54-214-244-90.ap-southeast-2.compute.amazonaws.com","title":"instance-dns"},{"location":"command-reference-wip/#instance-health-set-unhealthy","text":"Mark EC2 Instance(s) as unhealthy (to trigger replacement by ASG) USAGE: instance-health-set-unhealthy instance-id [instance-id]","title":"instance-health-set-unhealthy"},{"location":"command-reference-wip/#instance-iam-profile","text":"List iam-profile of EC2 Instance(s) USAGE: instance-iam-profile instance-id [instance-id]","title":"instance-iam-profile"},{"location":"command-reference-wip/#instance-ip","text":"List ip address of EC2 Instance(s) USAGE: instance-ip instance-id [instance-id] $ instances postgres | instance-ip i-89cefa9403373d7a5 10.155.35.61 54.214.206.114 i-806d8f1592e2a2efd 10.178.243.63 54.214.244.90","title":"instance-ip"},{"location":"command-reference-wip/#instance-ssh","text":"Establish SSH connection to EC2 Instance(s) USAGE: instance-ssh [login] [instance-id] [instance-id]","title":"instance-ssh"},{"location":"command-reference-wip/#instance-ssh-details","text":"List details needed to SSH into EC2 Instance(s) USAGE: instance-ssh-details [login] [instance-id] [instance-id]","title":"instance-ssh-details"},{"location":"command-reference-wip/#instance-stack","text":"List CloudFormation stack EC2 Instance(s) belong to (if any) USAGE: instance-stack instance-id [instance-id] $ instances postgres | instance-stack postgres1 i-89cefa9403373d7a5 postgres2 i-806d8f1592e2a2efd","title":"instance-stack"},{"location":"command-reference-wip/#instance-start","text":"Start stopped EC2 Instance(s) USAGE: instance-start instance-id [instance-id] $ instances postgres | instance-start i-a8b8dd6783e1a40cc PreviousState=stopped CurrentState=pending i-5d74753e210bfe04d PreviousState=stopped CurrentState=pending","title":"instance-start"},{"location":"command-reference-wip/#instance-state","text":"List state of EC2 Instance(s) USAGE: instance-state instance-id [instance-id] $ instances postgres | instance-state i-89cefa9403373d7a5 running i-806d8f1592e2a2efd running","title":"instance-state"},{"location":"command-reference-wip/#instance-stop","text":"Stop EC2 Instance(s) USAGE: instance-stop instance-id [instance-id] $ instances postgres | instance-stop i-a8b8dd6783e1a40cc PreviousState=running CurrentState=stopping i-5d74753e210bfe04d PreviousState=running CurrentState=stopping","title":"instance-stop"},{"location":"command-reference-wip/#instance-tags","text":"List tags applied EC2 Instance(s) USAGE: instance-tags instance-id [instance-id]","title":"instance-tags"},{"location":"command-reference-wip/#instance-terminate","text":"Terminate EC2 Instance(s) USAGE: instance-terminate instance-id [instance-id] $ instances | head -3 | instance-terminate You are about to terminate the following instances: i-01c7edb986c18c16a ami-0119aa4d67e59007c t3.nano terminated asg2 2019-12-13T03:37:51.000Z ap-southeast-2c None i-012dded46894dfa04 ami-0119aa4d67e59007c t3.nano running ec2 2019-12-13T10:12:55.000Z ap-southeast-2b vpc-deb8edb9 Are you sure you want to continue? y i-06ee900565652ecc5 PreviousState=terminated CurrentState=terminated i-01c7edb986c18c16a PreviousState=terminated CurrentState=terminated i-012dded46894dfa04 PreviousState=running CurrentState=shutting-down","title":"instance-terminate"},{"location":"command-reference-wip/#instance-termination-protection","text":"List current state of Termination Protection for EC2 Instance(s) USAGE: instance-termination-protection instance-id [instance-id] $ instances | instance-termination-protection i-4e15ece1de1a3f869 DisableApiTermination=true i-89cefa9403373d7a5 DisableApiTermination=false i-806d8f1592e2a2efd DisableApiTermination=false i-61e86ac6be1e2c193 DisableApiTermination=false","title":"instance-termination-protection"},{"location":"command-reference-wip/#instance-termination-protection-disable","text":"Disable EC2 Instance termination protection USAGE: instance-termination-protection-disable instance-id [instance-id]","title":"instance-termination-protection-disable"},{"location":"command-reference-wip/#instance-termination-protection-enable","text":"Enable EC2 Instance termination protection USAGE: instance-termination-protection-enable instance-id [instance-id]","title":"instance-termination-protection-enable"},{"location":"command-reference-wip/#instance-type","text":"List type of instance(s) USAGE: instance-type instance-id [instance-id] $ instances | instance-type i-4e15ece1de1a3f869 t3.nano i-89cefa9403373d7a5 t3.nano i-806d8f1592e2a2efd t3.nano i-61e86ac6be1e2c193 t3.nano","title":"instance-type"},{"location":"command-reference-wip/#instance-userdata","text":"List userdata for instance(s) USAGE: instance-userdata instance-id [instance-id]","title":"instance-userdata"},{"location":"command-reference-wip/#instance-volumes","text":"List volumes of instance(s) USAGE: instance-volumes instance-id [instance-id] $ instances postgres | instance-volumes i-89cefa9403373d7a5 vol-cf5ddae9 i-806d8f1592e2a2efd vol-38fd45c3","title":"instance-volumes"},{"location":"command-reference-wip/#instance-vpc","text":"List VPC of instance(s) USAGE: instance-vpcs instance-id [instance-id]","title":"instance-vpc"},{"location":"command-reference-wip/#asg-commands","text":"","title":"asg-commands"},{"location":"command-reference-wip/#asgs","text":"List EC2 Autoscaling Groups","title":"asgs"},{"location":"command-reference-wip/#asg-capacity","text":"List min, desired and maximum capacities of EC2 Autoscaling Group(s)","title":"asg-capacity"},{"location":"command-reference-wip/#asg-desired-size-set","text":"Set desired capacity of autoscaling group(s)","title":"asg-desired-size-set"},{"location":"command-reference-wip/#asg-instances","text":"List instances of autoscaling group(s)","title":"asg-instances"},{"location":"command-reference-wip/#asg-launch-configuration","text":"List Launch Configurations of Autoscaling Group(s)","title":"asg-launch-configuration"},{"location":"command-reference-wip/#launch-configurations","text":"List Launch Configurations","title":"launch-configurations"},{"location":"command-reference-wip/#launch-configuration-asgs","text":"List EC2 Autoscaling Groups of Launch COnfiguration(s)","title":"launch-configuration-asgs"},{"location":"command-reference-wip/#asg-max-size-set","text":"Set maximum size of autoscaling group(s)","title":"asg-max-size-set"},{"location":"command-reference-wip/#asg-min-size-set","text":"Set minimum size of autoscaling group(s)","title":"asg-min-size-set"},{"location":"command-reference-wip/#asg-processes_suspended","text":"List suspended processes of an autoscaling group","title":"asg-processes_suspended"},{"location":"command-reference-wip/#asg-resume","text":"Resume all processes of an autoscaling group","title":"asg-resume"},{"location":"command-reference-wip/#asg-suspend","text":"Suspend all processes of an autoscaling group","title":"asg-suspend"},{"location":"command-reference-wip/#asg-stack","text":"List CloudFormation stack for asg(s)","title":"asg-stack"},{"location":"command-reference-wip/#asg-scaling-activities","text":"List scaling activities for Autoscaling Group(s)","title":"asg-scaling-activities"},{"location":"command-reference-wip/#cert-commands","text":"","title":"cert-commands"},{"location":"command-reference-wip/#certs","text":"List ACM Certificates","title":"certs"},{"location":"command-reference-wip/#certs-arn","text":"Same as certs but with the ARN in first column","title":"certs-arn"},{"location":"command-reference-wip/#cert-users","text":"List resources using ACM Cert(s) USAGE: cert-users cert-arn [cert-arn]","title":"cert-users"},{"location":"command-reference-wip/#cert-delete","text":"Delete ACM Cert(s) USAGE: cert-delete cert-arn [cert-arn]","title":"cert-delete"},{"location":"command-reference-wip/#cloudtrail-commands","text":"","title":"cloudtrail-commands"},{"location":"command-reference-wip/#cloudtrails","text":"List Cloudtrails $ cloudtrails failmode failmode-cloudtrail ap-southeast-2 IsMultiRegionTrail=true IncludeGlobalServiceEvents=true","title":"cloudtrails"},{"location":"command-reference-wip/#cloudtrail-status","text":"List logging status of Cloudtrails USAGE: cloudtrail-status cloudtrail [cloudtrail]","title":"cloudtrail-status"},{"location":"command-reference-wip/#ecr-commands","text":"","title":"ecr-commands"},{"location":"command-reference-wip/#ecr-repositories","text":"List ECR Repositories","title":"ecr-repositories"},{"location":"command-reference-wip/#ecr-repository-images","text":"List images for ECR Repositories","title":"ecr-repository-images"},{"location":"command-reference-wip/#elb-commands","text":"","title":"elb-commands"},{"location":"command-reference-wip/#elbs","text":"List ELBs Accepts LoadBalancer names or ARNS on STDIN and converts to LoadBalancer names $ elbs elb-MyLoadBalancer-1FNISWJN0W6N9 2019-12-13T10:24:55.220Z subnet-eff2cf88 another-e-MyLoadBa-171CPCZF2E84T 2019-12-13T10:25:24.300Z subnet-eff2cf88","title":"elbs"},{"location":"command-reference-wip/#elb-dnsname","text":"List DNS Names of ELB(s) USAGE: elb-dnsname load-balancer [load-balancer] $ elbs | elb-dnsname elb-MyLoadBalancer-1FNISWJN0W6N9 elb-MyLoadBalancer-1FNISWJN0W6N9-563832045.ap-southeast-2.elb.amazonaws.com another-e-MyLoadBa-171CPCZF2E84T another-e-MyLoadBa-171CPCZF2E84T-1832721930.ap-southeast-2.elb.amazonaws.com","title":"elb-dnsname"},{"location":"command-reference-wip/#elb-instances","text":"List instances of ELB(s) USAGE: elb-instances load-balancer [load-balancer]","title":"elb-instances"},{"location":"command-reference-wip/#elb-stack","text":"List CloudFormation stack names of ELB(s) USAGE: elb-stack load-balancer [load-balancer] $ elbs | elb-stack elb elb-MyLoadBalancer-1FNISWJN0W6N9 another-elb another-e-MyLoadBa-171CPCZF2E84T","title":"elb-stack"},{"location":"command-reference-wip/#iam-commands","text":"","title":"iam-commands"},{"location":"command-reference-wip/#iam-roles","text":"List IAM Roles $ iam-roles config-role-ap-southeast-2 AROAI3QHAU3J2CDRNLQHD 2017-02-02T03:03:02Z AWSBatchServiceRole AROAJJWRGUPTRXTV52TED 2017-03-09T05:31:39Z ecsInstanceRole AROAJFQ3WMZXESGIKW5YD 2017-03-09T05:31:39Z","title":"iam-roles"},{"location":"command-reference-wip/#iam-role-principal","text":"List role principal for IAM Role(s) USAGE: iam-role-principal role-name [role-name]","title":"iam-role-principal"},{"location":"command-reference-wip/#image-commands","text":"","title":"image-commands"},{"location":"command-reference-wip/#images","text":"List EC2 AMI's Usage: images [owner] [image-id] [image-id]... owner defaults to self or can one or more of: an AWS_ACCOUNT_ID (e.g. 1234567890) an AWS_OWNER_ALIAS (amazon, amazon-marketplace, microsoft) image_id can be one or more AMIs Trialing a different approach for grabbing resource ids from input. As normal, you can pipe resource ids in as first token on each line. We treat all args that don't start with ami- as owner identifiers. Trialing a new pattern for output - putting the Name at the end. This is more like the output of ls -la Pro: Preceding fields tend to be of the same length Pro: Easier for eyes to scan final column for names(?) Con: Using this pattern for instances() would put name past 80 char point Con: Migrating instances() to this output is A Big Change (not made lightly)","title":"images"},{"location":"command-reference-wip/#image-deregister","text":"Deregister AMI(s) USAGE: image-deregister image_id [image_id]","title":"image-deregister"},{"location":"command-reference-wip/#keypair-commands","text":"","title":"keypair-commands"},{"location":"command-reference-wip/#keypairs","text":"List EC2 SSH Keypairs in current Region $ keypairs alice 8f:85:9a:1e:6c:76:29:34:37:45:de:7f:8d:f9:70:eb bob 56:73:29:c2:ad:7b:6f:b6:f2:f3:b4:de:e4:2b:12:d4","title":"keypairs"},{"location":"command-reference-wip/#keypair-create","text":"Create SSH Keypair on local machine and import public key into new EC2 Keypair. Provides benefits over AWS creating the keypair: Amazon never has access to private key. Private key is protected with passphrase before being written to disk. Keys is written to ~/.ssh with correct file permissions. You control the SSH Key type (algorithm, length, etc). USAGE: keypair-delete key_name [key_name] $ keypair-create yet-another-keypair Creating /home/m/.ssh/yet-another-keypair Generating public/private rsa key pair. Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/m/.ssh/yet-another-keypair. Your public key has been saved in /home/m/.ssh/yet-another-keypair.pub. The key fingerprint is: SHA256:zIpbxLo7rpQvKyezOLATk96B1kSL0QP41q6x8tUrySk m@localhost.localdomain The key's randomart image is: +---[RSA 4096]----+ |..o | |.. + | | .+.o | | .oo.. o | | o+. o S | |=o.+.= . | |+++==o+ | |XoE+*+ . | |o@+**+. | +----[SHA256]-----+ { \"KeyFingerprint\": \"21:82:f9:5b:79:d6:dc:0f:7b:79:43:7c:c5:34:6c:2d\", \"KeyName\": \"yet-another-keypair\" } Note KeyPair Name defaults to \"$(aws-account-alias)-$(region)\" if none provided","title":"keypair-create"},{"location":"command-reference-wip/#keypair-delete","text":"Delete EC2 SSH Keypairs by providing their names as arguments or via STDIN USAGE: keypair-delete key_name [key_name] $ keypair-delete alice bob You are about to delete the following EC2 SSH KeyPairs: alice bob Are you sure you want to continue? y $ keypairs | keypair-delete You are about to delete the following EC2 SSH KeyPairs: yet-another-keypair Are you sure you want to continue? y","title":"keypair-delete"},{"location":"command-reference-wip/#kms-commands","text":"","title":"kms-commands"},{"location":"command-reference-wip/#kms-encrypt","text":"Encrypt and base64 encode STDIN or file USAGE: kms-encrypt key_id/alias_id [plaintext_file] $ echo foobar | kms-encrypt alias/default AQICAHgcyN4vd3V/OB7NKI6IMbpENEu1+UfyiU...","title":"kms-encrypt"},{"location":"command-reference-wip/#kms-decrypt","text":"base64 decode and decrypt KMS Encrypted file or STDIN USAGE: kms-decrypt [ciphertext_file] $ kms-decrypt ciphertext.txt foobar $ echo foobar | kms-encrypt alias/default | kms-decrypt foobar","title":"kms-decrypt"},{"location":"command-reference-wip/#kms-aliases","text":"List KMS Aliases $ kms-aliases default alias/default d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/default","title":"kms-aliases"},{"location":"command-reference-wip/#kms-alias-create","text":"Create alias for KMS Key USAGE: kms-alias-create alias_name key_id $ kms-keys | tail -1 d714a175-db12-4574-8f27-aa071a1dfd8a $ kms-keys | tail -1 | kms-alias-create alias/foobar $ kms-aliases foobar alias/foobar d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/foobar","title":"kms-alias-create"},{"location":"command-reference-wip/#kms-alias-delete","text":"Delete alias for KMS Key USAGE: kms-alias-delete alias_name [alias_name] $ kms-aliases foobar | kms-alias-delete You are about to delete the following kms aliases: alias/foobar Are you sure you want to continue? y","title":"kms-alias-delete"},{"location":"command-reference-wip/#kms-keys","text":"List KMS Keys $ kms-keys 5044958c-151d-4995-bed4-dd05c1385b48 8ada3e65-e377-4435-a709-fbe75dfa1dd0 d714a175-db12-4574-8f27-aa071a1dfd8a","title":"kms-keys"},{"location":"command-reference-wip/#kms-key-create","text":"Create a KMS Key $ kms-key-create 9e94333b-8e85-497a-9791-e7c5edf9c35e","title":"kms-key-create"},{"location":"command-reference-wip/#kms-key-details","text":"List details for KMS Key(s)","title":"kms-key-details"},{"location":"command-reference-wip/#kms-key-disable","text":"Disable KMS Key(s) USAGE: kms-key-disable key_id [key_id] $ kms-key-disable 9e94333b-8e85-497a-9791-e7c5edf9c35e","title":"kms-key-disable"},{"location":"command-reference-wip/#kms-key-enable","text":"Enable KMS Key(s) USAGE: kms-key-enable key_id [key_id] $ kms-key-enable 9e94333b-8e85-497a-9791-e7c5edf9c35e","title":"kms-key-enable"},{"location":"command-reference-wip/#lambda-commands","text":"","title":"lambda-commands"},{"location":"command-reference-wip/#lambda-functions","text":"List lambda functions $ lambda-functions stars 2019-12-18T10:00:00.000+0000 python2.7 256 stripes 2019-12-19T10:21:42.444+0000 python3.7 128","title":"lambda-functions"},{"location":"command-reference-wip/#lambda-function-memory","text":"List memorySize for lambda function(s) USAGE: lambda-function-memory function [function]","title":"lambda-function-memory"},{"location":"command-reference-wip/#lambda-function-memory-set","text":"Update memorySize for lambda function(s) USAGE: lambda-function-memory-set memory function [function]","title":"lambda-function-memory-set"},{"location":"command-reference-wip/#lambda-function-memory-step","text":"Repeatedly update memorySize for lambda function(s) Useful for measuring impact of memory on cost/performance. The function increases memorySize by 64KB every two minutes until it reaches the value requested. There is a two minute delay between increases to provide time to collect data from function execution. USAGE: lambda-function-memory-step memory function [function]","title":"lambda-function-memory-step"},{"location":"command-reference-wip/#log-commands","text":"","title":"log-commands"},{"location":"command-reference-wip/#log-groups","text":"List CloudWatch Log Groups $ log-groups /aws/lambda/stars2 1576495961429 0 11736 /aws/lambda/stars 1576566745961 0 107460 /aws/lambda/walk 1576567300172 0 11794","title":"log-groups"},{"location":"command-reference-wip/#rds-commands","text":"","title":"rds-commands"},{"location":"command-reference-wip/#rds-db-instances","text":"List RDS Database Instances","title":"rds-db-instances"},{"location":"command-reference-wip/#route53-commands","text":"","title":"route53-commands"},{"location":"command-reference-wip/#hosted-zones","text":"List Route53 Hosted Zones $ hosted-zones /hostedzone/Z3333333333333 5 NotPrivateZone bash-my-aws.org. /hostedzone/Z5555555555555 2 NotPrivateZone bash-my-universe.com. /hostedzone/Z4444444444444 3 NotPrivateZone bashmyaws.org. /hostedzone/Z1111111111111 3 NotPrivateZone bash-my-aws.com. /hostedzone/Z2222222222222 3 NotPrivateZone bashmyaws.com.","title":"hosted-zones"},{"location":"command-reference-wip/#hosted-zone-ns-records","text":"Generate NS records for delegating domain to AWS $ hosted-zones bash-my-aws.org /hostedzone/ZJ6ZCG2UD6OKX 5 NotPrivateZone bash-my-aws.org. $ hosted-zones bash-my-aws.org | hosted-zone-ns-records bash-my-aws.org. 300 IN NS ns-786.awsdns-34.net. bash-my-aws.org. 300 IN NS ns-1549.awsdns-01.co.uk. bash-my-aws.org. 300 IN NS ns-362.awsdns-45.com. bash-my-aws.org. 300 IN NS ns-1464.awsdns-55.org.","title":"hosted-zone-ns-records"},{"location":"command-reference-wip/#s3-commands","text":"","title":"s3-commands"},{"location":"command-reference-wip/#buckets","text":"List S3 Buckets $ buckets web-assets 2019-12-20 08:24:38.182045 backups 2019-12-20 08:24:44.351215 archive 2019-12-20 08:24:57.567652","title":"buckets"},{"location":"command-reference-wip/#bucket-acls","text":"List S3 Bucket Access Control Lists. $ bucket-acls another-example-bucket another-example-bucket Note The only recommended use case for the bucket ACL is to grant write permission to the Amazon S3 Log Delivery group to write access log objects to your bucket. AWS docs","title":"bucket-acls"},{"location":"command-reference-wip/#bucket-remove","text":"Remove an empty S3 Bucket. In this example the bucket is not empty. $ bucket-remove another-example-bucket You are about to remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y remove_bucket failed: s3://another-example-bucket An error occurred (BucketNotEmpty) when calling the DeleteBucket operation: The bucket you tried to delete is not empty","title":"bucket-remove"},{"location":"command-reference-wip/#bucket-remove-force","text":"Remove an S3 Bucket, and delete all objects if it's not empty. $ bucket-remove-force another-example-bucket You are about to delete all objects from and remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y delete: s3://another-example-bucket/aliases remove_bucket: another-example-bucket","title":"bucket-remove-force"},{"location":"command-reference-wip/#sts-commands","text":"","title":"sts-commands"},{"location":"command-reference-wip/#sts-assume-role","text":"Assume an IAM Role USAGE: sts-assume-role role_arn","title":"sts-assume-role"},{"location":"command-reference-wip/#vpc-commands","text":"","title":"vpc-commands"},{"location":"command-reference-wip/#pcxs","text":"List VPC Peering connections","title":"pcxs"},{"location":"command-reference-wip/#subnets","text":"List subnets for all VPCs $ subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME","title":"subnets"},{"location":"command-reference-wip/#vpcs","text":"List VPCs $ vpcs vpc-018d9739 default-vpc NO_NAME 172.31.0.0/16 NO_STACK NO_VERSION","title":"vpcs"},{"location":"command-reference-wip/#vpc-azs","text":"List availability zones of VPC(s) USAGE: vpc-azs vpc-id [vpc-id] $ vpcs | vpc-azs vpc-018d9739 ap-southeast-2a ap-southeast-2b ap-southeast-2c","title":"vpc-azs"},{"location":"command-reference-wip/#vpc-az-count","text":"List number of Availability Zones of VPC(s) USAGE: vpc-az-count vpc-id [vpc-id] $ vpcs | vpc-az-count vpc-018d9739 3","title":"vpc-az-count"},{"location":"command-reference-wip/#vpc-lambda-functions","text":"List lambda functions of VPC(s) USAGE: vpc-lambda-functions vpc-id [vpc-id]","title":"vpc-lambda-functions"},{"location":"command-reference-wip/#vpc-dhcp-options-ntp","text":"List NTP servers of VPC(s) USAGE: vpc-dhcp-options-ntp vpc-id [vpc-id]","title":"vpc-dhcp-options-ntp"},{"location":"command-reference-wip/#vpc-endpoints","text":"List VPC Endpoints of VPC(s) USAGE: vpc-endpoints vpc-id [vpc-id]","title":"vpc-endpoints"},{"location":"command-reference-wip/#vpc-endpoint-services","text":"List available VPC endpoint services USAGE: vpc-endpoint-services vpc-id [vpc-id]","title":"vpc-endpoint-services"},{"location":"command-reference-wip/#vpc-igw","text":"List Internet Gateway of VPC(s) USAGE: vpc-igw vpc-id [vpc-id]","title":"vpc-igw"},{"location":"command-reference-wip/#vpc-route-tables","text":"List Route Tables of VPC(s) USAGE: vpc-route-tables vpc-id [vpc-id] $ vpcs | vpc-route-tables rtb-8e841c39 vpc-018d9739 NO_NAME","title":"vpc-route-tables"},{"location":"command-reference-wip/#vpc-nat-gateways","text":"List NAT Gateways of VPC(s) USAGE: vpc-nat-gateways vpc-id [vpc-id]","title":"vpc-nat-gateways"},{"location":"command-reference-wip/#vpc-subnets","text":"List subnets of VPC(s) USAGE: vpc-subnets vpc-id [vpc-id] $ vpcs | vpc-subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME","title":"vpc-subnets"},{"location":"command-reference-wip/#vpc-network-acls","text":"List Network ACLs of VPC(s) USAGE: vpc-network-acls vpc-id [vpc-id] $ vpcs | vpc-network-acls acl-ff4914d1 vpc-018d9739","title":"vpc-network-acls"},{"location":"command-reference-wip/#vpc-rds","text":"List RDS instances of VPC(s) USAGE: vpc-rds vpc-id [vpc-id]","title":"vpc-rds"},{"location":"command-reference-wip/#vpc-default-delete","text":"Print commands you would need to run to delete that pesky default VPC Exclude default VPCs that contain: - instances - lambda functions $ vpc-default-delete # Deleting default VPC vpc-018d9739 in ap-southeast-2 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-8bb774fe aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-9eea2c07 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-34fd9cfa aws --region ap-southeast-2 ec2 delete-vpc --vpc-id=vpc-018d9739","title":"vpc-default-delete"},{"location":"command-reference/","text":"The project provides over 120 commands but fear not, much has been done to make them discoverable , memorable and hopefully in many cases obvious . The reference material below is all extracted from the source of the commands. While not necessary to use the commands. Be curious. Read the source. :-) Lists in this project are alphabetised except where it makes sense not to. The first few sets of commands were chosen because they are likely to be of the most interest to readers. General Rules Commands expect $AWS_DEFAULT_REGION environment variable to be set (check/set with region command) Most commands that list resources ( stacks , `instances , etc) accept filter term as first arg. e.g. stacks blah is equivalent to stacks | grep blah Most commands accept resource identifiers via STDIN (first token of each line) Resources are generally listed in chronological order of creation. aws-account-commands \u00b6 aws-account-alias \u00b6 Retrieve AWS Account Alias for current account $ aws-account-alias example-account-prod aws-account-id \u00b6 Retrieve AWS Account ID for current account $ aws-account-id 012345678901 aws-account-each \u00b6 Run a script/command across a number of AWS Accounts USAGE: aws-account-each cmd # pipe in AWS_ACCOUNT_IDS $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED # account=012345678901 alias=example-account-prod example-stack1-prod CREATED_FAILED example-stack2-prod UPDATE_ROLLBACK_FAILED # account=123456789012 alias=example-account-staging example-stack1-staging CREATED_FAILED example-stack2-staging UPDATE_ROLLBACK_FAILED Note In order to use aws-account-each , you need to be authenticated with an IAM Role that can assume a Role in each of the specified accounts. Check the source for more info. aws-panopticon \u00b6 aws-panopticon was previous name for aws-account-each() aws-account-cost-explorer \u00b6 Use with an AWS Organisations Master Account to open multiple accounts in Cost Explorer. $ grep demo AWS_ACCOUNTS | aws-account-cost-explorer #=> Opens web browser to AWS Cost Explorer with accounts selected aws-account-cost-recommendations \u00b6 Use with an AWS Organisations Master Account to open multiple accounts in Cost Recommendations. $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED #=> Opens web browser to AWS Cost Recommendations with accounts selected region-commands \u00b6 regions \u00b6 List regions The region() function must be sourced in order to update the AWS_DEFAULT_REGION environment variable. This is because it cannot update an environment variable when run as a subprocess. $ regions ap-northeast-1 ap-northeast-2 ap-south-1 ap-southeast-1 ap-southeast-2 ... us-west-2 region \u00b6 Get/Set $AWS_DEFAULT_REGION shell environment variable $ region us-east-1 $ region ap-southeast-2 $ region ap-southeast-2 region-each \u00b6 Run a command in every region. Any output lines will be appended with \"#${REGION}\". $ region-each stacks | column -t example-ec2-ap-northeast-1 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-1 example-ec2-ap-northeast-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-2 ... example-ec2-us-west-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #us-west-2 stack-commands \u00b6 stacks \u00b6 List CloudFormation stacks. To make it fly we omit stacks with status of DELETE_COMPLETE Output is sorted by CreationTime $ stacks nagios CREATE_COMPLETE 2018-03-12T11:41:31Z NEVER_UPDATED NOT_NESTED postgres1 CREATE_COMPLETE 2019-04-14T15:22:44Z NEVER_UPDATED NOT_NESTED postgres2 CREATE_COMPLETE 2019-05-18T05:45:50Z NEVER_UPDATED NOT_NESTED prometheus-web CREATE_COMPLETE 2019-11-23T15:57:04Z NEVER_UPDATED NOT_NESTED Provide a filter string for a | grep effect with tighter columisation: $ stacks postgres postgres1 CREATE_COMPLETE 2019-04-14T15:22:44Z NEVER_UPDATED NOT_NESTED postgres2 CREATE_COMPLETE 2019-05-18T05:45:50Z NEVER_UPDATED NOT_NESTED stack-arn \u00b6 Returns ARN(s) for stacks. USAGE: stack-arn stack [stack] $ stack-arn prometheus-web arn:aws:cloudformation:us-east-1:000000000000:stack/prometheus-web/805e081c-b8eb-4f6c-9872-2b5cddc77fba Supports multiple stack names from STDIN : $ stacks | stack-arn arn:aws:cloudformation:us-east-1:000000000000:stack/nagios/c0f0ef04-b505-4c0c-87cd-ca924153ad1c arn:aws:cloudformation:us-east-1:000000000000:stack/postgres1/758b0ba2-60f2-4432-8935-f79f47708f23 arn:aws:cloudformation:us-east-1:000000000000:stack/postgres2/7420bbd4-3026-444f-b55b-fa0a9d564730 arn:aws:cloudformation:us-east-1:000000000000:stack/prometheus-web/805e081c-b8eb-4f6c-9872-2b5cddc77fba stack-cancel-update \u00b6 stack-create \u00b6 stack-update \u00b6 stack-delete \u00b6 delete an existing stack stack-exports \u00b6 stack-recreate \u00b6 stack-failure \u00b6 type: detail return the reason a stack failed to update/create/delete FIXME: only grab the latest failure stack-events \u00b6 List event history for a single Stack USAGE: stack-events stack stack-resources \u00b6 List all resources in Stack(s) USAGE: stack-resources stack [stack] $ stacks | stack-resources i-7d54924538baa7a1f AWS::EC2::Instance ec2 i-c54279c6055c3c794 AWS::EC2::Instance nagios i-a8b8dd6783e1a40cc AWS::EC2::Instance postgres1 i-5d74753e210bfe04d AWS::EC2::Instance postgres2 i-2aa95cc214a461398 AWS::EC2::Instance prometheus-web stack-asgs \u00b6 List ASGs in Stack(s) USAGE: stack-asgs stack [stack] $ stacks | stack-asgs asg-bash-my-aws-AutoScalingGroup-MSBCWRTI3PVM AWS::AutoScaling::AutoScalingGroup asg-bash-my-aws asg2-AutoScalingGroup-1FHUVUJ7SLPU7 AWS::AutoScaling::AutoScalingGroup asg2 stack-asg-instances \u00b6 List EC2 Instances of EC2 Autoscaling Groups in Stack(s) USAGE: stack-asg-instances stack [stack] $ stacks | stack-asg-instances i-06ee900565652ecc5 ami-0119aa4d67e59007c t3.nano running asg-bash-my-aws 2019-12-13T03:15:22.000Z ap-southeast-2c vpc-deb8edb9 i-01c7edb986c18c16a ami-0119aa4d67e59007c t3.nano running asg2 2019-12-13T03:37:51.000Z ap-southeast-2c vpc-deb8edb9 stack-elbs \u00b6 List EC2 Elastic Load Balancers in Stack(s) USAGE: stack-elbs stack [stack] $ stacks | stack-elbs elb-MyLoadBalancer-NA5S72MLA5KI AWS::ElasticLoadBalancing::LoadBalancer elb-stack-1 load-bala-MyLoadBa-11HZ0DHUHJZZI AWS::ElasticLoadBalancing::LoadBalancer elb-stack-2 stack-instances \u00b6 List instances in stack(s) USAGE: stack-instances stack [stack] $ stacks | stack-instances i-7d54924538baa7a1f ami-123456789012 t3.nano stopped ec2 2019-12-11T09:31:03.000Z ap-southeast-2a None i-c54279c6055c3c794 ami-123456789012 t3.nano running nagios 2019-12-13T02:24:30.000Z ap-southeast-2a None i-a8b8dd6783e1a40cc ami-123456789012 t3.nano running postgres1 2019-12-13T02:24:32.000Z ap-southeast-2a None i-5d74753e210bfe04d ami-123456789012 t3.nano running postgres2 2019-12-13T02:24:34.000Z ap-southeast-2a None i-2aa95cc214a461398 ami-123456789012 t3.nano running prometheus-web 2019-12-13T02:24:36.000Z ap-southeast-2a None stack-parameters \u00b6 return the parameters applied to a stack stack-status \u00b6 type: detail return the current status of a stack stack-tag \u00b6 return a selected stack tag stack-tag-apply \u00b6 apply a stack tag stack-tag-delete \u00b6 delete a stack tag stack-tail \u00b6 type: detail follow the events occuring for a stack stack-template \u00b6 return the template applied to a stack stack-tags \u00b6 return the stack-tags applied to a stack stack-tags-text \u00b6 return all stack tags on a single line stack-outputs \u00b6 type: detail return the outputs of a stack stack-validate \u00b6 type: detail validate a stack template stack-diff \u00b6 type: detail return differences between a template and Stack report changes which would be made to stack if template were applied report on what changes would be made to stack by applying params If we are working from a single argument (ignore args starting with -- ) Strip path and extension from template Deduce params filename from stack and template names Strip path and extension from template File extension gets stripped off if template name provided as stack name Determine name of template to use determine name of params file to use determine what (if any) capabilities a given stack was deployed with instance-commands \u00b6 instances \u00b6 List EC2 Instances $ instances i-4e15ece1de1a3f869 ami-123456789012 t3.nano running nagios 2019-12-10T08:17:18.000Z ap-southeast-2a None i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None i-61e86ac6be1e2c193 ami-123456789012 t3.nano running prometheus-web 2019-12-10T08:17:24.000Z ap-southeast-2a None Optionally provide a filter string for a | grep effect with tighter columisation: $ instances postgres i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None instance-asg \u00b6 List autoscaling group membership of EC2 Instance(s) USAGE: instance-asg instance-id [instance-id] instance-az \u00b6 List availability zone of EC2 Instance(s) USAGE: instance-az instance-id [instance-id] $ instances postgres | instance-az i-89cefa9403373d7a5 ap-southeast-2a i-806d8f1592e2a2efd ap-southeast-2a instance-console \u00b6 List console output of EC2 Instance(s) USAGE: instance-console instance-id [instance-id] $ instances postgres | instance-console Console output for EC2 Instance i-89cefa9403373d7a5 Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip... Console output for EC2 Instance i-806d8f1592e2a2efd Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip... instance-dns \u00b6 List DNS name of EC2 Instance(s) USAGE: instance-dns instance-id [instance-id] $ instances postgres | instance-dns i-89cefa9403373d7a5 ip-10-155-35-61.ap-southeast-2.compute.internal ec2-54-214-206-114.ap-southeast-2.compute.amazonaws.com i-806d8f1592e2a2efd ip-10-178-243-63.ap-southeast-2.compute.internal ec2-54-214-244-90.ap-southeast-2.compute.amazonaws.com instance-health-set-unhealthy \u00b6 Mark EC2 Instance(s) as unhealthy (to trigger replacement by ASG) USAGE: instance-health-set-unhealthy instance-id [instance-id] instance-iam-profile \u00b6 List iam-profile of EC2 Instance(s) USAGE: instance-iam-profile instance-id [instance-id] instance-ip \u00b6 List ip address of EC2 Instance(s) USAGE: instance-ip instance-id [instance-id] $ instances postgres | instance-ip i-89cefa9403373d7a5 10.155.35.61 54.214.206.114 i-806d8f1592e2a2efd 10.178.243.63 54.214.244.90 instance-ssh \u00b6 Establish SSH connection to EC2 Instance(s) USAGE: instance-ssh [login] [instance-id] [instance-id] instance-ssh-details \u00b6 List details needed to SSH into EC2 Instance(s) USAGE: instance-ssh-details [login] [instance-id] [instance-id] instance-stack \u00b6 List CloudFormation stack EC2 Instance(s) belong to (if any) USAGE: instance-stack instance-id [instance-id] $ instances postgres | instance-stack postgres1 i-89cefa9403373d7a5 postgres2 i-806d8f1592e2a2efd instance-start \u00b6 Start stopped EC2 Instance(s) USAGE: instance-start instance-id [instance-id] $ instances postgres | instance-start i-a8b8dd6783e1a40cc PreviousState=stopped CurrentState=pending i-5d74753e210bfe04d PreviousState=stopped CurrentState=pending instance-state \u00b6 List state of EC2 Instance(s) USAGE: instance-state instance-id [instance-id] $ instances postgres | instance-state i-89cefa9403373d7a5 running i-806d8f1592e2a2efd running instance-stop \u00b6 Stop EC2 Instance(s) USAGE: instance-stop instance-id [instance-id] $ instances postgres | instance-stop i-a8b8dd6783e1a40cc PreviousState=running CurrentState=stopping i-5d74753e210bfe04d PreviousState=running CurrentState=stopping instance-tags \u00b6 List tags applied EC2 Instance(s) USAGE: instance-tags instance-id [instance-id] instance-terminate \u00b6 Terminate EC2 Instance(s) USAGE: instance-terminate instance-id [instance-id] $ instances | head -3 | instance-terminate You are about to terminate the following instances: i-01c7edb986c18c16a ami-0119aa4d67e59007c t3.nano terminated asg2 2019-12-13T03:37:51.000Z ap-southeast-2c None i-012dded46894dfa04 ami-0119aa4d67e59007c t3.nano running ec2 2019-12-13T10:12:55.000Z ap-southeast-2b vpc-deb8edb9 Are you sure you want to continue? y i-06ee900565652ecc5 PreviousState=terminated CurrentState=terminated i-01c7edb986c18c16a PreviousState=terminated CurrentState=terminated i-012dded46894dfa04 PreviousState=running CurrentState=shutting-down instance-termination-protection \u00b6 List current state of Termination Protection for EC2 Instance(s) USAGE: instance-termination-protection instance-id [instance-id] $ instances | instance-termination-protection i-4e15ece1de1a3f869 DisableApiTermination=true i-89cefa9403373d7a5 DisableApiTermination=false i-806d8f1592e2a2efd DisableApiTermination=false i-61e86ac6be1e2c193 DisableApiTermination=false instance-termination-protection-disable \u00b6 Disable EC2 Instance termination protection USAGE: instance-termination-protection-disable instance-id [instance-id] instance-termination-protection-enable \u00b6 Enable EC2 Instance termination protection USAGE: instance-termination-protection-enable instance-id [instance-id] instance-type \u00b6 List type of instance(s) USAGE: instance-type instance-id [instance-id] $ instances | instance-type i-4e15ece1de1a3f869 t3.nano i-89cefa9403373d7a5 t3.nano i-806d8f1592e2a2efd t3.nano i-61e86ac6be1e2c193 t3.nano instance-userdata \u00b6 List userdata for instance(s) USAGE: instance-userdata instance-id [instance-id] instance-volumes \u00b6 List volumes of instance(s) USAGE: instance-volumes instance-id [instance-id] $ instances postgres | instance-volumes i-89cefa9403373d7a5 vol-cf5ddae9 i-806d8f1592e2a2efd vol-38fd45c3 instance-vpc \u00b6 List VPC of instance(s) USAGE: instance-vpcs instance-id [instance-id] asg-commands \u00b6 asgs \u00b6 List EC2 Autoscaling Groups asg-capacity \u00b6 List min, desired and maximum capacities of EC2 Autoscaling Group(s) asg-desired-size-set \u00b6 Set desired capacity of autoscaling group(s) asg-instances \u00b6 List instances of autoscaling group(s) asg-launch-configuration \u00b6 List Launch Configurations of Autoscaling Group(s) launch-configurations \u00b6 List Launch Configurations launch-configuration-asgs \u00b6 List EC2 Autoscaling Groups of Launch COnfiguration(s) asg-max-size-set \u00b6 Set maximum size of autoscaling group(s) asg-min-size-set \u00b6 Set minimum size of autoscaling group(s) asg-processes_suspended \u00b6 List suspended processes of an autoscaling group asg-resume \u00b6 Resume all processes of an autoscaling group asg-suspend \u00b6 Suspend all processes of an autoscaling group asg-stack \u00b6 List CloudFormation stack for asg(s) asg-scaling-activities \u00b6 List scaling activities for Autoscaling Group(s) cert-commands \u00b6 certs \u00b6 List ACM Certificates certs-arn \u00b6 Same as certs but with the ARN in first column cert-users \u00b6 List resources using ACM Cert(s) USAGE: cert-users cert-arn [cert-arn] cert-delete \u00b6 Delete ACM Cert(s) USAGE: cert-delete cert-arn [cert-arn] cloudtrail-commands \u00b6 cloudtrails \u00b6 List Cloudtrails $ cloudtrails failmode failmode-cloudtrail ap-southeast-2 IsMultiRegionTrail=true IncludeGlobalServiceEvents=true cloudtrail-status \u00b6 List logging status of Cloudtrails USAGE: cloudtrail-status cloudtrail [cloudtrail] ecr-commands \u00b6 ecr-repositories \u00b6 List ECR Repositories ecr-repository-images \u00b6 List images for ECR Repositories elb-commands \u00b6 elbs \u00b6 List ELBs Accepts LoadBalancer names or ARNS on STDIN and converts to LoadBalancer names $ elbs elb-MyLoadBalancer-1FNISWJN0W6N9 2019-12-13T10:24:55.220Z subnet-eff2cf88 another-e-MyLoadBa-171CPCZF2E84T 2019-12-13T10:25:24.300Z subnet-eff2cf88 elb-dnsname \u00b6 List DNS Names of ELB(s) USAGE: elb-dnsname load-balancer [load-balancer] $ elbs | elb-dnsname elb-MyLoadBalancer-1FNISWJN0W6N9 elb-MyLoadBalancer-1FNISWJN0W6N9-563832045.ap-southeast-2.elb.amazonaws.com another-e-MyLoadBa-171CPCZF2E84T another-e-MyLoadBa-171CPCZF2E84T-1832721930.ap-southeast-2.elb.amazonaws.com elb-instances \u00b6 List instances of ELB(s) USAGE: elb-instances load-balancer [load-balancer] elb-stack \u00b6 List CloudFormation stack names of ELB(s) USAGE: elb-stack load-balancer [load-balancer] $ elbs | elb-stack elb elb-MyLoadBalancer-1FNISWJN0W6N9 another-elb another-e-MyLoadBa-171CPCZF2E84T iam-commands \u00b6 iam-roles \u00b6 List IAM Roles $ iam-roles config-role-ap-southeast-2 AROAI3QHAU3J2CDRNLQHD 2017-02-02T03:03:02Z AWSBatchServiceRole AROAJJWRGUPTRXTV52TED 2017-03-09T05:31:39Z ecsInstanceRole AROAJFQ3WMZXESGIKW5YD 2017-03-09T05:31:39Z iam-role-principal \u00b6 List role principal for IAM Role(s) USAGE: iam-role-principal role-name [role-name] image-commands \u00b6 images \u00b6 List EC2 AMI's Usage: images [owner] [image-id] [image-id]... owner defaults to self or can one or more of: an AWS_ACCOUNT_ID (e.g. 1234567890) an AWS_OWNER_ALIAS (amazon, amazon-marketplace, microsoft) image_id can be one or more AMIs Trialing a different approach for grabbing resource ids from input. As normal, you can pipe resource ids in as first token on each line. We treat all args that don't start with ami- as owner identifiers. Trialing a new pattern for output - putting the Name at the end. This is more like the output of ls -la Pro: Preceding fields tend to be of the same length Pro: Easier for eyes to scan final column for names(?) Con: Using this pattern for instances() would put name past 80 char point Con: Migrating instances() to this output is A Big Change (not made lightly) image-deregister \u00b6 Deregister AMI(s) USAGE: image-deregister image_id [image_id] keypair-commands \u00b6 keypairs \u00b6 List EC2 SSH Keypairs in current Region $ keypairs alice 8f:85:9a:1e:6c:76:29:34:37:45:de:7f:8d:f9:70:eb bob 56:73:29:c2:ad:7b:6f:b6:f2:f3:b4:de:e4:2b:12:d4 keypair-create \u00b6 Create SSH Keypair on local machine and import public key into new EC2 Keypair. Provides benefits over AWS creating the keypair: Amazon never has access to private key. Private key is protected with passphrase before being written to disk. Keys is written to ~/.ssh with correct file permissions. You control the SSH Key type (algorithm, length, etc). USAGE: keypair-delete key_name [key_name] $ keypair-create yet-another-keypair Creating /home/m/.ssh/yet-another-keypair Generating public/private rsa key pair. Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/m/.ssh/yet-another-keypair. Your public key has been saved in /home/m/.ssh/yet-another-keypair.pub. The key fingerprint is: SHA256:zIpbxLo7rpQvKyezOLATk96B1kSL0QP41q6x8tUrySk m@localhost.localdomain The key's randomart image is: +---[RSA 4096]----+ |..o | |.. + | | .+.o | | .oo.. o | | o+. o S | |=o.+.= . | |+++==o+ | |XoE+*+ . | |o@+**+. | +----[SHA256]-----+ { \"KeyFingerprint\": \"21:82:f9:5b:79:d6:dc:0f:7b:79:43:7c:c5:34:6c:2d\", \"KeyName\": \"yet-another-keypair\" } Note KeyPair Name defaults to \"$(aws-account-alias)-$(region)\" if none provided keypair-delete \u00b6 Delete EC2 SSH Keypairs by providing their names as arguments or via STDIN USAGE: keypair-delete key_name [key_name] $ keypair-delete alice bob You are about to delete the following EC2 SSH KeyPairs: alice bob Are you sure you want to continue? y $ keypairs | keypair-delete You are about to delete the following EC2 SSH KeyPairs: yet-another-keypair Are you sure you want to continue? y kms-commands \u00b6 kms-encrypt \u00b6 Encrypt and base64 encode STDIN or file USAGE: kms-encrypt key_id/alias_id [plaintext_file] $ echo foobar | kms-encrypt alias/default AQICAHgcyN4vd3V/OB7NKI6IMbpENEu1+UfyiU... kms-decrypt \u00b6 base64 decode and decrypt KMS Encrypted file or STDIN USAGE: kms-decrypt [ciphertext_file] $ kms-decrypt ciphertext.txt foobar $ echo foobar | kms-encrypt alias/default | kms-decrypt foobar kms-aliases \u00b6 List KMS Aliases $ kms-aliases default alias/default d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/default kms-alias-create \u00b6 Create alias for KMS Key USAGE: kms-alias-create alias_name key_id $ kms-keys | tail -1 d714a175-db12-4574-8f27-aa071a1dfd8a $ kms-keys | tail -1 | kms-alias-create alias/foobar $ kms-aliases foobar alias/foobar d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/foobar kms-alias-delete \u00b6 Delete alias for KMS Key USAGE: kms-alias-delete alias_name [alias_name] $ kms-aliases foobar | kms-alias-delete You are about to delete the following kms aliases: alias/foobar Are you sure you want to continue? y kms-keys \u00b6 List KMS Keys $ kms-keys 5044958c-151d-4995-bed4-dd05c1385b48 8ada3e65-e377-4435-a709-fbe75dfa1dd0 d714a175-db12-4574-8f27-aa071a1dfd8a kms-key-create \u00b6 Create a KMS Key $ kms-key-create 9e94333b-8e85-497a-9791-e7c5edf9c35e kms-key-details \u00b6 List details for KMS Key(s) kms-key-disable \u00b6 Disable KMS Key(s) USAGE: kms-key-disable key_id [key_id] $ kms-key-disable 9e94333b-8e85-497a-9791-e7c5edf9c35e kms-key-enable \u00b6 Enable KMS Key(s) USAGE: kms-key-enable key_id [key_id] $ kms-key-enable 9e94333b-8e85-497a-9791-e7c5edf9c35e lambda-commands \u00b6 lambda-functions \u00b6 List lambda functions $ lambda-functions stars 2019-12-18T10:00:00.000+0000 python2.7 256 stripes 2019-12-19T10:21:42.444+0000 python3.7 128 lambda-function-memory \u00b6 List memorySize for lambda function(s) USAGE: lambda-function-memory function [function] lambda-function-memory-set \u00b6 Update memorySize for lambda function(s) USAGE: lambda-function-memory-set memory function [function] lambda-function-memory-step \u00b6 Repeatedly update memorySize for lambda function(s) Useful for measuring impact of memory on cost/performance. The function increases memorySize by 64KB every two minutes until it reaches the value requested. There is a two minute delay between increases to provide time to collect data from function execution. USAGE: lambda-function-memory-step memory function [function] log-commands \u00b6 log-groups \u00b6 List CloudWatch Log Groups $ log-groups /aws/lambda/stars2 1576495961429 0 11736 /aws/lambda/stars 1576566745961 0 107460 /aws/lambda/walk 1576567300172 0 11794 rds-commands \u00b6 rds-db-instances \u00b6 List RDS Database Instances route53-commands \u00b6 hosted-zones \u00b6 List Route53 Hosted Zones $ hosted-zones /hostedzone/Z3333333333333 5 NotPrivateZone bash-my-aws.org. /hostedzone/Z5555555555555 2 NotPrivateZone bash-my-universe.com. /hostedzone/Z4444444444444 3 NotPrivateZone bashmyaws.org. /hostedzone/Z1111111111111 3 NotPrivateZone bash-my-aws.com. /hostedzone/Z2222222222222 3 NotPrivateZone bashmyaws.com. hosted-zone-ns-records \u00b6 Generate NS records for delegating domain to AWS $ hosted-zones bash-my-aws.org /hostedzone/ZJ6ZCG2UD6OKX 5 NotPrivateZone bash-my-aws.org. $ hosted-zones bash-my-aws.org | hosted-zone-ns-records bash-my-aws.org. 300 IN NS ns-786.awsdns-34.net. bash-my-aws.org. 300 IN NS ns-1549.awsdns-01.co.uk. bash-my-aws.org. 300 IN NS ns-362.awsdns-45.com. bash-my-aws.org. 300 IN NS ns-1464.awsdns-55.org. s3-commands \u00b6 buckets \u00b6 List S3 Buckets $ buckets web-assets 2019-12-20 08:24:38.182045 backups 2019-12-20 08:24:44.351215 archive 2019-12-20 08:24:57.567652 bucket-acls \u00b6 List S3 Bucket Access Control Lists. $ bucket-acls another-example-bucket another-example-bucket Note The only recommended use case for the bucket ACL is to grant write permission to the Amazon S3 Log Delivery group to write access log objects to your bucket. AWS docs bucket-remove \u00b6 Remove an empty S3 Bucket. In this example the bucket is not empty. $ bucket-remove another-example-bucket You are about to remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y remove_bucket failed: s3://another-example-bucket An error occurred (BucketNotEmpty) when calling the DeleteBucket operation: The bucket you tried to delete is not empty bucket-remove-force \u00b6 Remove an S3 Bucket, and delete all objects if it's not empty. $ bucket-remove-force another-example-bucket You are about to delete all objects from and remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y delete: s3://another-example-bucket/aliases remove_bucket: another-example-bucket sts-commands \u00b6 sts-assume-role \u00b6 Assume an IAM Role USAGE: sts-assume-role role_arn vpc-commands \u00b6 pcxs \u00b6 List VPC Peering connections subnets \u00b6 List subnets for all VPCs $ subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME vpcs \u00b6 List VPCs $ vpcs vpc-018d9739 default-vpc NO_NAME 172.31.0.0/16 NO_STACK NO_VERSION vpc-azs \u00b6 List availability zones of VPC(s) USAGE: vpc-azs vpc-id [vpc-id] $ vpcs | vpc-azs vpc-018d9739 ap-southeast-2a ap-southeast-2b ap-southeast-2c vpc-az-count \u00b6 List number of Availability Zones of VPC(s) USAGE: vpc-az-count vpc-id [vpc-id] $ vpcs | vpc-az-count vpc-018d9739 3 vpc-lambda-functions \u00b6 List lambda functions of VPC(s) USAGE: vpc-lambda-functions vpc-id [vpc-id] vpc-dhcp-options-ntp \u00b6 List NTP servers of VPC(s) USAGE: vpc-dhcp-options-ntp vpc-id [vpc-id] vpc-endpoints \u00b6 List VPC Endpoints of VPC(s) USAGE: vpc-endpoints vpc-id [vpc-id] vpc-endpoint-services \u00b6 List available VPC endpoint services USAGE: vpc-endpoint-services vpc-id [vpc-id] vpc-igw \u00b6 List Internet Gateway of VPC(s) USAGE: vpc-igw vpc-id [vpc-id] vpc-route-tables \u00b6 List Route Tables of VPC(s) USAGE: vpc-route-tables vpc-id [vpc-id] $ vpcs | vpc-route-tables rtb-8e841c39 vpc-018d9739 NO_NAME vpc-nat-gateways \u00b6 List NAT Gateways of VPC(s) USAGE: vpc-nat-gateways vpc-id [vpc-id] vpc-subnets \u00b6 List subnets of VPC(s) USAGE: vpc-subnets vpc-id [vpc-id] $ vpcs | vpc-subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME vpc-network-acls \u00b6 List Network ACLs of VPC(s) USAGE: vpc-network-acls vpc-id [vpc-id] $ vpcs | vpc-network-acls acl-ff4914d1 vpc-018d9739 vpc-rds \u00b6 List RDS instances of VPC(s) USAGE: vpc-rds vpc-id [vpc-id] vpc-default-delete \u00b6 Print commands you would need to run to delete that pesky default VPC Exclude default VPCs that contain: - instances - lambda functions $ vpc-default-delete # Deleting default VPC vpc-018d9739 in ap-southeast-2 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-8bb774fe aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-9eea2c07 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-34fd9cfa aws --region ap-southeast-2 ec2 delete-vpc --vpc-id=vpc-018d9739","title":"Command Reference"},{"location":"command-reference/#aws-account-commands","text":"","title":"aws-account-commands"},{"location":"command-reference/#aws-account-alias","text":"Retrieve AWS Account Alias for current account $ aws-account-alias example-account-prod","title":"aws-account-alias"},{"location":"command-reference/#aws-account-id","text":"Retrieve AWS Account ID for current account $ aws-account-id 012345678901","title":"aws-account-id"},{"location":"command-reference/#aws-account-each","text":"Run a script/command across a number of AWS Accounts USAGE: aws-account-each cmd # pipe in AWS_ACCOUNT_IDS $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED # account=012345678901 alias=example-account-prod example-stack1-prod CREATED_FAILED example-stack2-prod UPDATE_ROLLBACK_FAILED # account=123456789012 alias=example-account-staging example-stack1-staging CREATED_FAILED example-stack2-staging UPDATE_ROLLBACK_FAILED Note In order to use aws-account-each , you need to be authenticated with an IAM Role that can assume a Role in each of the specified accounts. Check the source for more info.","title":"aws-account-each"},{"location":"command-reference/#aws-panopticon","text":"aws-panopticon was previous name for aws-account-each()","title":"aws-panopticon"},{"location":"command-reference/#aws-account-cost-explorer","text":"Use with an AWS Organisations Master Account to open multiple accounts in Cost Explorer. $ grep demo AWS_ACCOUNTS | aws-account-cost-explorer #=> Opens web browser to AWS Cost Explorer with accounts selected","title":"aws-account-cost-explorer"},{"location":"command-reference/#aws-account-cost-recommendations","text":"Use with an AWS Organisations Master Account to open multiple accounts in Cost Recommendations. $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED #=> Opens web browser to AWS Cost Recommendations with accounts selected","title":"aws-account-cost-recommendations"},{"location":"command-reference/#region-commands","text":"","title":"region-commands"},{"location":"command-reference/#regions","text":"List regions The region() function must be sourced in order to update the AWS_DEFAULT_REGION environment variable. This is because it cannot update an environment variable when run as a subprocess. $ regions ap-northeast-1 ap-northeast-2 ap-south-1 ap-southeast-1 ap-southeast-2 ... us-west-2","title":"regions"},{"location":"command-reference/#region","text":"Get/Set $AWS_DEFAULT_REGION shell environment variable $ region us-east-1 $ region ap-southeast-2 $ region ap-southeast-2","title":"region"},{"location":"command-reference/#region-each","text":"Run a command in every region. Any output lines will be appended with \"#${REGION}\". $ region-each stacks | column -t example-ec2-ap-northeast-1 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-1 example-ec2-ap-northeast-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-2 ... example-ec2-us-west-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #us-west-2","title":"region-each"},{"location":"command-reference/#stack-commands","text":"","title":"stack-commands"},{"location":"command-reference/#stacks","text":"List CloudFormation stacks. To make it fly we omit stacks with status of DELETE_COMPLETE Output is sorted by CreationTime $ stacks nagios CREATE_COMPLETE 2018-03-12T11:41:31Z NEVER_UPDATED NOT_NESTED postgres1 CREATE_COMPLETE 2019-04-14T15:22:44Z NEVER_UPDATED NOT_NESTED postgres2 CREATE_COMPLETE 2019-05-18T05:45:50Z NEVER_UPDATED NOT_NESTED prometheus-web CREATE_COMPLETE 2019-11-23T15:57:04Z NEVER_UPDATED NOT_NESTED Provide a filter string for a | grep effect with tighter columisation: $ stacks postgres postgres1 CREATE_COMPLETE 2019-04-14T15:22:44Z NEVER_UPDATED NOT_NESTED postgres2 CREATE_COMPLETE 2019-05-18T05:45:50Z NEVER_UPDATED NOT_NESTED","title":"stacks"},{"location":"command-reference/#stack-arn","text":"Returns ARN(s) for stacks. USAGE: stack-arn stack [stack] $ stack-arn prometheus-web arn:aws:cloudformation:us-east-1:000000000000:stack/prometheus-web/805e081c-b8eb-4f6c-9872-2b5cddc77fba Supports multiple stack names from STDIN : $ stacks | stack-arn arn:aws:cloudformation:us-east-1:000000000000:stack/nagios/c0f0ef04-b505-4c0c-87cd-ca924153ad1c arn:aws:cloudformation:us-east-1:000000000000:stack/postgres1/758b0ba2-60f2-4432-8935-f79f47708f23 arn:aws:cloudformation:us-east-1:000000000000:stack/postgres2/7420bbd4-3026-444f-b55b-fa0a9d564730 arn:aws:cloudformation:us-east-1:000000000000:stack/prometheus-web/805e081c-b8eb-4f6c-9872-2b5cddc77fba","title":"stack-arn"},{"location":"command-reference/#stack-cancel-update","text":"","title":"stack-cancel-update"},{"location":"command-reference/#stack-create","text":"","title":"stack-create"},{"location":"command-reference/#stack-update","text":"","title":"stack-update"},{"location":"command-reference/#stack-delete","text":"delete an existing stack","title":"stack-delete"},{"location":"command-reference/#stack-exports","text":"","title":"stack-exports"},{"location":"command-reference/#stack-recreate","text":"","title":"stack-recreate"},{"location":"command-reference/#stack-failure","text":"type: detail return the reason a stack failed to update/create/delete FIXME: only grab the latest failure","title":"stack-failure"},{"location":"command-reference/#stack-events","text":"List event history for a single Stack USAGE: stack-events stack","title":"stack-events"},{"location":"command-reference/#stack-resources","text":"List all resources in Stack(s) USAGE: stack-resources stack [stack] $ stacks | stack-resources i-7d54924538baa7a1f AWS::EC2::Instance ec2 i-c54279c6055c3c794 AWS::EC2::Instance nagios i-a8b8dd6783e1a40cc AWS::EC2::Instance postgres1 i-5d74753e210bfe04d AWS::EC2::Instance postgres2 i-2aa95cc214a461398 AWS::EC2::Instance prometheus-web","title":"stack-resources"},{"location":"command-reference/#stack-asgs","text":"List ASGs in Stack(s) USAGE: stack-asgs stack [stack] $ stacks | stack-asgs asg-bash-my-aws-AutoScalingGroup-MSBCWRTI3PVM AWS::AutoScaling::AutoScalingGroup asg-bash-my-aws asg2-AutoScalingGroup-1FHUVUJ7SLPU7 AWS::AutoScaling::AutoScalingGroup asg2","title":"stack-asgs"},{"location":"command-reference/#stack-asg-instances","text":"List EC2 Instances of EC2 Autoscaling Groups in Stack(s) USAGE: stack-asg-instances stack [stack] $ stacks | stack-asg-instances i-06ee900565652ecc5 ami-0119aa4d67e59007c t3.nano running asg-bash-my-aws 2019-12-13T03:15:22.000Z ap-southeast-2c vpc-deb8edb9 i-01c7edb986c18c16a ami-0119aa4d67e59007c t3.nano running asg2 2019-12-13T03:37:51.000Z ap-southeast-2c vpc-deb8edb9","title":"stack-asg-instances"},{"location":"command-reference/#stack-elbs","text":"List EC2 Elastic Load Balancers in Stack(s) USAGE: stack-elbs stack [stack] $ stacks | stack-elbs elb-MyLoadBalancer-NA5S72MLA5KI AWS::ElasticLoadBalancing::LoadBalancer elb-stack-1 load-bala-MyLoadBa-11HZ0DHUHJZZI AWS::ElasticLoadBalancing::LoadBalancer elb-stack-2","title":"stack-elbs"},{"location":"command-reference/#stack-instances","text":"List instances in stack(s) USAGE: stack-instances stack [stack] $ stacks | stack-instances i-7d54924538baa7a1f ami-123456789012 t3.nano stopped ec2 2019-12-11T09:31:03.000Z ap-southeast-2a None i-c54279c6055c3c794 ami-123456789012 t3.nano running nagios 2019-12-13T02:24:30.000Z ap-southeast-2a None i-a8b8dd6783e1a40cc ami-123456789012 t3.nano running postgres1 2019-12-13T02:24:32.000Z ap-southeast-2a None i-5d74753e210bfe04d ami-123456789012 t3.nano running postgres2 2019-12-13T02:24:34.000Z ap-southeast-2a None i-2aa95cc214a461398 ami-123456789012 t3.nano running prometheus-web 2019-12-13T02:24:36.000Z ap-southeast-2a None","title":"stack-instances"},{"location":"command-reference/#stack-parameters","text":"return the parameters applied to a stack","title":"stack-parameters"},{"location":"command-reference/#stack-status","text":"type: detail return the current status of a stack","title":"stack-status"},{"location":"command-reference/#stack-tag","text":"return a selected stack tag","title":"stack-tag"},{"location":"command-reference/#stack-tag-apply","text":"apply a stack tag","title":"stack-tag-apply"},{"location":"command-reference/#stack-tag-delete","text":"delete a stack tag","title":"stack-tag-delete"},{"location":"command-reference/#stack-tail","text":"type: detail follow the events occuring for a stack","title":"stack-tail"},{"location":"command-reference/#stack-template","text":"return the template applied to a stack","title":"stack-template"},{"location":"command-reference/#stack-tags","text":"return the stack-tags applied to a stack","title":"stack-tags"},{"location":"command-reference/#stack-tags-text","text":"return all stack tags on a single line","title":"stack-tags-text"},{"location":"command-reference/#stack-outputs","text":"type: detail return the outputs of a stack","title":"stack-outputs"},{"location":"command-reference/#stack-validate","text":"type: detail validate a stack template","title":"stack-validate"},{"location":"command-reference/#stack-diff","text":"type: detail return differences between a template and Stack report changes which would be made to stack if template were applied report on what changes would be made to stack by applying params If we are working from a single argument (ignore args starting with -- ) Strip path and extension from template Deduce params filename from stack and template names Strip path and extension from template File extension gets stripped off if template name provided as stack name Determine name of template to use determine name of params file to use determine what (if any) capabilities a given stack was deployed with","title":"stack-diff"},{"location":"command-reference/#instance-commands","text":"","title":"instance-commands"},{"location":"command-reference/#instances","text":"List EC2 Instances $ instances i-4e15ece1de1a3f869 ami-123456789012 t3.nano running nagios 2019-12-10T08:17:18.000Z ap-southeast-2a None i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None i-61e86ac6be1e2c193 ami-123456789012 t3.nano running prometheus-web 2019-12-10T08:17:24.000Z ap-southeast-2a None Optionally provide a filter string for a | grep effect with tighter columisation: $ instances postgres i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None","title":"instances"},{"location":"command-reference/#instance-asg","text":"List autoscaling group membership of EC2 Instance(s) USAGE: instance-asg instance-id [instance-id]","title":"instance-asg"},{"location":"command-reference/#instance-az","text":"List availability zone of EC2 Instance(s) USAGE: instance-az instance-id [instance-id] $ instances postgres | instance-az i-89cefa9403373d7a5 ap-southeast-2a i-806d8f1592e2a2efd ap-southeast-2a","title":"instance-az"},{"location":"command-reference/#instance-console","text":"List console output of EC2 Instance(s) USAGE: instance-console instance-id [instance-id] $ instances postgres | instance-console Console output for EC2 Instance i-89cefa9403373d7a5 Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip... Console output for EC2 Instance i-806d8f1592e2a2efd Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip...","title":"instance-console"},{"location":"command-reference/#instance-dns","text":"List DNS name of EC2 Instance(s) USAGE: instance-dns instance-id [instance-id] $ instances postgres | instance-dns i-89cefa9403373d7a5 ip-10-155-35-61.ap-southeast-2.compute.internal ec2-54-214-206-114.ap-southeast-2.compute.amazonaws.com i-806d8f1592e2a2efd ip-10-178-243-63.ap-southeast-2.compute.internal ec2-54-214-244-90.ap-southeast-2.compute.amazonaws.com","title":"instance-dns"},{"location":"command-reference/#instance-health-set-unhealthy","text":"Mark EC2 Instance(s) as unhealthy (to trigger replacement by ASG) USAGE: instance-health-set-unhealthy instance-id [instance-id]","title":"instance-health-set-unhealthy"},{"location":"command-reference/#instance-iam-profile","text":"List iam-profile of EC2 Instance(s) USAGE: instance-iam-profile instance-id [instance-id]","title":"instance-iam-profile"},{"location":"command-reference/#instance-ip","text":"List ip address of EC2 Instance(s) USAGE: instance-ip instance-id [instance-id] $ instances postgres | instance-ip i-89cefa9403373d7a5 10.155.35.61 54.214.206.114 i-806d8f1592e2a2efd 10.178.243.63 54.214.244.90","title":"instance-ip"},{"location":"command-reference/#instance-ssh","text":"Establish SSH connection to EC2 Instance(s) USAGE: instance-ssh [login] [instance-id] [instance-id]","title":"instance-ssh"},{"location":"command-reference/#instance-ssh-details","text":"List details needed to SSH into EC2 Instance(s) USAGE: instance-ssh-details [login] [instance-id] [instance-id]","title":"instance-ssh-details"},{"location":"command-reference/#instance-stack","text":"List CloudFormation stack EC2 Instance(s) belong to (if any) USAGE: instance-stack instance-id [instance-id] $ instances postgres | instance-stack postgres1 i-89cefa9403373d7a5 postgres2 i-806d8f1592e2a2efd","title":"instance-stack"},{"location":"command-reference/#instance-start","text":"Start stopped EC2 Instance(s) USAGE: instance-start instance-id [instance-id] $ instances postgres | instance-start i-a8b8dd6783e1a40cc PreviousState=stopped CurrentState=pending i-5d74753e210bfe04d PreviousState=stopped CurrentState=pending","title":"instance-start"},{"location":"command-reference/#instance-state","text":"List state of EC2 Instance(s) USAGE: instance-state instance-id [instance-id] $ instances postgres | instance-state i-89cefa9403373d7a5 running i-806d8f1592e2a2efd running","title":"instance-state"},{"location":"command-reference/#instance-stop","text":"Stop EC2 Instance(s) USAGE: instance-stop instance-id [instance-id] $ instances postgres | instance-stop i-a8b8dd6783e1a40cc PreviousState=running CurrentState=stopping i-5d74753e210bfe04d PreviousState=running CurrentState=stopping","title":"instance-stop"},{"location":"command-reference/#instance-tags","text":"List tags applied EC2 Instance(s) USAGE: instance-tags instance-id [instance-id]","title":"instance-tags"},{"location":"command-reference/#instance-terminate","text":"Terminate EC2 Instance(s) USAGE: instance-terminate instance-id [instance-id] $ instances | head -3 | instance-terminate You are about to terminate the following instances: i-01c7edb986c18c16a ami-0119aa4d67e59007c t3.nano terminated asg2 2019-12-13T03:37:51.000Z ap-southeast-2c None i-012dded46894dfa04 ami-0119aa4d67e59007c t3.nano running ec2 2019-12-13T10:12:55.000Z ap-southeast-2b vpc-deb8edb9 Are you sure you want to continue? y i-06ee900565652ecc5 PreviousState=terminated CurrentState=terminated i-01c7edb986c18c16a PreviousState=terminated CurrentState=terminated i-012dded46894dfa04 PreviousState=running CurrentState=shutting-down","title":"instance-terminate"},{"location":"command-reference/#instance-termination-protection","text":"List current state of Termination Protection for EC2 Instance(s) USAGE: instance-termination-protection instance-id [instance-id] $ instances | instance-termination-protection i-4e15ece1de1a3f869 DisableApiTermination=true i-89cefa9403373d7a5 DisableApiTermination=false i-806d8f1592e2a2efd DisableApiTermination=false i-61e86ac6be1e2c193 DisableApiTermination=false","title":"instance-termination-protection"},{"location":"command-reference/#instance-termination-protection-disable","text":"Disable EC2 Instance termination protection USAGE: instance-termination-protection-disable instance-id [instance-id]","title":"instance-termination-protection-disable"},{"location":"command-reference/#instance-termination-protection-enable","text":"Enable EC2 Instance termination protection USAGE: instance-termination-protection-enable instance-id [instance-id]","title":"instance-termination-protection-enable"},{"location":"command-reference/#instance-type","text":"List type of instance(s) USAGE: instance-type instance-id [instance-id] $ instances | instance-type i-4e15ece1de1a3f869 t3.nano i-89cefa9403373d7a5 t3.nano i-806d8f1592e2a2efd t3.nano i-61e86ac6be1e2c193 t3.nano","title":"instance-type"},{"location":"command-reference/#instance-userdata","text":"List userdata for instance(s) USAGE: instance-userdata instance-id [instance-id]","title":"instance-userdata"},{"location":"command-reference/#instance-volumes","text":"List volumes of instance(s) USAGE: instance-volumes instance-id [instance-id] $ instances postgres | instance-volumes i-89cefa9403373d7a5 vol-cf5ddae9 i-806d8f1592e2a2efd vol-38fd45c3","title":"instance-volumes"},{"location":"command-reference/#instance-vpc","text":"List VPC of instance(s) USAGE: instance-vpcs instance-id [instance-id]","title":"instance-vpc"},{"location":"command-reference/#asg-commands","text":"","title":"asg-commands"},{"location":"command-reference/#asgs","text":"List EC2 Autoscaling Groups","title":"asgs"},{"location":"command-reference/#asg-capacity","text":"List min, desired and maximum capacities of EC2 Autoscaling Group(s)","title":"asg-capacity"},{"location":"command-reference/#asg-desired-size-set","text":"Set desired capacity of autoscaling group(s)","title":"asg-desired-size-set"},{"location":"command-reference/#asg-instances","text":"List instances of autoscaling group(s)","title":"asg-instances"},{"location":"command-reference/#asg-launch-configuration","text":"List Launch Configurations of Autoscaling Group(s)","title":"asg-launch-configuration"},{"location":"command-reference/#launch-configurations","text":"List Launch Configurations","title":"launch-configurations"},{"location":"command-reference/#launch-configuration-asgs","text":"List EC2 Autoscaling Groups of Launch COnfiguration(s)","title":"launch-configuration-asgs"},{"location":"command-reference/#asg-max-size-set","text":"Set maximum size of autoscaling group(s)","title":"asg-max-size-set"},{"location":"command-reference/#asg-min-size-set","text":"Set minimum size of autoscaling group(s)","title":"asg-min-size-set"},{"location":"command-reference/#asg-processes_suspended","text":"List suspended processes of an autoscaling group","title":"asg-processes_suspended"},{"location":"command-reference/#asg-resume","text":"Resume all processes of an autoscaling group","title":"asg-resume"},{"location":"command-reference/#asg-suspend","text":"Suspend all processes of an autoscaling group","title":"asg-suspend"},{"location":"command-reference/#asg-stack","text":"List CloudFormation stack for asg(s)","title":"asg-stack"},{"location":"command-reference/#asg-scaling-activities","text":"List scaling activities for Autoscaling Group(s)","title":"asg-scaling-activities"},{"location":"command-reference/#cert-commands","text":"","title":"cert-commands"},{"location":"command-reference/#certs","text":"List ACM Certificates","title":"certs"},{"location":"command-reference/#certs-arn","text":"Same as certs but with the ARN in first column","title":"certs-arn"},{"location":"command-reference/#cert-users","text":"List resources using ACM Cert(s) USAGE: cert-users cert-arn [cert-arn]","title":"cert-users"},{"location":"command-reference/#cert-delete","text":"Delete ACM Cert(s) USAGE: cert-delete cert-arn [cert-arn]","title":"cert-delete"},{"location":"command-reference/#cloudtrail-commands","text":"","title":"cloudtrail-commands"},{"location":"command-reference/#cloudtrails","text":"List Cloudtrails $ cloudtrails failmode failmode-cloudtrail ap-southeast-2 IsMultiRegionTrail=true IncludeGlobalServiceEvents=true","title":"cloudtrails"},{"location":"command-reference/#cloudtrail-status","text":"List logging status of Cloudtrails USAGE: cloudtrail-status cloudtrail [cloudtrail]","title":"cloudtrail-status"},{"location":"command-reference/#ecr-commands","text":"","title":"ecr-commands"},{"location":"command-reference/#ecr-repositories","text":"List ECR Repositories","title":"ecr-repositories"},{"location":"command-reference/#ecr-repository-images","text":"List images for ECR Repositories","title":"ecr-repository-images"},{"location":"command-reference/#elb-commands","text":"","title":"elb-commands"},{"location":"command-reference/#elbs","text":"List ELBs Accepts LoadBalancer names or ARNS on STDIN and converts to LoadBalancer names $ elbs elb-MyLoadBalancer-1FNISWJN0W6N9 2019-12-13T10:24:55.220Z subnet-eff2cf88 another-e-MyLoadBa-171CPCZF2E84T 2019-12-13T10:25:24.300Z subnet-eff2cf88","title":"elbs"},{"location":"command-reference/#elb-dnsname","text":"List DNS Names of ELB(s) USAGE: elb-dnsname load-balancer [load-balancer] $ elbs | elb-dnsname elb-MyLoadBalancer-1FNISWJN0W6N9 elb-MyLoadBalancer-1FNISWJN0W6N9-563832045.ap-southeast-2.elb.amazonaws.com another-e-MyLoadBa-171CPCZF2E84T another-e-MyLoadBa-171CPCZF2E84T-1832721930.ap-southeast-2.elb.amazonaws.com","title":"elb-dnsname"},{"location":"command-reference/#elb-instances","text":"List instances of ELB(s) USAGE: elb-instances load-balancer [load-balancer]","title":"elb-instances"},{"location":"command-reference/#elb-stack","text":"List CloudFormation stack names of ELB(s) USAGE: elb-stack load-balancer [load-balancer] $ elbs | elb-stack elb elb-MyLoadBalancer-1FNISWJN0W6N9 another-elb another-e-MyLoadBa-171CPCZF2E84T","title":"elb-stack"},{"location":"command-reference/#iam-commands","text":"","title":"iam-commands"},{"location":"command-reference/#iam-roles","text":"List IAM Roles $ iam-roles config-role-ap-southeast-2 AROAI3QHAU3J2CDRNLQHD 2017-02-02T03:03:02Z AWSBatchServiceRole AROAJJWRGUPTRXTV52TED 2017-03-09T05:31:39Z ecsInstanceRole AROAJFQ3WMZXESGIKW5YD 2017-03-09T05:31:39Z","title":"iam-roles"},{"location":"command-reference/#iam-role-principal","text":"List role principal for IAM Role(s) USAGE: iam-role-principal role-name [role-name]","title":"iam-role-principal"},{"location":"command-reference/#image-commands","text":"","title":"image-commands"},{"location":"command-reference/#images","text":"List EC2 AMI's Usage: images [owner] [image-id] [image-id]... owner defaults to self or can one or more of: an AWS_ACCOUNT_ID (e.g. 1234567890) an AWS_OWNER_ALIAS (amazon, amazon-marketplace, microsoft) image_id can be one or more AMIs Trialing a different approach for grabbing resource ids from input. As normal, you can pipe resource ids in as first token on each line. We treat all args that don't start with ami- as owner identifiers. Trialing a new pattern for output - putting the Name at the end. This is more like the output of ls -la Pro: Preceding fields tend to be of the same length Pro: Easier for eyes to scan final column for names(?) Con: Using this pattern for instances() would put name past 80 char point Con: Migrating instances() to this output is A Big Change (not made lightly)","title":"images"},{"location":"command-reference/#image-deregister","text":"Deregister AMI(s) USAGE: image-deregister image_id [image_id]","title":"image-deregister"},{"location":"command-reference/#keypair-commands","text":"","title":"keypair-commands"},{"location":"command-reference/#keypairs","text":"List EC2 SSH Keypairs in current Region $ keypairs alice 8f:85:9a:1e:6c:76:29:34:37:45:de:7f:8d:f9:70:eb bob 56:73:29:c2:ad:7b:6f:b6:f2:f3:b4:de:e4:2b:12:d4","title":"keypairs"},{"location":"command-reference/#keypair-create","text":"Create SSH Keypair on local machine and import public key into new EC2 Keypair. Provides benefits over AWS creating the keypair: Amazon never has access to private key. Private key is protected with passphrase before being written to disk. Keys is written to ~/.ssh with correct file permissions. You control the SSH Key type (algorithm, length, etc). USAGE: keypair-delete key_name [key_name] $ keypair-create yet-another-keypair Creating /home/m/.ssh/yet-another-keypair Generating public/private rsa key pair. Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/m/.ssh/yet-another-keypair. Your public key has been saved in /home/m/.ssh/yet-another-keypair.pub. The key fingerprint is: SHA256:zIpbxLo7rpQvKyezOLATk96B1kSL0QP41q6x8tUrySk m@localhost.localdomain The key's randomart image is: +---[RSA 4096]----+ |..o | |.. + | | .+.o | | .oo.. o | | o+. o S | |=o.+.= . | |+++==o+ | |XoE+*+ . | |o@+**+. | +----[SHA256]-----+ { \"KeyFingerprint\": \"21:82:f9:5b:79:d6:dc:0f:7b:79:43:7c:c5:34:6c:2d\", \"KeyName\": \"yet-another-keypair\" } Note KeyPair Name defaults to \"$(aws-account-alias)-$(region)\" if none provided","title":"keypair-create"},{"location":"command-reference/#keypair-delete","text":"Delete EC2 SSH Keypairs by providing their names as arguments or via STDIN USAGE: keypair-delete key_name [key_name] $ keypair-delete alice bob You are about to delete the following EC2 SSH KeyPairs: alice bob Are you sure you want to continue? y $ keypairs | keypair-delete You are about to delete the following EC2 SSH KeyPairs: yet-another-keypair Are you sure you want to continue? y","title":"keypair-delete"},{"location":"command-reference/#kms-commands","text":"","title":"kms-commands"},{"location":"command-reference/#kms-encrypt","text":"Encrypt and base64 encode STDIN or file USAGE: kms-encrypt key_id/alias_id [plaintext_file] $ echo foobar | kms-encrypt alias/default AQICAHgcyN4vd3V/OB7NKI6IMbpENEu1+UfyiU...","title":"kms-encrypt"},{"location":"command-reference/#kms-decrypt","text":"base64 decode and decrypt KMS Encrypted file or STDIN USAGE: kms-decrypt [ciphertext_file] $ kms-decrypt ciphertext.txt foobar $ echo foobar | kms-encrypt alias/default | kms-decrypt foobar","title":"kms-decrypt"},{"location":"command-reference/#kms-aliases","text":"List KMS Aliases $ kms-aliases default alias/default d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/default","title":"kms-aliases"},{"location":"command-reference/#kms-alias-create","text":"Create alias for KMS Key USAGE: kms-alias-create alias_name key_id $ kms-keys | tail -1 d714a175-db12-4574-8f27-aa071a1dfd8a $ kms-keys | tail -1 | kms-alias-create alias/foobar $ kms-aliases foobar alias/foobar d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/foobar","title":"kms-alias-create"},{"location":"command-reference/#kms-alias-delete","text":"Delete alias for KMS Key USAGE: kms-alias-delete alias_name [alias_name] $ kms-aliases foobar | kms-alias-delete You are about to delete the following kms aliases: alias/foobar Are you sure you want to continue? y","title":"kms-alias-delete"},{"location":"command-reference/#kms-keys","text":"List KMS Keys $ kms-keys 5044958c-151d-4995-bed4-dd05c1385b48 8ada3e65-e377-4435-a709-fbe75dfa1dd0 d714a175-db12-4574-8f27-aa071a1dfd8a","title":"kms-keys"},{"location":"command-reference/#kms-key-create","text":"Create a KMS Key $ kms-key-create 9e94333b-8e85-497a-9791-e7c5edf9c35e","title":"kms-key-create"},{"location":"command-reference/#kms-key-details","text":"List details for KMS Key(s)","title":"kms-key-details"},{"location":"command-reference/#kms-key-disable","text":"Disable KMS Key(s) USAGE: kms-key-disable key_id [key_id] $ kms-key-disable 9e94333b-8e85-497a-9791-e7c5edf9c35e","title":"kms-key-disable"},{"location":"command-reference/#kms-key-enable","text":"Enable KMS Key(s) USAGE: kms-key-enable key_id [key_id] $ kms-key-enable 9e94333b-8e85-497a-9791-e7c5edf9c35e","title":"kms-key-enable"},{"location":"command-reference/#lambda-commands","text":"","title":"lambda-commands"},{"location":"command-reference/#lambda-functions","text":"List lambda functions $ lambda-functions stars 2019-12-18T10:00:00.000+0000 python2.7 256 stripes 2019-12-19T10:21:42.444+0000 python3.7 128","title":"lambda-functions"},{"location":"command-reference/#lambda-function-memory","text":"List memorySize for lambda function(s) USAGE: lambda-function-memory function [function]","title":"lambda-function-memory"},{"location":"command-reference/#lambda-function-memory-set","text":"Update memorySize for lambda function(s) USAGE: lambda-function-memory-set memory function [function]","title":"lambda-function-memory-set"},{"location":"command-reference/#lambda-function-memory-step","text":"Repeatedly update memorySize for lambda function(s) Useful for measuring impact of memory on cost/performance. The function increases memorySize by 64KB every two minutes until it reaches the value requested. There is a two minute delay between increases to provide time to collect data from function execution. USAGE: lambda-function-memory-step memory function [function]","title":"lambda-function-memory-step"},{"location":"command-reference/#log-commands","text":"","title":"log-commands"},{"location":"command-reference/#log-groups","text":"List CloudWatch Log Groups $ log-groups /aws/lambda/stars2 1576495961429 0 11736 /aws/lambda/stars 1576566745961 0 107460 /aws/lambda/walk 1576567300172 0 11794","title":"log-groups"},{"location":"command-reference/#rds-commands","text":"","title":"rds-commands"},{"location":"command-reference/#rds-db-instances","text":"List RDS Database Instances","title":"rds-db-instances"},{"location":"command-reference/#route53-commands","text":"","title":"route53-commands"},{"location":"command-reference/#hosted-zones","text":"List Route53 Hosted Zones $ hosted-zones /hostedzone/Z3333333333333 5 NotPrivateZone bash-my-aws.org. /hostedzone/Z5555555555555 2 NotPrivateZone bash-my-universe.com. /hostedzone/Z4444444444444 3 NotPrivateZone bashmyaws.org. /hostedzone/Z1111111111111 3 NotPrivateZone bash-my-aws.com. /hostedzone/Z2222222222222 3 NotPrivateZone bashmyaws.com.","title":"hosted-zones"},{"location":"command-reference/#hosted-zone-ns-records","text":"Generate NS records for delegating domain to AWS $ hosted-zones bash-my-aws.org /hostedzone/ZJ6ZCG2UD6OKX 5 NotPrivateZone bash-my-aws.org. $ hosted-zones bash-my-aws.org | hosted-zone-ns-records bash-my-aws.org. 300 IN NS ns-786.awsdns-34.net. bash-my-aws.org. 300 IN NS ns-1549.awsdns-01.co.uk. bash-my-aws.org. 300 IN NS ns-362.awsdns-45.com. bash-my-aws.org. 300 IN NS ns-1464.awsdns-55.org.","title":"hosted-zone-ns-records"},{"location":"command-reference/#s3-commands","text":"","title":"s3-commands"},{"location":"command-reference/#buckets","text":"List S3 Buckets $ buckets web-assets 2019-12-20 08:24:38.182045 backups 2019-12-20 08:24:44.351215 archive 2019-12-20 08:24:57.567652","title":"buckets"},{"location":"command-reference/#bucket-acls","text":"List S3 Bucket Access Control Lists. $ bucket-acls another-example-bucket another-example-bucket Note The only recommended use case for the bucket ACL is to grant write permission to the Amazon S3 Log Delivery group to write access log objects to your bucket. AWS docs","title":"bucket-acls"},{"location":"command-reference/#bucket-remove","text":"Remove an empty S3 Bucket. In this example the bucket is not empty. $ bucket-remove another-example-bucket You are about to remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y remove_bucket failed: s3://another-example-bucket An error occurred (BucketNotEmpty) when calling the DeleteBucket operation: The bucket you tried to delete is not empty","title":"bucket-remove"},{"location":"command-reference/#bucket-remove-force","text":"Remove an S3 Bucket, and delete all objects if it's not empty. $ bucket-remove-force another-example-bucket You are about to delete all objects from and remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y delete: s3://another-example-bucket/aliases remove_bucket: another-example-bucket","title":"bucket-remove-force"},{"location":"command-reference/#sts-commands","text":"","title":"sts-commands"},{"location":"command-reference/#sts-assume-role","text":"Assume an IAM Role USAGE: sts-assume-role role_arn","title":"sts-assume-role"},{"location":"command-reference/#vpc-commands","text":"","title":"vpc-commands"},{"location":"command-reference/#pcxs","text":"List VPC Peering connections","title":"pcxs"},{"location":"command-reference/#subnets","text":"List subnets for all VPCs $ subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME","title":"subnets"},{"location":"command-reference/#vpcs","text":"List VPCs $ vpcs vpc-018d9739 default-vpc NO_NAME 172.31.0.0/16 NO_STACK NO_VERSION","title":"vpcs"},{"location":"command-reference/#vpc-azs","text":"List availability zones of VPC(s) USAGE: vpc-azs vpc-id [vpc-id] $ vpcs | vpc-azs vpc-018d9739 ap-southeast-2a ap-southeast-2b ap-southeast-2c","title":"vpc-azs"},{"location":"command-reference/#vpc-az-count","text":"List number of Availability Zones of VPC(s) USAGE: vpc-az-count vpc-id [vpc-id] $ vpcs | vpc-az-count vpc-018d9739 3","title":"vpc-az-count"},{"location":"command-reference/#vpc-lambda-functions","text":"List lambda functions of VPC(s) USAGE: vpc-lambda-functions vpc-id [vpc-id]","title":"vpc-lambda-functions"},{"location":"command-reference/#vpc-dhcp-options-ntp","text":"List NTP servers of VPC(s) USAGE: vpc-dhcp-options-ntp vpc-id [vpc-id]","title":"vpc-dhcp-options-ntp"},{"location":"command-reference/#vpc-endpoints","text":"List VPC Endpoints of VPC(s) USAGE: vpc-endpoints vpc-id [vpc-id]","title":"vpc-endpoints"},{"location":"command-reference/#vpc-endpoint-services","text":"List available VPC endpoint services USAGE: vpc-endpoint-services vpc-id [vpc-id]","title":"vpc-endpoint-services"},{"location":"command-reference/#vpc-igw","text":"List Internet Gateway of VPC(s) USAGE: vpc-igw vpc-id [vpc-id]","title":"vpc-igw"},{"location":"command-reference/#vpc-route-tables","text":"List Route Tables of VPC(s) USAGE: vpc-route-tables vpc-id [vpc-id] $ vpcs | vpc-route-tables rtb-8e841c39 vpc-018d9739 NO_NAME","title":"vpc-route-tables"},{"location":"command-reference/#vpc-nat-gateways","text":"List NAT Gateways of VPC(s) USAGE: vpc-nat-gateways vpc-id [vpc-id]","title":"vpc-nat-gateways"},{"location":"command-reference/#vpc-subnets","text":"List subnets of VPC(s) USAGE: vpc-subnets vpc-id [vpc-id] $ vpcs | vpc-subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME","title":"vpc-subnets"},{"location":"command-reference/#vpc-network-acls","text":"List Network ACLs of VPC(s) USAGE: vpc-network-acls vpc-id [vpc-id] $ vpcs | vpc-network-acls acl-ff4914d1 vpc-018d9739","title":"vpc-network-acls"},{"location":"command-reference/#vpc-rds","text":"List RDS instances of VPC(s) USAGE: vpc-rds vpc-id [vpc-id]","title":"vpc-rds"},{"location":"command-reference/#vpc-default-delete","text":"Print commands you would need to run to delete that pesky default VPC Exclude default VPCs that contain: - instances - lambda functions $ vpc-default-delete # Deleting default VPC vpc-018d9739 in ap-southeast-2 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-8bb774fe aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-9eea2c07 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-34fd9cfa aws --region ap-southeast-2 ec2 delete-vpc --vpc-id=vpc-018d9739","title":"vpc-default-delete"},{"location":"developer-guide/","text":"bash-my-aws development guide. \u00b6 There are three distinct classes of functions types within bash-my-aws ; query , detail , and action functions. Query functions are responsible for requesting AWS return a list of resources by their unique identifier. That would mean that when querying EC2 instances, it should return a list of instance-ids. If we were to query CloudFormation, then stacks are what would be returned. Detail functions should provide you an output of one or more attributes. eg. instance-asg(), instance-state() Action functions should perform an action against a resource. An action for an EC2 instance may be something like terminate or associate_eip . e.g. stack-create(), instance-terminate(), asg-suspend() There are some great things about bash-my-aws which I would hate to lose. It's easy to look at the code and learn how awscli works. Simple tasks have simple commands. It's really easy to extend. stdin should always be supported. You should be able to pipe one function into the next with ease. If an action function cannot be piped the output of a query function and have it work, without manipulation though other tools, then something is wrong. Namespacing \u00b6 We've decided to namespace functions by the resource they're concerned with. Yes, this may seem a bit like postgres naming their command createdb but that's OK. bash-my-aws reduces my keystrokes. We'll work something out if this becomes a problem. stack-asgs stack-elbs stack-outputs stack-tags stack-validate stack-create stack-events stack-parameters stack-tail stacks stack-delete stack-failure stack-resources stack-template stack-diff stack-instances stack-status stack-update instance-asg instance-ssh instance-stop instance-volumes instance-console instance-ssh-details instance-tags instances instance-dns instance-stack instance-terminate instance-iam-profile instance-start instance-type instance-ip instance-state instance-userdata asg-capacity asg-max-size-set asg-resume asgs asg-desired-size-set asg-min-size-set asg-suspend asg-instances asg-processes_suspended asgard Resources \u00b6 This is a partial list of resources, with possible alternative names in brackets. asg (autoscaling_group) bucket elb (load_balancer) instance instance_type rds (relational_database) dynamodb (relational_database) sg (security_group) stack (cloudformation_stack) Query Functions \u00b6 Query functions are always namespaced under the plural of the resource. Default Query \u00b6 TODO: lets talk about the details. Some example usage of this function would be: $ <resources> resource_id1 attribute attribute resource_id2 attribute attribute resource_id3 attribute attribute Detail Functions \u00b6 Detail functions are always namespaced under the singular of the resource. Some example usage of this function would be: $ <resource> <resource_id> attribute1: value1 attribute2: value2 Some example responses: $ instance_security_groups i-abcd1234 sg-00000001 i-abcd1234 sg-00000002 i-abcd1234 sg-00000003 i-abcd1234 sg-00000004 i-abcd1234 $ security_group_rules TODO: I'm not sure yet how to present a security group rule. $ instance_type i-abcd1234 c3.large i-abcd1234 $ instance_type_memory c3.large 3.75 c3.large Action Functions \u00b6 Action functions are always namespaced under the singular of the resource and are suffixed with the action they are responsible for undertaking. Some example usage of this function would be: $ <resource>_<action> <resource_id> Tests \u00b6 You can start the test suite by running the command make test . STDIN \u00b6 The first word of each line must be a resource. Additional information will be disregarded.","title":"bash-my-aws development guide."},{"location":"developer-guide/#bash-my-aws-development-guide","text":"There are three distinct classes of functions types within bash-my-aws ; query , detail , and action functions. Query functions are responsible for requesting AWS return a list of resources by their unique identifier. That would mean that when querying EC2 instances, it should return a list of instance-ids. If we were to query CloudFormation, then stacks are what would be returned. Detail functions should provide you an output of one or more attributes. eg. instance-asg(), instance-state() Action functions should perform an action against a resource. An action for an EC2 instance may be something like terminate or associate_eip . e.g. stack-create(), instance-terminate(), asg-suspend() There are some great things about bash-my-aws which I would hate to lose. It's easy to look at the code and learn how awscli works. Simple tasks have simple commands. It's really easy to extend. stdin should always be supported. You should be able to pipe one function into the next with ease. If an action function cannot be piped the output of a query function and have it work, without manipulation though other tools, then something is wrong.","title":"bash-my-aws development guide."},{"location":"developer-guide/#namespacing","text":"We've decided to namespace functions by the resource they're concerned with. Yes, this may seem a bit like postgres naming their command createdb but that's OK. bash-my-aws reduces my keystrokes. We'll work something out if this becomes a problem. stack-asgs stack-elbs stack-outputs stack-tags stack-validate stack-create stack-events stack-parameters stack-tail stacks stack-delete stack-failure stack-resources stack-template stack-diff stack-instances stack-status stack-update instance-asg instance-ssh instance-stop instance-volumes instance-console instance-ssh-details instance-tags instances instance-dns instance-stack instance-terminate instance-iam-profile instance-start instance-type instance-ip instance-state instance-userdata asg-capacity asg-max-size-set asg-resume asgs asg-desired-size-set asg-min-size-set asg-suspend asg-instances asg-processes_suspended asgard","title":"Namespacing"},{"location":"developer-guide/#resources","text":"This is a partial list of resources, with possible alternative names in brackets. asg (autoscaling_group) bucket elb (load_balancer) instance instance_type rds (relational_database) dynamodb (relational_database) sg (security_group) stack (cloudformation_stack)","title":"Resources"},{"location":"developer-guide/#query-functions","text":"Query functions are always namespaced under the plural of the resource.","title":"Query Functions"},{"location":"developer-guide/#default-query","text":"TODO: lets talk about the details. Some example usage of this function would be: $ <resources> resource_id1 attribute attribute resource_id2 attribute attribute resource_id3 attribute attribute","title":"Default Query"},{"location":"developer-guide/#detail-functions","text":"Detail functions are always namespaced under the singular of the resource. Some example usage of this function would be: $ <resource> <resource_id> attribute1: value1 attribute2: value2 Some example responses: $ instance_security_groups i-abcd1234 sg-00000001 i-abcd1234 sg-00000002 i-abcd1234 sg-00000003 i-abcd1234 sg-00000004 i-abcd1234 $ security_group_rules TODO: I'm not sure yet how to present a security group rule. $ instance_type i-abcd1234 c3.large i-abcd1234 $ instance_type_memory c3.large 3.75 c3.large","title":"Detail Functions"},{"location":"developer-guide/#action-functions","text":"Action functions are always namespaced under the singular of the resource and are suffixed with the action they are responsible for undertaking. Some example usage of this function would be: $ <resource>_<action> <resource_id>","title":"Action Functions"},{"location":"developer-guide/#tests","text":"You can start the test suite by running the command make test .","title":"Tests"},{"location":"developer-guide/#stdin","text":"The first word of each line must be a resource. Additional information will be disregarded.","title":"STDIN"},{"location":"extracted/","text":"aws-account-commands \u00b6 aws-account-alias \u00b6 Retrieve AWS Account Alias for current account $ aws-account-alias example-account-prod aws-account-id \u00b6 Retrieve AWS Account ID for current account $ aws-account-id 012345678901 aws-account-each \u00b6 Run a script/command across a number of AWS Accounts USAGE: aws-account-each cmd # pipe in AWS_ACCOUNT_IDS $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED # account=012345678901 alias=example-account-prod example-stack1-prod CREATED_FAILED example-stack2-prod UPDATE_ROLLBACK_FAILED # account=123456789012 alias=example-account-staging example-stack1-staging CREATED_FAILED example-stack2-staging UPDATE_ROLLBACK_FAILED Note In order to use aws-account-each , you need to be authenticated with an IAM Role that can assume a Role in each of the specified accounts. Check the source for more info. aws-panopticon \u00b6 aws-panopticon was previous name for aws-account-each() aws-account-cost-explorer \u00b6 Use with an AWS Organisations Master Account to open multiple accounts in Cost Explorer. $ grep demo AWS_ACCOUNTS | aws-account-cost-explorer #=> Opens web browser to AWS Cost Explorer with accounts selected aws-account-cost-recommendations \u00b6 Use with an AWS Organisations Master Account to open multiple accounts in Cost Recommendations. $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED #=> Opens web browser to AWS Cost Recommendations with accounts selected cert-commands \u00b6 certs \u00b6 List ACM Certificates certs-arn \u00b6 Same as certs but with the ARN in first column cert-users \u00b6 List resources using ACM Cert(s) USAGE: cert-users cert-arn [cert-arn] cert-delete \u00b6 Delete ACM Cert(s) USAGE: cert-delete cert-arn [cert-arn] cloudtrail-commands \u00b6 cloudtrails \u00b6 List Cloudtrails $ cloudtrails failmode failmode-cloudtrail ap-southeast-2 IsMultiRegionTrail=true IncludeGlobalServiceEvents=true cloudtrail-status \u00b6 List logging status of Cloudtrails USAGE: cloudtrail-status cloudtrail [cloudtrail] ecr-commands \u00b6 ecr-repositories \u00b6 List ECR Repositories ecr-repository-images \u00b6 List images for ECR Repositories elb-commands \u00b6 elbs \u00b6 List ELBs Accepts LoadBalancer names or ARNS on STDIN and converts to LoadBalancer names $ elbs elb-MyLoadBalancer-1FNISWJN0W6N9 2019-12-13T10:24:55.220Z subnet-eff2cf88 another-e-MyLoadBa-171CPCZF2E84T 2019-12-13T10:25:24.300Z subnet-eff2cf88 elb-dnsname \u00b6 List DNS Names of ELB(s) USAGE: elb-dnsname load-balancer [load-balancer] $ elbs | elb-dnsname elb-MyLoadBalancer-1FNISWJN0W6N9 elb-MyLoadBalancer-1FNISWJN0W6N9-563832045.ap-southeast-2.elb.amazonaws.com another-e-MyLoadBa-171CPCZF2E84T another-e-MyLoadBa-171CPCZF2E84T-1832721930.ap-southeast-2.elb.amazonaws.com elb-instances \u00b6 List instances of ELB(s) USAGE: elb-instances load-balancer [load-balancer] elb-stack \u00b6 List CloudFormation stack names of ELB(s) USAGE: elb-stack load-balancer [load-balancer] $ elbs | elb-stack elb elb-MyLoadBalancer-1FNISWJN0W6N9 another-elb another-e-MyLoadBa-171CPCZF2E84T iam-commands \u00b6 iam-roles \u00b6 List IAM Roles $ iam-roles config-role-ap-southeast-2 AROAI3QHAU3J2CDRNLQHD 2017-02-02T03:03:02Z AWSBatchServiceRole AROAJJWRGUPTRXTV52TED 2017-03-09T05:31:39Z ecsInstanceRole AROAJFQ3WMZXESGIKW5YD 2017-03-09T05:31:39Z iam-role-principal \u00b6 List role principal for IAM Role(s) USAGE: iam-role-principal role-name [role-name] image-commands \u00b6 images \u00b6 List EC2 AMI's Usage: images [owner] [image-id] [image-id]... owner defaults to self or can one or more of: an AWS_ACCOUNT_ID (e.g. 1234567890) an AWS_OWNER_ALIAS (amazon, amazon-marketplace, microsoft) image_id can be one or more AMIs Trialing a different approach for grabbing resource ids from input. As normal, you can pipe resource ids in as first token on each line. We treat all args that don't start with ami- as owner identifiers. Trialing a new pattern for output - putting the Name at the end. This is more like the output of ls -la Pro: Preceding fields tend to be of the same length Pro: Easier for eyes to scan final column for names(?) Con: Using this pattern for instances() would put name past 80 char point Con: Migrating instances() to this output is A Big Change (not made lightly) image-deregister \u00b6 Deregister AMI(s) USAGE: image-deregister image_id [image_id] instance-commands \u00b6 instances \u00b6 List EC2 Instances $ instances i-4e15ece1de1a3f869 ami-123456789012 t3.nano running nagios 2019-12-10T08:17:18.000Z ap-southeast-2a None i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None i-61e86ac6be1e2c193 ami-123456789012 t3.nano running prometheus-web 2019-12-10T08:17:24.000Z ap-southeast-2a None Optionally provide a filter string for a | grep effect with tighter columisation: $ instances postgres i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None instance-asg \u00b6 List autoscaling group membership of EC2 Instance(s) USAGE: instance-asg instance-id [instance-id] instance-az \u00b6 List availability zone of EC2 Instance(s) USAGE: instance-az instance-id [instance-id] $ instances postgres | instance-az i-89cefa9403373d7a5 ap-southeast-2a i-806d8f1592e2a2efd ap-southeast-2a instance-console \u00b6 List console output of EC2 Instance(s) USAGE: instance-console instance-id [instance-id] $ instances postgres | instance-console Console output for EC2 Instance i-89cefa9403373d7a5 Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip... Console output for EC2 Instance i-806d8f1592e2a2efd Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip... instance-dns \u00b6 List DNS name of EC2 Instance(s) USAGE: instance-dns instance-id [instance-id] $ instances postgres | instance-dns i-89cefa9403373d7a5 ip-10-155-35-61.ap-southeast-2.compute.internal ec2-54-214-206-114.ap-southeast-2.compute.amazonaws.com i-806d8f1592e2a2efd ip-10-178-243-63.ap-southeast-2.compute.internal ec2-54-214-244-90.ap-southeast-2.compute.amazonaws.com instance-health-set-unhealthy \u00b6 Mark EC2 Instance(s) as unhealthy (to trigger replacement by ASG) USAGE: instance-health-set-unhealthy instance-id [instance-id] instance-iam-profile \u00b6 List iam-profile of EC2 Instance(s) USAGE: instance-iam-profile instance-id [instance-id] instance-ip \u00b6 List ip address of EC2 Instance(s) USAGE: instance-ip instance-id [instance-id] $ instances postgres | instance-ip i-89cefa9403373d7a5 10.155.35.61 54.214.206.114 i-806d8f1592e2a2efd 10.178.243.63 54.214.244.90 instance-ssh \u00b6 Establish SSH connection to EC2 Instance(s) USAGE: instance-ssh [login] [instance-id] [instance-id] instance-ssh-details \u00b6 List details needed to SSH into EC2 Instance(s) USAGE: instance-ssh-details [login] [instance-id] [instance-id] instance-stack \u00b6 List CloudFormation stack EC2 Instance(s) belong to (if any) USAGE: instance-stack instance-id [instance-id] $ instances postgres | instance-stack postgres1 i-89cefa9403373d7a5 postgres2 i-806d8f1592e2a2efd instance-start \u00b6 Start stopped EC2 Instance(s) USAGE: instance-start instance-id [instance-id] $ instances postgres | instance-start i-a8b8dd6783e1a40cc PreviousState=stopped CurrentState=pending i-5d74753e210bfe04d PreviousState=stopped CurrentState=pending instance-state \u00b6 List state of EC2 Instance(s) USAGE: instance-state instance-id [instance-id] $ instances postgres | instance-state i-89cefa9403373d7a5 running i-806d8f1592e2a2efd running instance-stop \u00b6 Stop EC2 Instance(s) USAGE: instance-stop instance-id [instance-id] $ instances postgres | instance-stop i-a8b8dd6783e1a40cc PreviousState=running CurrentState=stopping i-5d74753e210bfe04d PreviousState=running CurrentState=stopping instance-tags \u00b6 List tags applied EC2 Instance(s) USAGE: instance-tags instance-id [instance-id] instance-terminate \u00b6 Terminate EC2 Instance(s) USAGE: instance-terminate instance-id [instance-id] $ instances | head -3 | instance-terminate You are about to terminate the following instances: i-01c7edb986c18c16a ami-0119aa4d67e59007c t3.nano terminated asg2 2019-12-13T03:37:51.000Z ap-southeast-2c None i-012dded46894dfa04 ami-0119aa4d67e59007c t3.nano running ec2 2019-12-13T10:12:55.000Z ap-southeast-2b vpc-deb8edb9 Are you sure you want to continue? y i-06ee900565652ecc5 PreviousState=terminated CurrentState=terminated i-01c7edb986c18c16a PreviousState=terminated CurrentState=terminated i-012dded46894dfa04 PreviousState=running CurrentState=shutting-down instance-termination-protection \u00b6 List current state of Termination Protection for EC2 Instance(s) USAGE: instance-termination-protection instance-id [instance-id] $ instances | instance-termination-protection i-4e15ece1de1a3f869 DisableApiTermination=true i-89cefa9403373d7a5 DisableApiTermination=false i-806d8f1592e2a2efd DisableApiTermination=false i-61e86ac6be1e2c193 DisableApiTermination=false instance-termination-protection-disable \u00b6 Disable EC2 Instance termination protection USAGE: instance-termination-protection-disable instance-id [instance-id] instance-termination-protection-enable \u00b6 Enable EC2 Instance termination protection USAGE: instance-termination-protection-enable instance-id [instance-id] instance-type \u00b6 List type of instance(s) USAGE: instance-type instance-id [instance-id] $ instances | instance-type i-4e15ece1de1a3f869 t3.nano i-89cefa9403373d7a5 t3.nano i-806d8f1592e2a2efd t3.nano i-61e86ac6be1e2c193 t3.nano instance-userdata \u00b6 List userdata for instance(s) USAGE: instance-userdata instance-id [instance-id] instance-volumes \u00b6 List volumes of instance(s) USAGE: instance-volumes instance-id [instance-id] $ instances postgres | instance-volumes i-89cefa9403373d7a5 vol-cf5ddae9 i-806d8f1592e2a2efd vol-38fd45c3 instance-vpc \u00b6 List VPC of instance(s) USAGE: instance-vpcs instance-id [instance-id] keypair-commands \u00b6 keypairs \u00b6 List EC2 SSH Keypairs in current Region $ keypairs alice 8f:85:9a:1e:6c:76:29:34:37:45:de:7f:8d:f9:70:eb bob 56:73:29:c2:ad:7b:6f:b6:f2:f3:b4:de:e4:2b:12:d4 keypair-create \u00b6 Create SSH Keypair on local machine and import public key into new EC2 Keypair. Provides benefits over AWS creating the keypair: Amazon never has access to private key. Private key is protected with passphrase before being written to disk. Keys is written to ~/.ssh with correct file permissions. You control the SSH Key type (algorithm, length, etc). USAGE: keypair-delete key_name [key_name] $ keypair-create yet-another-keypair Creating /home/m/.ssh/yet-another-keypair Generating public/private rsa key pair. Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/m/.ssh/yet-another-keypair. Your public key has been saved in /home/m/.ssh/yet-another-keypair.pub. The key fingerprint is: SHA256:zIpbxLo7rpQvKyezOLATk96B1kSL0QP41q6x8tUrySk m@localhost.localdomain The key's randomart image is: +---[RSA 4096]----+ |..o | |.. + | | .+.o | | .oo.. o | | o+. o S | |=o.+.= . | |+++==o+ | |XoE+*+ . | |o@+**+. | +----[SHA256]-----+ { \"KeyFingerprint\": \"21:82:f9:5b:79:d6:dc:0f:7b:79:43:7c:c5:34:6c:2d\", \"KeyName\": \"yet-another-keypair\" } Note KeyPair Name defaults to \"$(aws-account-alias)-$(region)\" if none provided keypair-delete \u00b6 Delete EC2 SSH Keypairs by providing their names as arguments or via STDIN USAGE: keypair-delete key_name [key_name] $ keypair-delete alice bob You are about to delete the following EC2 SSH KeyPairs: alice bob Are you sure you want to continue? y $ keypairs | keypair-delete You are about to delete the following EC2 SSH KeyPairs: yet-another-keypair Are you sure you want to continue? y kms-commands \u00b6 kms-encrypt \u00b6 Encrypt and base64 encode STDIN or file USAGE: kms-encrypt key_id/alias_id [plaintext_file] $ echo foobar | kms-encrypt alias/default AQICAHgcyN4vd3V/OB7NKI6IMbpENEu1+UfyiU... kms-decrypt \u00b6 base64 decode and decrypt KMS Encrypted file or STDIN USAGE: kms-decrypt [ciphertext_file] $ kms-decrypt ciphertext.txt foobar $ echo foobar | kms-encrypt alias/default | kms-decrypt foobar kms-aliases \u00b6 List KMS Aliases $ kms-aliases default alias/default d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/default kms-alias-create \u00b6 Create alias for KMS Key USAGE: kms-alias-create alias_name key_id $ kms-keys | tail -1 d714a175-db12-4574-8f27-aa071a1dfd8a $ kms-keys | tail -1 | kms-alias-create alias/foobar $ kms-aliases foobar alias/foobar d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/foobar kms-alias-delete \u00b6 Delete alias for KMS Key USAGE: kms-alias-delete alias_name [alias_name] $ kms-aliases foobar | kms-alias-delete You are about to delete the following kms aliases: alias/foobar Are you sure you want to continue? y kms-keys \u00b6 List KMS Keys $ kms-keys 5044958c-151d-4995-bed4-dd05c1385b48 8ada3e65-e377-4435-a709-fbe75dfa1dd0 d714a175-db12-4574-8f27-aa071a1dfd8a kms-key-create \u00b6 Create a KMS Key $ kms-key-create 9e94333b-8e85-497a-9791-e7c5edf9c35e kms-key-details \u00b6 List details for KMS Key(s) kms-key-disable \u00b6 Disable KMS Key(s) USAGE: kms-key-disable key_id [key_id] $ kms-key-disable 9e94333b-8e85-497a-9791-e7c5edf9c35e kms-key-enable \u00b6 Enable KMS Key(s) USAGE: kms-key-enable key_id [key_id] $ kms-key-enable 9e94333b-8e85-497a-9791-e7c5edf9c35e lambda-commands \u00b6 lambda-functions \u00b6 List lambda functions $ lambda-functions stars 2019-12-18T10:00:00.000+0000 python2.7 256 stripes 2019-12-19T10:21:42.444+0000 python3.7 128 lambda-function-memory \u00b6 List memorySize for lambda function(s) USAGE: lambda-function-memory function [function] lambda-function-memory-set \u00b6 Update memorySize for lambda function(s) USAGE: lambda-function-memory-set memory function [function] lambda-function-memory-step \u00b6 Repeatedly update memorySize for lambda function(s) Useful for measuring impact of memory on cost/performance. The function increases memorySize by 64KB every two minutes until it reaches the value requested. There is a two minute delay between increases to provide time to collect data from function execution. USAGE: lambda-function-memory-step memory function [function] log-commands \u00b6 log-groups \u00b6 List CloudWatch Log Groups $ log-groups /aws/lambda/stars2 1576495961429 0 11736 /aws/lambda/stars 1576566745961 0 107460 /aws/lambda/walk 1576567300172 0 11794 rds-commands \u00b6 rds-db-instances \u00b6 List RDS Database Instances region-commands \u00b6 regions \u00b6 List regions The region() function must be sourced in order to update the AWS_DEFAULT_REGION environment variable. This is because it cannot update an environment variable when run as a subprocess. $ regions ap-northeast-1 ap-northeast-2 ap-south-1 ap-southeast-1 ap-southeast-2 ... us-west-2 region \u00b6 Get/Set $AWS_DEFAULT_REGION shell environment variable $ region us-east-1 $ region ap-southeast-2 $ region ap-southeast-2 region-each \u00b6 Run a command in every region. Any output lines will be appended with \"#${REGION}\". $ region-each stacks | column -t example-ec2-ap-northeast-1 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-1 example-ec2-ap-northeast-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-2 ... example-ec2-us-west-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #us-west-2 route53-commands \u00b6 hosted-zones \u00b6 List Route53 Hosted Zones $ hosted-zones /hostedzone/Z3333333333333 5 NotPrivateZone bash-my-aws.org. /hostedzone/Z5555555555555 2 NotPrivateZone bash-my-universe.com. /hostedzone/Z4444444444444 3 NotPrivateZone bashmyaws.org. /hostedzone/Z1111111111111 3 NotPrivateZone bash-my-aws.com. /hostedzone/Z2222222222222 3 NotPrivateZone bashmyaws.com. hosted-zone-ns-records \u00b6 Generate NS records for delegating domain to AWS $ hosted-zones bash-my-aws.org /hostedzone/ZJ6ZCG2UD6OKX 5 NotPrivateZone bash-my-aws.org. $ hosted-zones bash-my-aws.org | hosted-zone-ns-records bash-my-aws.org. 300 IN NS ns-786.awsdns-34.net. bash-my-aws.org. 300 IN NS ns-1549.awsdns-01.co.uk. bash-my-aws.org. 300 IN NS ns-362.awsdns-45.com. bash-my-aws.org. 300 IN NS ns-1464.awsdns-55.org. s3-commands \u00b6 buckets \u00b6 List S3 Buckets $ buckets web-assets 2019-12-20 08:24:38.182045 backups 2019-12-20 08:24:44.351215 archive 2019-12-20 08:24:57.567652 bucket-acls \u00b6 List S3 Bucket Access Control Lists. $ bucket-acls another-example-bucket another-example-bucket Note The only recommended use case for the bucket ACL is to grant write permission to the Amazon S3 Log Delivery group to write access log objects to your bucket. AWS docs bucket-remove \u00b6 Remove an empty S3 Bucket. In this example the bucket is not empty. $ bucket-remove another-example-bucket You are about to remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y remove_bucket failed: s3://another-example-bucket An error occurred (BucketNotEmpty) when calling the DeleteBucket operation: The bucket you tried to delete is not empty bucket-remove-force \u00b6 Remove an S3 Bucket, and delete all objects if it's not empty. $ bucket-remove-force another-example-bucket You are about to delete all objects from and remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y delete: s3://another-example-bucket/aliases remove_bucket: another-example-bucket stack-commands \u00b6 stacks \u00b6 stack-arn \u00b6 stack-cancel-update \u00b6 stack-create \u00b6 stack-update \u00b6 stack-delete \u00b6 delete an existing stack stack-exports \u00b6 stack-recreate \u00b6 rm -fr $tmpdir stack-failure \u00b6 type: detail return the reason a stack failed to update/create/delete FIXME: only grab the latest failure stack-events \u00b6 type: detail return the events a stack has experienced stack-resources \u00b6 stack-asgs \u00b6 type: detail return the autoscaling groups managed by a stack stack-asg-instances \u00b6 stack-elbs \u00b6 return the elastic load balancers managed by stack(s) stack-instances \u00b6 return the instances managed by stack(s) stack-parameters \u00b6 return the parameters applied to a stack stack-status \u00b6 type: detail return the current status of a stack stack-tag \u00b6 return a selected stack tag stack-tag-apply \u00b6 apply a stack tag stack-tag-delete \u00b6 delete a stack tag stack-tail \u00b6 type: detail follow the events occuring for a stack stack-template \u00b6 return the template applied to a stack stack-tags \u00b6 return the stack-tags applied to a stack stack-tags-text \u00b6 return all stack tags on a single line stack-outputs \u00b6 type: detail return the outputs of a stack stack-validate \u00b6 type: detail validate a stack template stack-diff \u00b6 type: detail return differences between a template and Stack report changes which would be made to stack if template were applied report on what changes would be made to stack by applying params If we are working from a single argument (ignore args starting with -- ) Strip path and extension from template Deduce params filename from stack and template names Strip path and extension from template File extension gets stripped off if template name provided as stack name Determine name of template to use determine name of params file to use determine what (if any) capabilities a given stack was deployed with sts-commands \u00b6 sts-assume-role \u00b6 Assume an IAM Role USAGE: sts-assume-role role_arn vpc-commands \u00b6 pcxs \u00b6 List VPC Peering connections subnets \u00b6 List subnets for all VPCs $ subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME vpcs \u00b6 List VPCs $ vpcs vpc-018d9739 default-vpc NO_NAME 172.31.0.0/16 NO_STACK NO_VERSION vpc-azs \u00b6 List availability zones of VPC(s) USAGE: vpc-azs vpc-id [vpc-id] $ vpcs | vpc-azs vpc-018d9739 ap-southeast-2a ap-southeast-2b ap-southeast-2c vpc-az-count \u00b6 List number of Availability Zones of VPC(s) USAGE: vpc-az-count vpc-id [vpc-id] $ vpcs | vpc-az-count vpc-018d9739 3 vpc-lambda-functions \u00b6 List lambda functions of VPC(s) USAGE: vpc-lambda-functions vpc-id [vpc-id] vpc-dhcp-options-ntp \u00b6 List NTP servers of VPC(s) USAGE: vpc-dhcp-options-ntp vpc-id [vpc-id] vpc-endpoints \u00b6 List VPC Endpoints of VPC(s) USAGE: vpc-endpoints vpc-id [vpc-id] vpc-endpoint-services \u00b6 List available VPC endpoint services USAGE: vpc-endpoint-services vpc-id [vpc-id] vpc-igw \u00b6 List Internet Gateway of VPC(s) USAGE: vpc-igw vpc-id [vpc-id] vpc-route-tables \u00b6 List Route Tables of VPC(s) USAGE: vpc-route-tables vpc-id [vpc-id] $ vpcs | vpc-route-tables rtb-8e841c39 vpc-018d9739 NO_NAME vpc-nat-gateways \u00b6 List NAT Gateways of VPC(s) USAGE: vpc-nat-gateways vpc-id [vpc-id] vpc-subnets \u00b6 List subnets of VPC(s) USAGE: vpc-subnets vpc-id [vpc-id] $ vpcs | vpc-subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME vpc-network-acls \u00b6 List Network ACLs of VPC(s) USAGE: vpc-network-acls vpc-id [vpc-id] $ vpcs | vpc-network-acls acl-ff4914d1 vpc-018d9739 vpc-rds \u00b6 List RDS instances of VPC(s) USAGE: vpc-rds vpc-id [vpc-id] vpc-default-delete \u00b6 Print commands you would need to run to delete that pesky default VPC Exclude default VPCs that contain: - instances - lambda functions $ vpc-default-delete # Deleting default VPC vpc-018d9739 in ap-southeast-2 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-8bb774fe aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-9eea2c07 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-34fd9cfa aws --region ap-southeast-2 ec2 delete-vpc --vpc-id=vpc-018d9739","title":"Extracted"},{"location":"extracted/#aws-account-commands","text":"","title":"aws-account-commands"},{"location":"extracted/#aws-account-alias","text":"Retrieve AWS Account Alias for current account $ aws-account-alias example-account-prod","title":"aws-account-alias"},{"location":"extracted/#aws-account-id","text":"Retrieve AWS Account ID for current account $ aws-account-id 012345678901","title":"aws-account-id"},{"location":"extracted/#aws-account-each","text":"Run a script/command across a number of AWS Accounts USAGE: aws-account-each cmd # pipe in AWS_ACCOUNT_IDS $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED # account=012345678901 alias=example-account-prod example-stack1-prod CREATED_FAILED example-stack2-prod UPDATE_ROLLBACK_FAILED # account=123456789012 alias=example-account-staging example-stack1-staging CREATED_FAILED example-stack2-staging UPDATE_ROLLBACK_FAILED Note In order to use aws-account-each , you need to be authenticated with an IAM Role that can assume a Role in each of the specified accounts. Check the source for more info.","title":"aws-account-each"},{"location":"extracted/#aws-panopticon","text":"aws-panopticon was previous name for aws-account-each()","title":"aws-panopticon"},{"location":"extracted/#aws-account-cost-explorer","text":"Use with an AWS Organisations Master Account to open multiple accounts in Cost Explorer. $ grep demo AWS_ACCOUNTS | aws-account-cost-explorer #=> Opens web browser to AWS Cost Explorer with accounts selected","title":"aws-account-cost-explorer"},{"location":"extracted/#aws-account-cost-recommendations","text":"Use with an AWS Organisations Master Account to open multiple accounts in Cost Recommendations. $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED #=> Opens web browser to AWS Cost Recommendations with accounts selected","title":"aws-account-cost-recommendations"},{"location":"extracted/#cert-commands","text":"","title":"cert-commands"},{"location":"extracted/#certs","text":"List ACM Certificates","title":"certs"},{"location":"extracted/#certs-arn","text":"Same as certs but with the ARN in first column","title":"certs-arn"},{"location":"extracted/#cert-users","text":"List resources using ACM Cert(s) USAGE: cert-users cert-arn [cert-arn]","title":"cert-users"},{"location":"extracted/#cert-delete","text":"Delete ACM Cert(s) USAGE: cert-delete cert-arn [cert-arn]","title":"cert-delete"},{"location":"extracted/#cloudtrail-commands","text":"","title":"cloudtrail-commands"},{"location":"extracted/#cloudtrails","text":"List Cloudtrails $ cloudtrails failmode failmode-cloudtrail ap-southeast-2 IsMultiRegionTrail=true IncludeGlobalServiceEvents=true","title":"cloudtrails"},{"location":"extracted/#cloudtrail-status","text":"List logging status of Cloudtrails USAGE: cloudtrail-status cloudtrail [cloudtrail]","title":"cloudtrail-status"},{"location":"extracted/#ecr-commands","text":"","title":"ecr-commands"},{"location":"extracted/#ecr-repositories","text":"List ECR Repositories","title":"ecr-repositories"},{"location":"extracted/#ecr-repository-images","text":"List images for ECR Repositories","title":"ecr-repository-images"},{"location":"extracted/#elb-commands","text":"","title":"elb-commands"},{"location":"extracted/#elbs","text":"List ELBs Accepts LoadBalancer names or ARNS on STDIN and converts to LoadBalancer names $ elbs elb-MyLoadBalancer-1FNISWJN0W6N9 2019-12-13T10:24:55.220Z subnet-eff2cf88 another-e-MyLoadBa-171CPCZF2E84T 2019-12-13T10:25:24.300Z subnet-eff2cf88","title":"elbs"},{"location":"extracted/#elb-dnsname","text":"List DNS Names of ELB(s) USAGE: elb-dnsname load-balancer [load-balancer] $ elbs | elb-dnsname elb-MyLoadBalancer-1FNISWJN0W6N9 elb-MyLoadBalancer-1FNISWJN0W6N9-563832045.ap-southeast-2.elb.amazonaws.com another-e-MyLoadBa-171CPCZF2E84T another-e-MyLoadBa-171CPCZF2E84T-1832721930.ap-southeast-2.elb.amazonaws.com","title":"elb-dnsname"},{"location":"extracted/#elb-instances","text":"List instances of ELB(s) USAGE: elb-instances load-balancer [load-balancer]","title":"elb-instances"},{"location":"extracted/#elb-stack","text":"List CloudFormation stack names of ELB(s) USAGE: elb-stack load-balancer [load-balancer] $ elbs | elb-stack elb elb-MyLoadBalancer-1FNISWJN0W6N9 another-elb another-e-MyLoadBa-171CPCZF2E84T","title":"elb-stack"},{"location":"extracted/#iam-commands","text":"","title":"iam-commands"},{"location":"extracted/#iam-roles","text":"List IAM Roles $ iam-roles config-role-ap-southeast-2 AROAI3QHAU3J2CDRNLQHD 2017-02-02T03:03:02Z AWSBatchServiceRole AROAJJWRGUPTRXTV52TED 2017-03-09T05:31:39Z ecsInstanceRole AROAJFQ3WMZXESGIKW5YD 2017-03-09T05:31:39Z","title":"iam-roles"},{"location":"extracted/#iam-role-principal","text":"List role principal for IAM Role(s) USAGE: iam-role-principal role-name [role-name]","title":"iam-role-principal"},{"location":"extracted/#image-commands","text":"","title":"image-commands"},{"location":"extracted/#images","text":"List EC2 AMI's Usage: images [owner] [image-id] [image-id]... owner defaults to self or can one or more of: an AWS_ACCOUNT_ID (e.g. 1234567890) an AWS_OWNER_ALIAS (amazon, amazon-marketplace, microsoft) image_id can be one or more AMIs Trialing a different approach for grabbing resource ids from input. As normal, you can pipe resource ids in as first token on each line. We treat all args that don't start with ami- as owner identifiers. Trialing a new pattern for output - putting the Name at the end. This is more like the output of ls -la Pro: Preceding fields tend to be of the same length Pro: Easier for eyes to scan final column for names(?) Con: Using this pattern for instances() would put name past 80 char point Con: Migrating instances() to this output is A Big Change (not made lightly)","title":"images"},{"location":"extracted/#image-deregister","text":"Deregister AMI(s) USAGE: image-deregister image_id [image_id]","title":"image-deregister"},{"location":"extracted/#instance-commands","text":"","title":"instance-commands"},{"location":"extracted/#instances","text":"List EC2 Instances $ instances i-4e15ece1de1a3f869 ami-123456789012 t3.nano running nagios 2019-12-10T08:17:18.000Z ap-southeast-2a None i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None i-61e86ac6be1e2c193 ami-123456789012 t3.nano running prometheus-web 2019-12-10T08:17:24.000Z ap-southeast-2a None Optionally provide a filter string for a | grep effect with tighter columisation: $ instances postgres i-89cefa9403373d7a5 ami-123456789012 t3.nano running postgres1 2019-12-10T08:17:20.000Z ap-southeast-2a None i-806d8f1592e2a2efd ami-123456789012 t3.nano running postgres2 2019-12-10T08:17:22.000Z ap-southeast-2a None","title":"instances"},{"location":"extracted/#instance-asg","text":"List autoscaling group membership of EC2 Instance(s) USAGE: instance-asg instance-id [instance-id]","title":"instance-asg"},{"location":"extracted/#instance-az","text":"List availability zone of EC2 Instance(s) USAGE: instance-az instance-id [instance-id] $ instances postgres | instance-az i-89cefa9403373d7a5 ap-southeast-2a i-806d8f1592e2a2efd ap-southeast-2a","title":"instance-az"},{"location":"extracted/#instance-console","text":"List console output of EC2 Instance(s) USAGE: instance-console instance-id [instance-id] $ instances postgres | instance-console Console output for EC2 Instance i-89cefa9403373d7a5 Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip... Console output for EC2 Instance i-806d8f1592e2a2efd Linux version 2.6.16-xenU (builder@patchbat.amazonsa) (gcc version 4.0.1 20050727 (Red Hat 4.0.1-5)) #1 SMP Thu Oct 26 08:41:26 SAST 2006 BIOS-provided physical RAM map: Xen: 0000000000000000 - 000000006a400000 (usable) ...snip...","title":"instance-console"},{"location":"extracted/#instance-dns","text":"List DNS name of EC2 Instance(s) USAGE: instance-dns instance-id [instance-id] $ instances postgres | instance-dns i-89cefa9403373d7a5 ip-10-155-35-61.ap-southeast-2.compute.internal ec2-54-214-206-114.ap-southeast-2.compute.amazonaws.com i-806d8f1592e2a2efd ip-10-178-243-63.ap-southeast-2.compute.internal ec2-54-214-244-90.ap-southeast-2.compute.amazonaws.com","title":"instance-dns"},{"location":"extracted/#instance-health-set-unhealthy","text":"Mark EC2 Instance(s) as unhealthy (to trigger replacement by ASG) USAGE: instance-health-set-unhealthy instance-id [instance-id]","title":"instance-health-set-unhealthy"},{"location":"extracted/#instance-iam-profile","text":"List iam-profile of EC2 Instance(s) USAGE: instance-iam-profile instance-id [instance-id]","title":"instance-iam-profile"},{"location":"extracted/#instance-ip","text":"List ip address of EC2 Instance(s) USAGE: instance-ip instance-id [instance-id] $ instances postgres | instance-ip i-89cefa9403373d7a5 10.155.35.61 54.214.206.114 i-806d8f1592e2a2efd 10.178.243.63 54.214.244.90","title":"instance-ip"},{"location":"extracted/#instance-ssh","text":"Establish SSH connection to EC2 Instance(s) USAGE: instance-ssh [login] [instance-id] [instance-id]","title":"instance-ssh"},{"location":"extracted/#instance-ssh-details","text":"List details needed to SSH into EC2 Instance(s) USAGE: instance-ssh-details [login] [instance-id] [instance-id]","title":"instance-ssh-details"},{"location":"extracted/#instance-stack","text":"List CloudFormation stack EC2 Instance(s) belong to (if any) USAGE: instance-stack instance-id [instance-id] $ instances postgres | instance-stack postgres1 i-89cefa9403373d7a5 postgres2 i-806d8f1592e2a2efd","title":"instance-stack"},{"location":"extracted/#instance-start","text":"Start stopped EC2 Instance(s) USAGE: instance-start instance-id [instance-id] $ instances postgres | instance-start i-a8b8dd6783e1a40cc PreviousState=stopped CurrentState=pending i-5d74753e210bfe04d PreviousState=stopped CurrentState=pending","title":"instance-start"},{"location":"extracted/#instance-state","text":"List state of EC2 Instance(s) USAGE: instance-state instance-id [instance-id] $ instances postgres | instance-state i-89cefa9403373d7a5 running i-806d8f1592e2a2efd running","title":"instance-state"},{"location":"extracted/#instance-stop","text":"Stop EC2 Instance(s) USAGE: instance-stop instance-id [instance-id] $ instances postgres | instance-stop i-a8b8dd6783e1a40cc PreviousState=running CurrentState=stopping i-5d74753e210bfe04d PreviousState=running CurrentState=stopping","title":"instance-stop"},{"location":"extracted/#instance-tags","text":"List tags applied EC2 Instance(s) USAGE: instance-tags instance-id [instance-id]","title":"instance-tags"},{"location":"extracted/#instance-terminate","text":"Terminate EC2 Instance(s) USAGE: instance-terminate instance-id [instance-id] $ instances | head -3 | instance-terminate You are about to terminate the following instances: i-01c7edb986c18c16a ami-0119aa4d67e59007c t3.nano terminated asg2 2019-12-13T03:37:51.000Z ap-southeast-2c None i-012dded46894dfa04 ami-0119aa4d67e59007c t3.nano running ec2 2019-12-13T10:12:55.000Z ap-southeast-2b vpc-deb8edb9 Are you sure you want to continue? y i-06ee900565652ecc5 PreviousState=terminated CurrentState=terminated i-01c7edb986c18c16a PreviousState=terminated CurrentState=terminated i-012dded46894dfa04 PreviousState=running CurrentState=shutting-down","title":"instance-terminate"},{"location":"extracted/#instance-termination-protection","text":"List current state of Termination Protection for EC2 Instance(s) USAGE: instance-termination-protection instance-id [instance-id] $ instances | instance-termination-protection i-4e15ece1de1a3f869 DisableApiTermination=true i-89cefa9403373d7a5 DisableApiTermination=false i-806d8f1592e2a2efd DisableApiTermination=false i-61e86ac6be1e2c193 DisableApiTermination=false","title":"instance-termination-protection"},{"location":"extracted/#instance-termination-protection-disable","text":"Disable EC2 Instance termination protection USAGE: instance-termination-protection-disable instance-id [instance-id]","title":"instance-termination-protection-disable"},{"location":"extracted/#instance-termination-protection-enable","text":"Enable EC2 Instance termination protection USAGE: instance-termination-protection-enable instance-id [instance-id]","title":"instance-termination-protection-enable"},{"location":"extracted/#instance-type","text":"List type of instance(s) USAGE: instance-type instance-id [instance-id] $ instances | instance-type i-4e15ece1de1a3f869 t3.nano i-89cefa9403373d7a5 t3.nano i-806d8f1592e2a2efd t3.nano i-61e86ac6be1e2c193 t3.nano","title":"instance-type"},{"location":"extracted/#instance-userdata","text":"List userdata for instance(s) USAGE: instance-userdata instance-id [instance-id]","title":"instance-userdata"},{"location":"extracted/#instance-volumes","text":"List volumes of instance(s) USAGE: instance-volumes instance-id [instance-id] $ instances postgres | instance-volumes i-89cefa9403373d7a5 vol-cf5ddae9 i-806d8f1592e2a2efd vol-38fd45c3","title":"instance-volumes"},{"location":"extracted/#instance-vpc","text":"List VPC of instance(s) USAGE: instance-vpcs instance-id [instance-id]","title":"instance-vpc"},{"location":"extracted/#keypair-commands","text":"","title":"keypair-commands"},{"location":"extracted/#keypairs","text":"List EC2 SSH Keypairs in current Region $ keypairs alice 8f:85:9a:1e:6c:76:29:34:37:45:de:7f:8d:f9:70:eb bob 56:73:29:c2:ad:7b:6f:b6:f2:f3:b4:de:e4:2b:12:d4","title":"keypairs"},{"location":"extracted/#keypair-create","text":"Create SSH Keypair on local machine and import public key into new EC2 Keypair. Provides benefits over AWS creating the keypair: Amazon never has access to private key. Private key is protected with passphrase before being written to disk. Keys is written to ~/.ssh with correct file permissions. You control the SSH Key type (algorithm, length, etc). USAGE: keypair-delete key_name [key_name] $ keypair-create yet-another-keypair Creating /home/m/.ssh/yet-another-keypair Generating public/private rsa key pair. Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/m/.ssh/yet-another-keypair. Your public key has been saved in /home/m/.ssh/yet-another-keypair.pub. The key fingerprint is: SHA256:zIpbxLo7rpQvKyezOLATk96B1kSL0QP41q6x8tUrySk m@localhost.localdomain The key's randomart image is: +---[RSA 4096]----+ |..o | |.. + | | .+.o | | .oo.. o | | o+. o S | |=o.+.= . | |+++==o+ | |XoE+*+ . | |o@+**+. | +----[SHA256]-----+ { \"KeyFingerprint\": \"21:82:f9:5b:79:d6:dc:0f:7b:79:43:7c:c5:34:6c:2d\", \"KeyName\": \"yet-another-keypair\" } Note KeyPair Name defaults to \"$(aws-account-alias)-$(region)\" if none provided","title":"keypair-create"},{"location":"extracted/#keypair-delete","text":"Delete EC2 SSH Keypairs by providing their names as arguments or via STDIN USAGE: keypair-delete key_name [key_name] $ keypair-delete alice bob You are about to delete the following EC2 SSH KeyPairs: alice bob Are you sure you want to continue? y $ keypairs | keypair-delete You are about to delete the following EC2 SSH KeyPairs: yet-another-keypair Are you sure you want to continue? y","title":"keypair-delete"},{"location":"extracted/#kms-commands","text":"","title":"kms-commands"},{"location":"extracted/#kms-encrypt","text":"Encrypt and base64 encode STDIN or file USAGE: kms-encrypt key_id/alias_id [plaintext_file] $ echo foobar | kms-encrypt alias/default AQICAHgcyN4vd3V/OB7NKI6IMbpENEu1+UfyiU...","title":"kms-encrypt"},{"location":"extracted/#kms-decrypt","text":"base64 decode and decrypt KMS Encrypted file or STDIN USAGE: kms-decrypt [ciphertext_file] $ kms-decrypt ciphertext.txt foobar $ echo foobar | kms-encrypt alias/default | kms-decrypt foobar","title":"kms-decrypt"},{"location":"extracted/#kms-aliases","text":"List KMS Aliases $ kms-aliases default alias/default d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/default","title":"kms-aliases"},{"location":"extracted/#kms-alias-create","text":"Create alias for KMS Key USAGE: kms-alias-create alias_name key_id $ kms-keys | tail -1 d714a175-db12-4574-8f27-aa071a1dfd8a $ kms-keys | tail -1 | kms-alias-create alias/foobar $ kms-aliases foobar alias/foobar d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/foobar","title":"kms-alias-create"},{"location":"extracted/#kms-alias-delete","text":"Delete alias for KMS Key USAGE: kms-alias-delete alias_name [alias_name] $ kms-aliases foobar | kms-alias-delete You are about to delete the following kms aliases: alias/foobar Are you sure you want to continue? y","title":"kms-alias-delete"},{"location":"extracted/#kms-keys","text":"List KMS Keys $ kms-keys 5044958c-151d-4995-bed4-dd05c1385b48 8ada3e65-e377-4435-a709-fbe75dfa1dd0 d714a175-db12-4574-8f27-aa071a1dfd8a","title":"kms-keys"},{"location":"extracted/#kms-key-create","text":"Create a KMS Key $ kms-key-create 9e94333b-8e85-497a-9791-e7c5edf9c35e","title":"kms-key-create"},{"location":"extracted/#kms-key-details","text":"List details for KMS Key(s)","title":"kms-key-details"},{"location":"extracted/#kms-key-disable","text":"Disable KMS Key(s) USAGE: kms-key-disable key_id [key_id] $ kms-key-disable 9e94333b-8e85-497a-9791-e7c5edf9c35e","title":"kms-key-disable"},{"location":"extracted/#kms-key-enable","text":"Enable KMS Key(s) USAGE: kms-key-enable key_id [key_id] $ kms-key-enable 9e94333b-8e85-497a-9791-e7c5edf9c35e","title":"kms-key-enable"},{"location":"extracted/#lambda-commands","text":"","title":"lambda-commands"},{"location":"extracted/#lambda-functions","text":"List lambda functions $ lambda-functions stars 2019-12-18T10:00:00.000+0000 python2.7 256 stripes 2019-12-19T10:21:42.444+0000 python3.7 128","title":"lambda-functions"},{"location":"extracted/#lambda-function-memory","text":"List memorySize for lambda function(s) USAGE: lambda-function-memory function [function]","title":"lambda-function-memory"},{"location":"extracted/#lambda-function-memory-set","text":"Update memorySize for lambda function(s) USAGE: lambda-function-memory-set memory function [function]","title":"lambda-function-memory-set"},{"location":"extracted/#lambda-function-memory-step","text":"Repeatedly update memorySize for lambda function(s) Useful for measuring impact of memory on cost/performance. The function increases memorySize by 64KB every two minutes until it reaches the value requested. There is a two minute delay between increases to provide time to collect data from function execution. USAGE: lambda-function-memory-step memory function [function]","title":"lambda-function-memory-step"},{"location":"extracted/#log-commands","text":"","title":"log-commands"},{"location":"extracted/#log-groups","text":"List CloudWatch Log Groups $ log-groups /aws/lambda/stars2 1576495961429 0 11736 /aws/lambda/stars 1576566745961 0 107460 /aws/lambda/walk 1576567300172 0 11794","title":"log-groups"},{"location":"extracted/#rds-commands","text":"","title":"rds-commands"},{"location":"extracted/#rds-db-instances","text":"List RDS Database Instances","title":"rds-db-instances"},{"location":"extracted/#region-commands","text":"","title":"region-commands"},{"location":"extracted/#regions","text":"List regions The region() function must be sourced in order to update the AWS_DEFAULT_REGION environment variable. This is because it cannot update an environment variable when run as a subprocess. $ regions ap-northeast-1 ap-northeast-2 ap-south-1 ap-southeast-1 ap-southeast-2 ... us-west-2","title":"regions"},{"location":"extracted/#region","text":"Get/Set $AWS_DEFAULT_REGION shell environment variable $ region us-east-1 $ region ap-southeast-2 $ region ap-southeast-2","title":"region"},{"location":"extracted/#region-each","text":"Run a command in every region. Any output lines will be appended with \"#${REGION}\". $ region-each stacks | column -t example-ec2-ap-northeast-1 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-1 example-ec2-ap-northeast-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-2 ... example-ec2-us-west-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #us-west-2","title":"region-each"},{"location":"extracted/#route53-commands","text":"","title":"route53-commands"},{"location":"extracted/#hosted-zones","text":"List Route53 Hosted Zones $ hosted-zones /hostedzone/Z3333333333333 5 NotPrivateZone bash-my-aws.org. /hostedzone/Z5555555555555 2 NotPrivateZone bash-my-universe.com. /hostedzone/Z4444444444444 3 NotPrivateZone bashmyaws.org. /hostedzone/Z1111111111111 3 NotPrivateZone bash-my-aws.com. /hostedzone/Z2222222222222 3 NotPrivateZone bashmyaws.com.","title":"hosted-zones"},{"location":"extracted/#hosted-zone-ns-records","text":"Generate NS records for delegating domain to AWS $ hosted-zones bash-my-aws.org /hostedzone/ZJ6ZCG2UD6OKX 5 NotPrivateZone bash-my-aws.org. $ hosted-zones bash-my-aws.org | hosted-zone-ns-records bash-my-aws.org. 300 IN NS ns-786.awsdns-34.net. bash-my-aws.org. 300 IN NS ns-1549.awsdns-01.co.uk. bash-my-aws.org. 300 IN NS ns-362.awsdns-45.com. bash-my-aws.org. 300 IN NS ns-1464.awsdns-55.org.","title":"hosted-zone-ns-records"},{"location":"extracted/#s3-commands","text":"","title":"s3-commands"},{"location":"extracted/#buckets","text":"List S3 Buckets $ buckets web-assets 2019-12-20 08:24:38.182045 backups 2019-12-20 08:24:44.351215 archive 2019-12-20 08:24:57.567652","title":"buckets"},{"location":"extracted/#bucket-acls","text":"List S3 Bucket Access Control Lists. $ bucket-acls another-example-bucket another-example-bucket Note The only recommended use case for the bucket ACL is to grant write permission to the Amazon S3 Log Delivery group to write access log objects to your bucket. AWS docs","title":"bucket-acls"},{"location":"extracted/#bucket-remove","text":"Remove an empty S3 Bucket. In this example the bucket is not empty. $ bucket-remove another-example-bucket You are about to remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y remove_bucket failed: s3://another-example-bucket An error occurred (BucketNotEmpty) when calling the DeleteBucket operation: The bucket you tried to delete is not empty","title":"bucket-remove"},{"location":"extracted/#bucket-remove-force","text":"Remove an S3 Bucket, and delete all objects if it's not empty. $ bucket-remove-force another-example-bucket You are about to delete all objects from and remove the following buckets: another-example-bucket 2019-12-07 06:51:12.022496 Are you sure you want to continue? y delete: s3://another-example-bucket/aliases remove_bucket: another-example-bucket","title":"bucket-remove-force"},{"location":"extracted/#stack-commands","text":"","title":"stack-commands"},{"location":"extracted/#stacks","text":"","title":"stacks"},{"location":"extracted/#stack-arn","text":"","title":"stack-arn"},{"location":"extracted/#stack-cancel-update","text":"","title":"stack-cancel-update"},{"location":"extracted/#stack-create","text":"","title":"stack-create"},{"location":"extracted/#stack-update","text":"","title":"stack-update"},{"location":"extracted/#stack-delete","text":"delete an existing stack","title":"stack-delete"},{"location":"extracted/#stack-exports","text":"","title":"stack-exports"},{"location":"extracted/#stack-recreate","text":"rm -fr $tmpdir","title":"stack-recreate"},{"location":"extracted/#stack-failure","text":"type: detail return the reason a stack failed to update/create/delete FIXME: only grab the latest failure","title":"stack-failure"},{"location":"extracted/#stack-events","text":"type: detail return the events a stack has experienced","title":"stack-events"},{"location":"extracted/#stack-resources","text":"","title":"stack-resources"},{"location":"extracted/#stack-asgs","text":"type: detail return the autoscaling groups managed by a stack","title":"stack-asgs"},{"location":"extracted/#stack-asg-instances","text":"","title":"stack-asg-instances"},{"location":"extracted/#stack-elbs","text":"return the elastic load balancers managed by stack(s)","title":"stack-elbs"},{"location":"extracted/#stack-instances","text":"return the instances managed by stack(s)","title":"stack-instances"},{"location":"extracted/#stack-parameters","text":"return the parameters applied to a stack","title":"stack-parameters"},{"location":"extracted/#stack-status","text":"type: detail return the current status of a stack","title":"stack-status"},{"location":"extracted/#stack-tag","text":"return a selected stack tag","title":"stack-tag"},{"location":"extracted/#stack-tag-apply","text":"apply a stack tag","title":"stack-tag-apply"},{"location":"extracted/#stack-tag-delete","text":"delete a stack tag","title":"stack-tag-delete"},{"location":"extracted/#stack-tail","text":"type: detail follow the events occuring for a stack","title":"stack-tail"},{"location":"extracted/#stack-template","text":"return the template applied to a stack","title":"stack-template"},{"location":"extracted/#stack-tags","text":"return the stack-tags applied to a stack","title":"stack-tags"},{"location":"extracted/#stack-tags-text","text":"return all stack tags on a single line","title":"stack-tags-text"},{"location":"extracted/#stack-outputs","text":"type: detail return the outputs of a stack","title":"stack-outputs"},{"location":"extracted/#stack-validate","text":"type: detail validate a stack template","title":"stack-validate"},{"location":"extracted/#stack-diff","text":"type: detail return differences between a template and Stack report changes which would be made to stack if template were applied report on what changes would be made to stack by applying params If we are working from a single argument (ignore args starting with -- ) Strip path and extension from template Deduce params filename from stack and template names Strip path and extension from template File extension gets stripped off if template name provided as stack name Determine name of template to use determine name of params file to use determine what (if any) capabilities a given stack was deployed with","title":"stack-diff"},{"location":"extracted/#sts-commands","text":"","title":"sts-commands"},{"location":"extracted/#sts-assume-role","text":"Assume an IAM Role USAGE: sts-assume-role role_arn","title":"sts-assume-role"},{"location":"extracted/#vpc-commands","text":"","title":"vpc-commands"},{"location":"extracted/#pcxs","text":"List VPC Peering connections","title":"pcxs"},{"location":"extracted/#subnets","text":"List subnets for all VPCs $ subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME","title":"subnets"},{"location":"extracted/#vpcs","text":"List VPCs $ vpcs vpc-018d9739 default-vpc NO_NAME 172.31.0.0/16 NO_STACK NO_VERSION","title":"vpcs"},{"location":"extracted/#vpc-azs","text":"List availability zones of VPC(s) USAGE: vpc-azs vpc-id [vpc-id] $ vpcs | vpc-azs vpc-018d9739 ap-southeast-2a ap-southeast-2b ap-southeast-2c","title":"vpc-azs"},{"location":"extracted/#vpc-az-count","text":"List number of Availability Zones of VPC(s) USAGE: vpc-az-count vpc-id [vpc-id] $ vpcs | vpc-az-count vpc-018d9739 3","title":"vpc-az-count"},{"location":"extracted/#vpc-lambda-functions","text":"List lambda functions of VPC(s) USAGE: vpc-lambda-functions vpc-id [vpc-id]","title":"vpc-lambda-functions"},{"location":"extracted/#vpc-dhcp-options-ntp","text":"List NTP servers of VPC(s) USAGE: vpc-dhcp-options-ntp vpc-id [vpc-id]","title":"vpc-dhcp-options-ntp"},{"location":"extracted/#vpc-endpoints","text":"List VPC Endpoints of VPC(s) USAGE: vpc-endpoints vpc-id [vpc-id]","title":"vpc-endpoints"},{"location":"extracted/#vpc-endpoint-services","text":"List available VPC endpoint services USAGE: vpc-endpoint-services vpc-id [vpc-id]","title":"vpc-endpoint-services"},{"location":"extracted/#vpc-igw","text":"List Internet Gateway of VPC(s) USAGE: vpc-igw vpc-id [vpc-id]","title":"vpc-igw"},{"location":"extracted/#vpc-route-tables","text":"List Route Tables of VPC(s) USAGE: vpc-route-tables vpc-id [vpc-id] $ vpcs | vpc-route-tables rtb-8e841c39 vpc-018d9739 NO_NAME","title":"vpc-route-tables"},{"location":"extracted/#vpc-nat-gateways","text":"List NAT Gateways of VPC(s) USAGE: vpc-nat-gateways vpc-id [vpc-id]","title":"vpc-nat-gateways"},{"location":"extracted/#vpc-subnets","text":"List subnets of VPC(s) USAGE: vpc-subnets vpc-id [vpc-id] $ vpcs | vpc-subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME","title":"vpc-subnets"},{"location":"extracted/#vpc-network-acls","text":"List Network ACLs of VPC(s) USAGE: vpc-network-acls vpc-id [vpc-id] $ vpcs | vpc-network-acls acl-ff4914d1 vpc-018d9739","title":"vpc-network-acls"},{"location":"extracted/#vpc-rds","text":"List RDS instances of VPC(s) USAGE: vpc-rds vpc-id [vpc-id]","title":"vpc-rds"},{"location":"extracted/#vpc-default-delete","text":"Print commands you would need to run to delete that pesky default VPC Exclude default VPCs that contain: - instances - lambda functions $ vpc-default-delete # Deleting default VPC vpc-018d9739 in ap-southeast-2 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-8bb774fe aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-9eea2c07 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-34fd9cfa aws --region ap-southeast-2 ec2 delete-vpc --vpc-id=vpc-018d9739","title":"vpc-default-delete"},{"location":"style/","text":"bash-my-aws style guide \u00b6 Always quote \"$variables\" Only use parentheses around variables when not surrounded with whitespace (better way to phrase this?) use $(date) rather than \" date \" use [[ and ]] rather than [ , ] , or test show errors with __bma_error() show usage options with __bma_usage() parse inputs with __bma_read_inputs() regenerate and test the bash_completion script after adding new functions","title":"Style"},{"location":"style/#bash-my-aws-style-guide","text":"Always quote \"$variables\" Only use parentheses around variables when not surrounded with whitespace (better way to phrase this?) use $(date) rather than \" date \" use [[ and ]] rather than [ , ] , or test show errors with __bma_error() show usage options with __bma_usage() parse inputs with __bma_read_inputs() regenerate and test the bash_completion script after adding new functions","title":"bash-my-aws style guide"},{"location":"test/","text":"asg-commands \u00b6 asgs \u00b6 List EC2 Autoscaling Groups asg-capacity \u00b6 List min, desired and maximum capacities of EC2 Autoscaling Group(s) asg-desired-size-set \u00b6 Set desired capacity of autoscaling group(s) asg-instances \u00b6 List instances of autoscaling group(s) asg-launch-configuration \u00b6 List Launch Configurations of Autoscaling Group(s) launch-configurations \u00b6 List Launch Configurations launch-configuration-asgs \u00b6 List EC2 Autoscaling Groups of Launch COnfiguration(s) asg-max-size-set \u00b6 Set maximum size of autoscaling group(s) asg-min-size-set \u00b6 Set minimum size of autoscaling group(s) asg-processes_suspended \u00b6 List suspended processes of an autoscaling group asg-resume \u00b6 Resume all processes of an autoscaling group asg-suspend \u00b6 Suspend all processes of an autoscaling group asg-stack \u00b6 List CloudFormation stack for asg(s) asg-scaling-activities \u00b6 List scaling activities for Autoscaling Group(s) aws-account-commands \u00b6 aws-account-alias \u00b6 Retrieve AWS Account Alias for current account $ aws-account-alias example-account-prod aws-account-id \u00b6 Retrieve AWS Account ID for current account $ aws-account-id 012345678901 aws-account-each \u00b6 Run a script/command across a number of AWS Accounts $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED # account=012345678901 alias=example-account-prod example-stack1-prod CREATED_FAILED example-stack2-prod UPDATE_ROLLBACK_FAILED # account=123456789012 alias=example-account-staging example-stack1-staging CREATED_FAILED example-stack2-staging UPDATE_ROLLBACK_FAILED Note In order to use aws-account-each , you need to be authenticated with an IAM Role that can assume a Role in each of the specified accounts. Check the source for more info. aws-panopticon \u00b6 aws-panopticon was previous name for aws-account-each() aws-account-cost-explorer \u00b6 Use with an AWS Organisations Master Account to open multiple accounts in Cost Explorer. $ grep demo AWS_ACCOUNTS | aws-account-cost-explorer #=> Opens web browser to AWS Cost Explorer with accounts selected aws-account-cost-recommendations \u00b6 Use with an AWS Organisations Master Account to open multiple accounts in Cost Recommendations. $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED #=> Opens web browser to AWS Cost Recommendations with accounts selected cert-commands \u00b6 certs \u00b6 List ACM Certificates certs-arn \u00b6 Same as certs but with the ARN in first column cert-users \u00b6 List resources using ACM Cert(s) cert-delete \u00b6 Delete ACM Cert(s) cloudtrail-commands \u00b6 cloudtrails \u00b6 List Cloudtrails cloudtrail-status \u00b6 List logging status of Cloudtrails ecr-commands \u00b6 ecr-repositories \u00b6 List ECR Repositories ecr-repository-images \u00b6 List images for ECR Repositories elb-commands \u00b6 elbs \u00b6 List ELBs Accepts LoadBalancer names or ARNS on STDIN and converts to LoadBalancer names $ elbs elb-MyLoadBalancer-1FNISWJN0W6N9 2019-12-13T10:24:55.220Z subnet-eff2cf88 another-e-MyLoadBa-171CPCZF2E84T 2019-12-13T10:25:24.300Z subnet-eff2cf88 elb-dnsname \u00b6 List DNS Names of ELB(s) USAGE: elb-dnsname load-balancer [load-balancer] $ elbs | elb-dnsname elb-MyLoadBalancer-1FNISWJN0W6N9 elb-MyLoadBalancer-1FNISWJN0W6N9-563832045.ap-southeast-2.elb.amazonaws.com another-e-MyLoadBa-171CPCZF2E84T another-e-MyLoadBa-171CPCZF2E84T-1832721930.ap-southeast-2.elb.amazonaws.com elb-instances \u00b6 List instances of ELB(s) elb-stack \u00b6 List CloudFormation stack names of ELB(s) USAGE: elb-stack load-balancer [load-balancer] $ elbs | elb-stack elb elb-MyLoadBalancer-1FNISWJN0W6N9 another-elb another-e-MyLoadBa-171CPCZF2E84T iam-commands \u00b6 iam-roles \u00b6 List IAM Roles iam-role-principal \u00b6 List role principal for IAM Role(s) image-commands \u00b6 images \u00b6 List EC2 AMI's Usage: images [owner] [image-id] [image-id]... owner defaults to self or can one or more of: an AWS_ACCOUNT_ID (e.g. 1234567890) an AWS_OWNER_ALIAS (amazon, amazon-marketplace, microsoft) image_id can be one or more AMIs Trialing a different approach for grabbing resource ids from input. As normal, you can pipe resource ids in as first token on each line. We treat all args that don't start with ami- as owner identifiers. Trialing a new pattern for output - putting the Name at the end. This is more like the output of ls -la Pro: Preceding fields tend to be of the same length Pro: Easier for eyes to scan final column for names(?) Con: Using this pattern for instances() would put name past 80 char point Con: Migrating instances() to this output is A Big Change (not made lightly) image-deregister \u00b6 Deregister AMI instance-commands \u00b6 instances \u00b6 instance-asg \u00b6 returns the autoscaling group instance is member of instance-az \u00b6 returns the availability zone of an instance instance-console \u00b6 return console output of instance instance-dns \u00b6 returns the dns name of an instance instance-health-set-unhealthy \u00b6 instance-iam-profile \u00b6 returns the iam-profile of an instance instance-ip \u00b6 returns the ip address of an instance instance-ssh \u00b6 connects to an instance via SSH instance-ssh-details \u00b6 returns the details needed to SSH into an instance instance-stack \u00b6 returns the stack an instances is a member of instance-start \u00b6 starts a stopped instance instance-state \u00b6 returns the state of an instance instance-stop \u00b6 stops a running instance \u00b6 instances_with_tag() # instance_tags | grep expiry= \u00b6 instances_without_tag() # instance_tags | grep -v expiry= instance-tags \u00b6 returns the tags applied instances instance-terminate \u00b6 instance-termination-protection \u00b6 instance-termination-protection-disable \u00b6 instance-termination-protection-enable \u00b6 instance-type \u00b6 returns the type of an instance instance-userdata \u00b6 returns userdata for instance instance-volumes \u00b6 returns the volumes of an instance instance-vpc \u00b6 returns the vpc of an instance keypair-commands \u00b6 keypairs \u00b6 List EC2 SSH Keypairs in current Region $ keypairs alice 8f:85:9a:1e:6c:76:29:34:37:45:de:7f:8d:f9:70:eb bob 56:73:29:c2:ad:7b:6f:b6:f2:f3:b4:de:e4:2b:12:d4 keypair-create \u00b6 Create SSH Keypair on local machine and import public key into new EC2 Keypair. Provides benefits over AWS creating the keypair: Amazon never has access to private key Private key is protected with passphrase before being written to disk Keys is written to ~/.ssh with correct file permissions You control the SSH Key type (algorithm, length, etc) $ keypair-create yet-another-keypair Creating /home/m/.ssh/yet-another-keypair Generating public/private rsa key pair. Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/m/.ssh/yet-another-keypair. Your public key has been saved in /home/m/.ssh/yet-another-keypair.pub. The key fingerprint is: SHA256:zIpbxLo7rpQvKyezOLATk96B1kSL0QP41q6x8tUrySk m@localhost.localdomain The key's randomart image is: +---[RSA 4096]----+ |..o | |.. + | | .+.o | | .oo.. o | | o+. o S | |=o.+.= . | |+++==o+ | |XoE+ + . | |o@+ *+. | +----[SHA256]-----+ { \"KeyFingerprint\": \"21:82:f9:5b:79:d6:dc:0f:7b:79:43:7c:c5:34:6c:2d\", \"KeyName\": \"yet-another-keypair\" } Note KeyPair Name defaults to \"$(aws-account-alias)-$(region)\" if none provided keypair-delete \u00b6 Delete EC2 SSH Keypairs by providing their names as arguments or via STDIN $ keypair-delete alice bob You are about to delete the following EC2 SSH KeyPairs: alice bob Are you sure you want to continue? y $ keypairs | keypair-delete You are about to delete the following EC2 SSH KeyPairs: yet-another-keypair Are you sure you want to continue? y kms-commands \u00b6 kms-encrypt \u00b6 Encrypt and base64 encode STDIN or file $ echo foobar | kms-encrypt alias/default AQICAHgcyN4vd3V/OB7NKI6IMbpENEu1+UfyiU... kms-decrypt \u00b6 base64 decode and decrypt KMS Encrypted file or STDIN $ kms-decrypt ciphertext.txt foobar $ echo foobar | kms-encrypt alias/default | kms-decrypt foobar kms-aliases \u00b6 List KMS Aliases $ kms-aliases default alias/default d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/default kms-alias-create \u00b6 Create alias for KMS Key $ kms-keys | tail -1 d714a175-db12-4574-8f27-aa071a1dfd8a $ kms-keys | tail -1 | kms-alias-create alias/foobar $ kms-aliases foobar alias/foobar d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/foobar kms-alias-delete \u00b6 Delete alias for KMS Key $ kms-aliases foobar | kms-alias-delete You are about to delete the following kms aliases: alias/foobar Are you sure you want to continue? y kms-keys \u00b6 List KMS Keys $ kms-keys 5044958c-151d-4995-bed4-dd05c1385b48 8ada3e65-e377-4435-a709-fbe75dfa1dd0 d714a175-db12-4574-8f27-aa071a1dfd8a kms-key-create \u00b6 Create a KMS Key $ kms-key-create 9e94333b-8e85-497a-9791-e7c5edf9c35e kms-key-details \u00b6 kms-key-disable \u00b6 Disable a key $ kms-key-disable 9e94333b-8e85-497a-9791-e7c5edf9c35e kms-key-enable \u00b6 Enable a key $ kms-key-enable 9e94333b-8e85-497a-9791-e7c5edf9c35e lambda-commands \u00b6 lambda-functions \u00b6 lambda-function-memory \u00b6 returns memorySize for function lambda-function-memory-set \u00b6 lambda-function-memory-step \u00b6 local -A memory_old=() log-commands \u00b6 log-groups \u00b6 misc-commands \u00b6 \u00b6 columnise(): Handy function to columnise output columnise \u00b6 rds-commands \u00b6 rds-db-instances \u00b6 region-commands \u00b6 regions \u00b6 List regions The region() function must be sourced in order to update the AWS_DEFAULT_REGION environment variable. This is because it cannot update an environment variable when run as a subprocess. $ regions ap-northeast-1 ap-northeast-2 ap-south-1 ap-southeast-1 ap-southeast-2 ... us-west-2 region \u00b6 Get/Set $AWS_DEFAULT_REGION shell environment variable $ region us-east-1 $ region ap-southeast-2 $ region ap-southeast-2 region-each \u00b6 Run a command in every region. Any output lines will be appended with \"#${REGION}\". $ region-each stacks | column -t example-ec2-ap-northeast-1 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-1 example-ec2-ap-northeast-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-2 ... example-ec2-us-west-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #us-west-2 route53-commands \u00b6 hosted-zones \u00b6 \u00b6 hosted-zone-ns \u00b6 hosted-zone-rr-sets s3-commands \u00b6 buckets \u00b6 bucket-acls \u00b6 bucket-remove \u00b6 bucket-remove-force \u00b6 shared-commands \u00b6 __bma_read_inputs \u00b6 __bma_read_stdin \u00b6 __bma_read_filters \u00b6 __bma_error \u00b6 __bma_usage \u00b6 stack-commands \u00b6 stacks \u00b6 stack-arn \u00b6 stack-cancel-update \u00b6 stack-create \u00b6 local stack template params # values set by _bma_stack_args() stack-update \u00b6 local stack template params # values set by _bma_stack_args() stack-delete \u00b6 delete an existing stack stack-exports \u00b6 stack-recreate \u00b6 rm -fr $tmpdir stack-failure \u00b6 type: detail return the reason a stack failed to update/create/delete FIXME: only grab the latest failure stack-events \u00b6 type: detail return the events a stack has experienced stack-resources \u00b6 stack-asgs \u00b6 type: detail return the autoscaling groups managed by a stack stack-asg-instances \u00b6 stack-elbs \u00b6 return the elastic load balancers managed by stack(s) stack-instances \u00b6 return the instances managed by stack(s) stack-parameters \u00b6 return the parameters applied to a stack stack-status \u00b6 type: detail return the current status of a stack stack-tag \u00b6 return a selected stack tag stack-tag-apply \u00b6 apply a stack tag stack-tag-delete \u00b6 delete a stack tag stack-tail \u00b6 type: detail follow the events occuring for a stack stack-template \u00b6 return the template applied to a stack stack-tags \u00b6 return the stack-tags applied to a stack stack-tags-text \u00b6 return all stack tags on a single line stack-outputs \u00b6 type: detail return the outputs of a stack stack-validate \u00b6 type: detail validate a stack template stack-diff \u00b6 type: detail return differences between a template and Stack _bma_stack_diff_template \u00b6 report changes which would be made to stack if template were applied local stack template params # values set by _bma_stack_args() _bma_stack_diff_params \u00b6 report on what changes would be made to stack by applying params local stack template params # values set by _bma_stack_args() _bma_stack_args \u00b6 If we are working from a single argument (ignore args starting with -- ) _bma_derive_params_from_stack_and_template \u00b6 Strip path and extension from template Deduce params filename from stack and template names _bma_derive_params_from_template \u00b6 Strip path and extension from template _bma_derive_stack_from_params \u00b6 _bma_derive_stack_from_template \u00b6 _bma_derive_template_from_params \u00b6 _bma_derive_template_from_stack \u00b6 _bma_stack_name_arg \u00b6 File extension gets stripped off if template name provided as stack name _bma_stack_template_arg \u00b6 Determine name of template to use _bma_stack_params_arg \u00b6 determine name of params file to use _bma_stack_capabilities \u00b6 determine what (if any) capabilities a given stack was deployed with sts-commands \u00b6 sts-assume-role \u00b6 vpc-commands \u00b6 pcxs \u00b6 List VPC Peering connections subnets \u00b6 List subnets for all VPCs $ subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME vpcs \u00b6 List VPCs $ vpcs vpc-018d9739 default-vpc NO_NAME 172.31.0.0/16 NO_STACK NO_VERSION vpc-azs \u00b6 List availability zones of VPC(s) USAGE: vpc-azs vpc-id [vpc-id] $ vpcs | vpc-azs vpc-018d9739 ap-southeast-2a ap-southeast-2b ap-southeast-2c vpc-az-count \u00b6 List number of Availability Zones of VPC(s) USAGE: vpc-az-count vpc-id [vpc-id] $ vpcs | vpc-az-count vpc-018d9739 3 vpc-lambda-functions \u00b6 List lambda functions of VPC(s) vpc-dhcp-options-ntp \u00b6 List DHCP Options of VPC(s) vpc-endpoints \u00b6 List VPC Endpoints of VPC(s) vpc-endpoint-services \u00b6 List available VPC endpoint services vpc-igw \u00b6 List Internet Gateway of VPC(s) vpc-route-tables \u00b6 List Route Tables of VPC(s) USAGE: vpc-route-tables vpc-id [vpc-id] $ vpcs | vpc-route-tables rtb-8e841c39 vpc-018d9739 NO_NAME vpc-nat-gateways \u00b6 List NAT Gateways of VPC(s) USAGE: vpc-nat-gateways vpc-id [vpc-id] vpc-subnets \u00b6 List subnets of VPC(s) USAGE: vpc-subnets vpc-id [vpc-id] $ vpcs | vpc-subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME vpc-network-acls \u00b6 List Network ACLs of VPC(s) USAGE: vpc-network-acls vpc-id [vpc-id] $ vpcs | vpc-network-acls acl-ff4914d1 vpc-018d9739 vpc-rds \u00b6 List RDS instances of VPC(s) vpc-default-delete \u00b6 Print commands you would need to run to delete that pesky default VPC Exclude default VPCs that contain: - instances - lambda functions $ vpc-default-delete # Deleting default VPC vpc-018d9739 in ap-southeast-2 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-8bb774fe aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-9eea2c07 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-34fd9cfa aws --region ap-southeast-2 ec2 delete-vpc --vpc-id=vpc-018d9739","title":"Test"},{"location":"test/#asg-commands","text":"","title":"asg-commands"},{"location":"test/#asgs","text":"List EC2 Autoscaling Groups","title":"asgs"},{"location":"test/#asg-capacity","text":"List min, desired and maximum capacities of EC2 Autoscaling Group(s)","title":"asg-capacity"},{"location":"test/#asg-desired-size-set","text":"Set desired capacity of autoscaling group(s)","title":"asg-desired-size-set"},{"location":"test/#asg-instances","text":"List instances of autoscaling group(s)","title":"asg-instances"},{"location":"test/#asg-launch-configuration","text":"List Launch Configurations of Autoscaling Group(s)","title":"asg-launch-configuration"},{"location":"test/#launch-configurations","text":"List Launch Configurations","title":"launch-configurations"},{"location":"test/#launch-configuration-asgs","text":"List EC2 Autoscaling Groups of Launch COnfiguration(s)","title":"launch-configuration-asgs"},{"location":"test/#asg-max-size-set","text":"Set maximum size of autoscaling group(s)","title":"asg-max-size-set"},{"location":"test/#asg-min-size-set","text":"Set minimum size of autoscaling group(s)","title":"asg-min-size-set"},{"location":"test/#asg-processes_suspended","text":"List suspended processes of an autoscaling group","title":"asg-processes_suspended"},{"location":"test/#asg-resume","text":"Resume all processes of an autoscaling group","title":"asg-resume"},{"location":"test/#asg-suspend","text":"Suspend all processes of an autoscaling group","title":"asg-suspend"},{"location":"test/#asg-stack","text":"List CloudFormation stack for asg(s)","title":"asg-stack"},{"location":"test/#asg-scaling-activities","text":"List scaling activities for Autoscaling Group(s)","title":"asg-scaling-activities"},{"location":"test/#aws-account-commands","text":"","title":"aws-account-commands"},{"location":"test/#aws-account-alias","text":"Retrieve AWS Account Alias for current account $ aws-account-alias example-account-prod","title":"aws-account-alias"},{"location":"test/#aws-account-id","text":"Retrieve AWS Account ID for current account $ aws-account-id 012345678901","title":"aws-account-id"},{"location":"test/#aws-account-each","text":"Run a script/command across a number of AWS Accounts $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED # account=012345678901 alias=example-account-prod example-stack1-prod CREATED_FAILED example-stack2-prod UPDATE_ROLLBACK_FAILED # account=123456789012 alias=example-account-staging example-stack1-staging CREATED_FAILED example-stack2-staging UPDATE_ROLLBACK_FAILED Note In order to use aws-account-each , you need to be authenticated with an IAM Role that can assume a Role in each of the specified accounts. Check the source for more info.","title":"aws-account-each"},{"location":"test/#aws-panopticon","text":"aws-panopticon was previous name for aws-account-each()","title":"aws-panopticon"},{"location":"test/#aws-account-cost-explorer","text":"Use with an AWS Organisations Master Account to open multiple accounts in Cost Explorer. $ grep demo AWS_ACCOUNTS | aws-account-cost-explorer #=> Opens web browser to AWS Cost Explorer with accounts selected","title":"aws-account-cost-explorer"},{"location":"test/#aws-account-cost-recommendations","text":"Use with an AWS Organisations Master Account to open multiple accounts in Cost Recommendations. $ grep non_prod AWS_ACCOUNTS | aws-account-each stacks FAILED #=> Opens web browser to AWS Cost Recommendations with accounts selected","title":"aws-account-cost-recommendations"},{"location":"test/#cert-commands","text":"","title":"cert-commands"},{"location":"test/#certs","text":"List ACM Certificates","title":"certs"},{"location":"test/#certs-arn","text":"Same as certs but with the ARN in first column","title":"certs-arn"},{"location":"test/#cert-users","text":"List resources using ACM Cert(s)","title":"cert-users"},{"location":"test/#cert-delete","text":"Delete ACM Cert(s)","title":"cert-delete"},{"location":"test/#cloudtrail-commands","text":"","title":"cloudtrail-commands"},{"location":"test/#cloudtrails","text":"List Cloudtrails","title":"cloudtrails"},{"location":"test/#cloudtrail-status","text":"List logging status of Cloudtrails","title":"cloudtrail-status"},{"location":"test/#ecr-commands","text":"","title":"ecr-commands"},{"location":"test/#ecr-repositories","text":"List ECR Repositories","title":"ecr-repositories"},{"location":"test/#ecr-repository-images","text":"List images for ECR Repositories","title":"ecr-repository-images"},{"location":"test/#elb-commands","text":"","title":"elb-commands"},{"location":"test/#elbs","text":"List ELBs Accepts LoadBalancer names or ARNS on STDIN and converts to LoadBalancer names $ elbs elb-MyLoadBalancer-1FNISWJN0W6N9 2019-12-13T10:24:55.220Z subnet-eff2cf88 another-e-MyLoadBa-171CPCZF2E84T 2019-12-13T10:25:24.300Z subnet-eff2cf88","title":"elbs"},{"location":"test/#elb-dnsname","text":"List DNS Names of ELB(s) USAGE: elb-dnsname load-balancer [load-balancer] $ elbs | elb-dnsname elb-MyLoadBalancer-1FNISWJN0W6N9 elb-MyLoadBalancer-1FNISWJN0W6N9-563832045.ap-southeast-2.elb.amazonaws.com another-e-MyLoadBa-171CPCZF2E84T another-e-MyLoadBa-171CPCZF2E84T-1832721930.ap-southeast-2.elb.amazonaws.com","title":"elb-dnsname"},{"location":"test/#elb-instances","text":"List instances of ELB(s)","title":"elb-instances"},{"location":"test/#elb-stack","text":"List CloudFormation stack names of ELB(s) USAGE: elb-stack load-balancer [load-balancer] $ elbs | elb-stack elb elb-MyLoadBalancer-1FNISWJN0W6N9 another-elb another-e-MyLoadBa-171CPCZF2E84T","title":"elb-stack"},{"location":"test/#iam-commands","text":"","title":"iam-commands"},{"location":"test/#iam-roles","text":"List IAM Roles","title":"iam-roles"},{"location":"test/#iam-role-principal","text":"List role principal for IAM Role(s)","title":"iam-role-principal"},{"location":"test/#image-commands","text":"","title":"image-commands"},{"location":"test/#images","text":"List EC2 AMI's Usage: images [owner] [image-id] [image-id]... owner defaults to self or can one or more of: an AWS_ACCOUNT_ID (e.g. 1234567890) an AWS_OWNER_ALIAS (amazon, amazon-marketplace, microsoft) image_id can be one or more AMIs Trialing a different approach for grabbing resource ids from input. As normal, you can pipe resource ids in as first token on each line. We treat all args that don't start with ami- as owner identifiers. Trialing a new pattern for output - putting the Name at the end. This is more like the output of ls -la Pro: Preceding fields tend to be of the same length Pro: Easier for eyes to scan final column for names(?) Con: Using this pattern for instances() would put name past 80 char point Con: Migrating instances() to this output is A Big Change (not made lightly)","title":"images"},{"location":"test/#image-deregister","text":"Deregister AMI","title":"image-deregister"},{"location":"test/#instance-commands","text":"","title":"instance-commands"},{"location":"test/#instances","text":"","title":"instances"},{"location":"test/#instance-asg","text":"returns the autoscaling group instance is member of","title":"instance-asg"},{"location":"test/#instance-az","text":"returns the availability zone of an instance","title":"instance-az"},{"location":"test/#instance-console","text":"return console output of instance","title":"instance-console"},{"location":"test/#instance-dns","text":"returns the dns name of an instance","title":"instance-dns"},{"location":"test/#instance-health-set-unhealthy","text":"","title":"instance-health-set-unhealthy"},{"location":"test/#instance-iam-profile","text":"returns the iam-profile of an instance","title":"instance-iam-profile"},{"location":"test/#instance-ip","text":"returns the ip address of an instance","title":"instance-ip"},{"location":"test/#instance-ssh","text":"connects to an instance via SSH","title":"instance-ssh"},{"location":"test/#instance-ssh-details","text":"returns the details needed to SSH into an instance","title":"instance-ssh-details"},{"location":"test/#instance-stack","text":"returns the stack an instances is a member of","title":"instance-stack"},{"location":"test/#instance-start","text":"starts a stopped instance","title":"instance-start"},{"location":"test/#instance-state","text":"returns the state of an instance","title":"instance-state"},{"location":"test/#instance-stop","text":"stops a running instance","title":"instance-stop"},{"location":"test/#instance-tags","text":"returns the tags applied instances","title":"instance-tags"},{"location":"test/#instance-terminate","text":"","title":"instance-terminate"},{"location":"test/#instance-termination-protection","text":"","title":"instance-termination-protection"},{"location":"test/#instance-termination-protection-disable","text":"","title":"instance-termination-protection-disable"},{"location":"test/#instance-termination-protection-enable","text":"","title":"instance-termination-protection-enable"},{"location":"test/#instance-type","text":"returns the type of an instance","title":"instance-type"},{"location":"test/#instance-userdata","text":"returns userdata for instance","title":"instance-userdata"},{"location":"test/#instance-volumes","text":"returns the volumes of an instance","title":"instance-volumes"},{"location":"test/#instance-vpc","text":"returns the vpc of an instance","title":"instance-vpc"},{"location":"test/#keypair-commands","text":"","title":"keypair-commands"},{"location":"test/#keypairs","text":"List EC2 SSH Keypairs in current Region $ keypairs alice 8f:85:9a:1e:6c:76:29:34:37:45:de:7f:8d:f9:70:eb bob 56:73:29:c2:ad:7b:6f:b6:f2:f3:b4:de:e4:2b:12:d4","title":"keypairs"},{"location":"test/#keypair-create","text":"Create SSH Keypair on local machine and import public key into new EC2 Keypair. Provides benefits over AWS creating the keypair: Amazon never has access to private key Private key is protected with passphrase before being written to disk Keys is written to ~/.ssh with correct file permissions You control the SSH Key type (algorithm, length, etc) $ keypair-create yet-another-keypair Creating /home/m/.ssh/yet-another-keypair Generating public/private rsa key pair. Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/m/.ssh/yet-another-keypair. Your public key has been saved in /home/m/.ssh/yet-another-keypair.pub. The key fingerprint is: SHA256:zIpbxLo7rpQvKyezOLATk96B1kSL0QP41q6x8tUrySk m@localhost.localdomain The key's randomart image is: +---[RSA 4096]----+ |..o | |.. + | | .+.o | | .oo.. o | | o+. o S | |=o.+.= . | |+++==o+ | |XoE+ + . | |o@+ *+. | +----[SHA256]-----+ { \"KeyFingerprint\": \"21:82:f9:5b:79:d6:dc:0f:7b:79:43:7c:c5:34:6c:2d\", \"KeyName\": \"yet-another-keypair\" } Note KeyPair Name defaults to \"$(aws-account-alias)-$(region)\" if none provided","title":"keypair-create"},{"location":"test/#keypair-delete","text":"Delete EC2 SSH Keypairs by providing their names as arguments or via STDIN $ keypair-delete alice bob You are about to delete the following EC2 SSH KeyPairs: alice bob Are you sure you want to continue? y $ keypairs | keypair-delete You are about to delete the following EC2 SSH KeyPairs: yet-another-keypair Are you sure you want to continue? y","title":"keypair-delete"},{"location":"test/#kms-commands","text":"","title":"kms-commands"},{"location":"test/#kms-encrypt","text":"Encrypt and base64 encode STDIN or file $ echo foobar | kms-encrypt alias/default AQICAHgcyN4vd3V/OB7NKI6IMbpENEu1+UfyiU...","title":"kms-encrypt"},{"location":"test/#kms-decrypt","text":"base64 decode and decrypt KMS Encrypted file or STDIN $ kms-decrypt ciphertext.txt foobar $ echo foobar | kms-encrypt alias/default | kms-decrypt foobar","title":"kms-decrypt"},{"location":"test/#kms-aliases","text":"List KMS Aliases $ kms-aliases default alias/default d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/default","title":"kms-aliases"},{"location":"test/#kms-alias-create","text":"Create alias for KMS Key $ kms-keys | tail -1 d714a175-db12-4574-8f27-aa071a1dfd8a $ kms-keys | tail -1 | kms-alias-create alias/foobar $ kms-aliases foobar alias/foobar d714a175-db12-4574-8f27-aa071a1dfd8a arn:aws:kms:ap-southeast-2:089834043791:alias/foobar","title":"kms-alias-create"},{"location":"test/#kms-alias-delete","text":"Delete alias for KMS Key $ kms-aliases foobar | kms-alias-delete You are about to delete the following kms aliases: alias/foobar Are you sure you want to continue? y","title":"kms-alias-delete"},{"location":"test/#kms-keys","text":"List KMS Keys $ kms-keys 5044958c-151d-4995-bed4-dd05c1385b48 8ada3e65-e377-4435-a709-fbe75dfa1dd0 d714a175-db12-4574-8f27-aa071a1dfd8a","title":"kms-keys"},{"location":"test/#kms-key-create","text":"Create a KMS Key $ kms-key-create 9e94333b-8e85-497a-9791-e7c5edf9c35e","title":"kms-key-create"},{"location":"test/#kms-key-details","text":"","title":"kms-key-details"},{"location":"test/#kms-key-disable","text":"Disable a key $ kms-key-disable 9e94333b-8e85-497a-9791-e7c5edf9c35e","title":"kms-key-disable"},{"location":"test/#kms-key-enable","text":"Enable a key $ kms-key-enable 9e94333b-8e85-497a-9791-e7c5edf9c35e","title":"kms-key-enable"},{"location":"test/#lambda-commands","text":"","title":"lambda-commands"},{"location":"test/#lambda-functions","text":"","title":"lambda-functions"},{"location":"test/#lambda-function-memory","text":"returns memorySize for function","title":"lambda-function-memory"},{"location":"test/#lambda-function-memory-set","text":"","title":"lambda-function-memory-set"},{"location":"test/#lambda-function-memory-step","text":"local -A memory_old=()","title":"lambda-function-memory-step"},{"location":"test/#log-commands","text":"","title":"log-commands"},{"location":"test/#log-groups","text":"","title":"log-groups"},{"location":"test/#misc-commands","text":"","title":"misc-commands"},{"location":"test/#columnise","text":"","title":"columnise"},{"location":"test/#rds-commands","text":"","title":"rds-commands"},{"location":"test/#rds-db-instances","text":"","title":"rds-db-instances"},{"location":"test/#region-commands","text":"","title":"region-commands"},{"location":"test/#regions","text":"List regions The region() function must be sourced in order to update the AWS_DEFAULT_REGION environment variable. This is because it cannot update an environment variable when run as a subprocess. $ regions ap-northeast-1 ap-northeast-2 ap-south-1 ap-southeast-1 ap-southeast-2 ... us-west-2","title":"regions"},{"location":"test/#region","text":"Get/Set $AWS_DEFAULT_REGION shell environment variable $ region us-east-1 $ region ap-southeast-2 $ region ap-southeast-2","title":"region"},{"location":"test/#region-each","text":"Run a command in every region. Any output lines will be appended with \"#${REGION}\". $ region-each stacks | column -t example-ec2-ap-northeast-1 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-1 example-ec2-ap-northeast-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #ap-northeast-2 ... example-ec2-us-west-2 CREATE_COMPLETE 2011-05-23T15:47:44Z NEVER_UPDATED NOT_NESTED #us-west-2","title":"region-each"},{"location":"test/#route53-commands","text":"","title":"route53-commands"},{"location":"test/#hosted-zones","text":"","title":"hosted-zones"},{"location":"test/#s3-commands","text":"","title":"s3-commands"},{"location":"test/#buckets","text":"","title":"buckets"},{"location":"test/#bucket-acls","text":"","title":"bucket-acls"},{"location":"test/#bucket-remove","text":"","title":"bucket-remove"},{"location":"test/#bucket-remove-force","text":"","title":"bucket-remove-force"},{"location":"test/#shared-commands","text":"","title":"shared-commands"},{"location":"test/#__bma_read_inputs","text":"","title":"__bma_read_inputs"},{"location":"test/#__bma_read_stdin","text":"","title":"__bma_read_stdin"},{"location":"test/#__bma_read_filters","text":"","title":"__bma_read_filters"},{"location":"test/#__bma_error","text":"","title":"__bma_error"},{"location":"test/#__bma_usage","text":"","title":"__bma_usage"},{"location":"test/#stack-commands","text":"","title":"stack-commands"},{"location":"test/#stacks","text":"","title":"stacks"},{"location":"test/#stack-arn","text":"","title":"stack-arn"},{"location":"test/#stack-cancel-update","text":"","title":"stack-cancel-update"},{"location":"test/#stack-create","text":"local stack template params # values set by _bma_stack_args()","title":"stack-create"},{"location":"test/#stack-update","text":"local stack template params # values set by _bma_stack_args()","title":"stack-update"},{"location":"test/#stack-delete","text":"delete an existing stack","title":"stack-delete"},{"location":"test/#stack-exports","text":"","title":"stack-exports"},{"location":"test/#stack-recreate","text":"rm -fr $tmpdir","title":"stack-recreate"},{"location":"test/#stack-failure","text":"type: detail return the reason a stack failed to update/create/delete FIXME: only grab the latest failure","title":"stack-failure"},{"location":"test/#stack-events","text":"type: detail return the events a stack has experienced","title":"stack-events"},{"location":"test/#stack-resources","text":"","title":"stack-resources"},{"location":"test/#stack-asgs","text":"type: detail return the autoscaling groups managed by a stack","title":"stack-asgs"},{"location":"test/#stack-asg-instances","text":"","title":"stack-asg-instances"},{"location":"test/#stack-elbs","text":"return the elastic load balancers managed by stack(s)","title":"stack-elbs"},{"location":"test/#stack-instances","text":"return the instances managed by stack(s)","title":"stack-instances"},{"location":"test/#stack-parameters","text":"return the parameters applied to a stack","title":"stack-parameters"},{"location":"test/#stack-status","text":"type: detail return the current status of a stack","title":"stack-status"},{"location":"test/#stack-tag","text":"return a selected stack tag","title":"stack-tag"},{"location":"test/#stack-tag-apply","text":"apply a stack tag","title":"stack-tag-apply"},{"location":"test/#stack-tag-delete","text":"delete a stack tag","title":"stack-tag-delete"},{"location":"test/#stack-tail","text":"type: detail follow the events occuring for a stack","title":"stack-tail"},{"location":"test/#stack-template","text":"return the template applied to a stack","title":"stack-template"},{"location":"test/#stack-tags","text":"return the stack-tags applied to a stack","title":"stack-tags"},{"location":"test/#stack-tags-text","text":"return all stack tags on a single line","title":"stack-tags-text"},{"location":"test/#stack-outputs","text":"type: detail return the outputs of a stack","title":"stack-outputs"},{"location":"test/#stack-validate","text":"type: detail validate a stack template","title":"stack-validate"},{"location":"test/#stack-diff","text":"type: detail return differences between a template and Stack","title":"stack-diff"},{"location":"test/#_bma_stack_diff_template","text":"report changes which would be made to stack if template were applied local stack template params # values set by _bma_stack_args()","title":"_bma_stack_diff_template"},{"location":"test/#_bma_stack_diff_params","text":"report on what changes would be made to stack by applying params local stack template params # values set by _bma_stack_args()","title":"_bma_stack_diff_params"},{"location":"test/#_bma_stack_args","text":"If we are working from a single argument (ignore args starting with -- )","title":"_bma_stack_args"},{"location":"test/#_bma_derive_params_from_stack_and_template","text":"Strip path and extension from template Deduce params filename from stack and template names","title":"_bma_derive_params_from_stack_and_template"},{"location":"test/#_bma_derive_params_from_template","text":"Strip path and extension from template","title":"_bma_derive_params_from_template"},{"location":"test/#_bma_derive_stack_from_params","text":"","title":"_bma_derive_stack_from_params"},{"location":"test/#_bma_derive_stack_from_template","text":"","title":"_bma_derive_stack_from_template"},{"location":"test/#_bma_derive_template_from_params","text":"","title":"_bma_derive_template_from_params"},{"location":"test/#_bma_derive_template_from_stack","text":"","title":"_bma_derive_template_from_stack"},{"location":"test/#_bma_stack_name_arg","text":"File extension gets stripped off if template name provided as stack name","title":"_bma_stack_name_arg"},{"location":"test/#_bma_stack_template_arg","text":"Determine name of template to use","title":"_bma_stack_template_arg"},{"location":"test/#_bma_stack_params_arg","text":"determine name of params file to use","title":"_bma_stack_params_arg"},{"location":"test/#_bma_stack_capabilities","text":"determine what (if any) capabilities a given stack was deployed with","title":"_bma_stack_capabilities"},{"location":"test/#sts-commands","text":"","title":"sts-commands"},{"location":"test/#sts-assume-role","text":"","title":"sts-assume-role"},{"location":"test/#vpc-commands","text":"","title":"vpc-commands"},{"location":"test/#pcxs","text":"List VPC Peering connections","title":"pcxs"},{"location":"test/#subnets","text":"List subnets for all VPCs $ subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME","title":"subnets"},{"location":"test/#vpcs","text":"List VPCs $ vpcs vpc-018d9739 default-vpc NO_NAME 172.31.0.0/16 NO_STACK NO_VERSION","title":"vpcs"},{"location":"test/#vpc-azs","text":"List availability zones of VPC(s) USAGE: vpc-azs vpc-id [vpc-id] $ vpcs | vpc-azs vpc-018d9739 ap-southeast-2a ap-southeast-2b ap-southeast-2c","title":"vpc-azs"},{"location":"test/#vpc-az-count","text":"List number of Availability Zones of VPC(s) USAGE: vpc-az-count vpc-id [vpc-id] $ vpcs | vpc-az-count vpc-018d9739 3","title":"vpc-az-count"},{"location":"test/#vpc-lambda-functions","text":"List lambda functions of VPC(s)","title":"vpc-lambda-functions"},{"location":"test/#vpc-dhcp-options-ntp","text":"List DHCP Options of VPC(s)","title":"vpc-dhcp-options-ntp"},{"location":"test/#vpc-endpoints","text":"List VPC Endpoints of VPC(s)","title":"vpc-endpoints"},{"location":"test/#vpc-endpoint-services","text":"List available VPC endpoint services","title":"vpc-endpoint-services"},{"location":"test/#vpc-igw","text":"List Internet Gateway of VPC(s)","title":"vpc-igw"},{"location":"test/#vpc-route-tables","text":"List Route Tables of VPC(s) USAGE: vpc-route-tables vpc-id [vpc-id] $ vpcs | vpc-route-tables rtb-8e841c39 vpc-018d9739 NO_NAME","title":"vpc-route-tables"},{"location":"test/#vpc-nat-gateways","text":"List NAT Gateways of VPC(s) USAGE: vpc-nat-gateways vpc-id [vpc-id]","title":"vpc-nat-gateways"},{"location":"test/#vpc-subnets","text":"List subnets of VPC(s) USAGE: vpc-subnets vpc-id [vpc-id] $ vpcs | vpc-subnets subnet-34fd9cfa vpc-018d9739 ap-southeast-2c 172.31.32.0/20 NO_NAME subnet-8bb774fe vpc-018d9739 ap-southeast-2a 172.31.0.0/20 NO_NAME subnet-9eea2c07 vpc-018d9739 ap-southeast-2b 172.31.16.0/20 NO_NAME","title":"vpc-subnets"},{"location":"test/#vpc-network-acls","text":"List Network ACLs of VPC(s) USAGE: vpc-network-acls vpc-id [vpc-id] $ vpcs | vpc-network-acls acl-ff4914d1 vpc-018d9739","title":"vpc-network-acls"},{"location":"test/#vpc-rds","text":"List RDS instances of VPC(s)","title":"vpc-rds"},{"location":"test/#vpc-default-delete","text":"Print commands you would need to run to delete that pesky default VPC Exclude default VPCs that contain: - instances - lambda functions $ vpc-default-delete # Deleting default VPC vpc-018d9739 in ap-southeast-2 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-8bb774fe aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-9eea2c07 aws --region ap-southeast-2 ec2 delete-subnet --subnet-id=subnet-34fd9cfa aws --region ap-southeast-2 ec2 delete-vpc --vpc-id=vpc-018d9739","title":"vpc-default-delete"},{"location":"tour/","text":"Tour \u00b6 Check this out!","title":"Tour"},{"location":"tour/#tour","text":"Check this out!","title":"Tour"}]}